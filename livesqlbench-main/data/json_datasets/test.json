[
  {
    "db_id": "bike_1",
    "question": "2015年6月2日12:47:02，圣何塞文娱中心站不可用的自行车停靠点有多少？",
    "gold_sql": "SELECT A.dock_count - B.docks_available AS n_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE B.time = '2015-06-02 12:47:02' AND A.name = 'San Jose Civic Center'"
  },
  {
    "db_id": "bike_1",
    "question": "返回2015年6月2日12点47分2秒圣何塞文娱中心站不可用的自行车停靠点的数量。",
    "gold_sql": "SELECT A.dock_count - B.docks_available AS n_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE B.time = '2015-06-02 12:47:02' AND A.name = 'San Jose Civic Center'"
  },
  {
    "db_id": "bike_1",
    "question": "如果圣何塞文娱中心站站总共有20个自行车停靠点，那么2015年6月2日12:47:02，它不可用的自行车停靠点有多少？",
    "gold_sql": "SELECT 20 - B.docks_available AS n_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE B.time = '2015-06-02 12:47:02' AND A.name = 'San Jose Civic Center'"
  },
  {
    "db_id": "bike_1",
    "question": "返回2015年6月2日12点47分2秒圣何塞文娱中心站不可用的自行车停靠点的数量，假设它总共有二十个自行车停靠点。",
    "gold_sql": "SELECT 20 - B.docks_available AS n_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE B.time = '2015-06-02 12:47:02' AND A.name = 'San Jose Civic Center'"
  },
  {
    "db_id": "bike_1",
    "question": "金门之城总共有多少个自行车站，比帕洛阿托少多少？",
    "gold_sql": "SELECT ( SELECT COUNT ( * ) FROM station WHERE city = 'Palo Alto' ) - COUNT ( * ) AS diff FROM station WHERE city = 'San Francisco'"
  },
  {
    "db_id": "bike_1",
    "question": "返回金门之城的自行车站总数。它与帕洛阿托的自行车站总数相比少多少？",
    "gold_sql": "SELECT ( SELECT COUNT ( * ) FROM station WHERE city = 'Palo Alto' ) - COUNT ( * ) AS diff FROM station WHERE city = 'San Francisco'"
  },
  {
    "db_id": "bike_1",
    "question": "金门之城总共有多少个自行车站？如果帕洛阿托的自行车站数量是它自己的两倍还多10个，那金门之城的自行车站数量比帕洛阿托少多少？",
    "gold_sql": "SELECT ( SELECT COUNT ( * ) * 2 + 10 FROM station WHERE city = 'Palo Alto' ) - COUNT ( * ) AS diff FROM station WHERE city = 'San Francisco'"
  },
  {
    "db_id": "bike_1",
    "question": "返回金门之城的自行车站总数。假如帕洛阿托的自行车站数量增长一倍还多十个，那金门之城的自行车站数量比帕洛阿托少多少？",
    "gold_sql": "SELECT ( SELECT COUNT ( * ) * 2 + 10 FROM station WHERE city = 'Palo Alto' ) - COUNT ( * ) AS diff FROM station WHERE city = 'San Francisco'"
  },
  {
    "db_id": "bike_1",
    "question": "在2015年6月2日12:46:02这个时刻，那些建于2013年8月20日的车站的可用自行车停靠点一共有多少，不可用的自行车停靠点呢？",
    "gold_sql": "SELECT SUM ( B.docks_available ) AS total_available , SUM ( A.dock_count ) - SUM ( B.docks_available ) AS total_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE A.installation_date = '8/20/2013' AND B.time = '2015-06-02 12:46:02'"
  },
  {
    "db_id": "bike_1",
    "question": "返回2015年6月2日12点46分2秒的时候，所有2013年8月20日建的车站的可用自行车停靠点的总数量和不可用自行车停靠点的总数量。",
    "gold_sql": "SELECT SUM ( B.docks_available ) AS total_available , SUM ( A.dock_count ) - SUM ( B.docks_available ) AS total_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE A.installation_date = '8/20/2013' AND B.time = '2015-06-02 12:46:02'"
  },
  {
    "db_id": "bike_1",
    "question": "如果建于2013年8月20日的每个车站的自行车停靠点数量都是\"Grant Avenue at Columbus Avenue\"车站自行车停靠点数量的两倍多5个，在2015年6月2日12:46:02这个时刻，那些建于2013年8月20日的车站的可用的自行车停靠点一共有多少可用，不可用的自行车停靠点呢？",
    "gold_sql": "SELECT SUM ( B.docks_available ) AS total_available , SUM ( 2 * ( SELECT dock_count FROM station WHERE name = 'Grant Avenue at Columbus Avenue' ) + 5 - B.docks_available ) AS total_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE A.installation_date = '8/20/2013' AND B.time = '2015-06-02 12:46:02'"
  },
  {
    "db_id": "bike_1",
    "question": "假设2013年8月20日建的每个车站的自行车停靠点数量比“Grant Avenue at ColumbusAvenue”车站的两倍多五个，返回2015年6月2日12点46分2秒的时候，所有2013年8月20日建的车站的可用自行车停靠点的总数量和不可用自行车停靠点的总数量。",
    "gold_sql": "SELECT SUM ( B.docks_available ) AS total_available , SUM ( 2 * ( SELECT dock_count FROM station WHERE name = 'Grant Avenue at Columbus Avenue' ) + 5 - B.docks_available ) AS total_unavailable FROM station A JOIN status B ON A.id = B.station_id WHERE A.installation_date = '8/20/2013' AND B.time = '2015-06-02 12:46:02'"
  },
  {
    "db_id": "bike_1",
    "question": "查找持续时间是出发于“2nd at Folsom”站的行程的平均持续时间至少两倍的行程ID。",
    "gold_sql": "SELECT id FROM trip WHERE duration >= ( SELECT 2 * AVG ( duration ) FROM trip WHERE start_station_name = '2nd at Folsom' )"
  },
  {
    "db_id": "bike_1",
    "question": "哪些行程的持续时长至少是出发站为“2nd at Folsom”站的行程的平均持续时长的两倍？列出行程ID。",
    "gold_sql": "SELECT id FROM trip WHERE duration >= ( SELECT 2 * AVG ( duration ) FROM trip WHERE start_station_name = '2nd at Folsom' )"
  },
  {
    "db_id": "bike_1",
    "question": "查找持续时间至少是出发于“2nd at Folsom”站的行程的平均持续时间两倍的行程ID，假如出发于“2nd at Folsom”站的行程的平均持续时间是666。",
    "gold_sql": "SELECT id FROM trip WHERE duration >= 2 * 666"
  },
  {
    "db_id": "bike_1",
    "question": "假如出发站为“2nd at Folsom”站的行程的平均持续时长为666，哪些行程的持续时长至少是出发站为“2nd at Folsom”站的行程的平均持续时长的两倍？列出行程ID。",
    "gold_sql": "SELECT id FROM trip WHERE duration >= 2 * 666"
  },
  {
    "db_id": "bike_1",
    "question": "2015年6月2日13:59:02，哪个车站的可用自行车数量是“2nd at Townsend”的两倍多？给出这些车站的名字。",
    "gold_sql": "SELECT B.name FROM status A JOIN station B ON A.station_id = B.id WHERE A.bikes_available > 2 * ( SELECT A.bikes_available FROM status A JOIN station B ON A.station_id = B.id WHERE B.name = '2nd at Townsend' AND A.time = '2015-06-02 13:59:02' ) AND A.time = '2015-06-02 13:59:02'"
  },
  {
    "db_id": "bike_1",
    "question": "列出在二零一五年六月二日十三点五十九分两秒的时候可用自行车数量比“2nd at Townsend”车站的两倍多的车站的名字。",
    "gold_sql": "SELECT B.name FROM status A JOIN station B ON A.station_id = B.id WHERE A.bikes_available > 2 * ( SELECT A.bikes_available FROM status A JOIN station B ON A.station_id = B.id WHERE B.name = '2nd at Townsend' AND A.time = '2015-06-02 13:59:02' ) AND A.time = '2015-06-02 13:59:02'"
  },
  {
    "db_id": "bike_1",
    "question": "2015年6月2日13:59:02，如果“2nd at Townsend”有5个可用的自行车，哪个车站的可用自行车是“2nd at Townsend”的两倍多？给出这些车站的名字。",
    "gold_sql": "SELECT B.name FROM status A JOIN station B ON A.station_id = B.id WHERE A.bikes_available > 2 * 5 AND A.time = '2015-06-02 13:59:02'"
  },
  {
    "db_id": "bike_1",
    "question": "列出在二零一五年六月二日十三点五十九分两秒的时候可用自行车数量比“2nd at Townsend”车站的两倍多的车站的名字，假设“2nd at Townsend”车站当时有五辆可用的自行车。",
    "gold_sql": "SELECT B.name FROM status A JOIN station B ON A.station_id = B.id WHERE A.bikes_available > 2 * 5 AND A.time = '2015-06-02 13:59:02'"
  },
  {
    "db_id": "bike_1",
    "question": "对于每个车站，找出以它为终点站的行程的最小持续时间、最长持续时间以及它们的差值。",
    "gold_sql": "SELECT end_station_name , MAX ( duration ) AS max_duration , MIN ( duration ) AS min_duration , MAX ( duration ) - MIN ( duration ) AS diff FROM trip GROUP BY end_station_name"
  },
  {
    "db_id": "bike_1",
    "question": "对于每个车站，以它为终点的行程的最短和最长持续时长分别是多少，它们相差多少？",
    "gold_sql": "SELECT end_station_name , MAX ( duration ) AS max_duration , MIN ( duration ) AS min_duration , MAX ( duration ) - MIN ( duration ) AS diff FROM trip GROUP BY end_station_name"
  },
  {
    "db_id": "bike_1",
    "question": "邮编为94107的地方哪天温差最大？",
    "gold_sql": "SELECT date FROM weather WHERE zip_code = '94107' AND max_temperature_f - min_temperature_f = ( SELECT MAX ( max_temperature_f - min_temperature_f ) FROM weather WHERE zip_code = '94107' )"
  },
  {
    "db_id": "bike_1",
    "question": "请告诉我哪天邮编为94107的地方温差最大。",
    "gold_sql": "SELECT date FROM weather WHERE zip_code = '94107' AND max_temperature_f - min_temperature_f = ( SELECT MAX ( max_temperature_f - min_temperature_f ) FROM weather WHERE zip_code = '94107' )"
  },
  {
    "db_id": "bike_1",
    "question": "2013年一战停战纪念日，哪个地方的平均能见度英里数最高，给出那里的邮编，以及那里那天的温差。",
    "gold_sql": "SELECT zip_code , tem_diff FROM ( SELECT zip_code , MAX ( mean_visibility_miles ) , max_temperature_f - min_temperature_f AS tem_diff FROM weather WHERE date = '11/11/2013' )"
  },
  {
    "db_id": "bike_1",
    "question": "返回二零一三年一战停战纪念日那天平均能见度英里数最远的地方的邮编，以及它当天的温差。",
    "gold_sql": "SELECT zip_code , tem_diff FROM ( SELECT zip_code , MAX ( mean_visibility_miles ) , max_temperature_f - min_temperature_f AS tem_diff FROM weather WHERE date = '11/11/2013' )"
  },
  {
    "db_id": "bike_1",
    "question": "2013年一战停战纪念日，哪个地方的平均能见度英里数最高？给出那里的邮编。如果那里最低温度是52华氏度，那天的温差是多少？",
    "gold_sql": "SELECT zip_code , tem_diff FROM ( SELECT zip_code , MAX ( mean_visibility_miles ) , max_temperature_f - 52 AS tem_diff FROM weather WHERE date = '11/11/2013' )"
  },
  {
    "db_id": "bike_1",
    "question": "返回二零一三年一战停战纪念日那天平均能见度英里数最远的地方的邮编以及它当天的温差，假如它当天的最低温度是52华氏度。",
    "gold_sql": "SELECT zip_code , tem_diff FROM ( SELECT zip_code , MAX ( mean_visibility_miles ) , max_temperature_f - 52 AS tem_diff FROM weather WHERE date = '11/11/2013' )"
  },
  {
    "db_id": "bike_1",
    "question": "邮编为94107的地方哪天平均温度最高？列出日期和平均摄氏温度。",
    "gold_sql": "SELECT date , 1.0 * ( MAX ( mean_temperature_f ) - 32 ) * 5 / 9 AS celsius FROM weather WHERE zip_code = '94107'"
  },
  {
    "db_id": "bike_1",
    "question": "返回邮编为94107的地方平均温度最高的那天的日期和平均摄氏温度。",
    "gold_sql": "SELECT date , 1.0 * ( MAX ( mean_temperature_f ) - 32 ) * 5 / 9 AS celsius FROM weather WHERE zip_code = '94107'"
  },
  {
    "db_id": "bike_1",
    "question": "各个地方的邮编是多少？它们2014年1月1日平均风速分别是多少千米每小时？",
    "gold_sql": "SELECT zip_code , mean_wind_speed_mph * 1.609344 AS km_per_h FROM weather WHERE date = '1/1/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "以单位千米每小时返回二零一四年各个地方的平均风速，同时给出各地的邮编。",
    "gold_sql": "SELECT zip_code , mean_wind_speed_mph * 1.609344 AS km_per_h FROM weather WHERE date = '1/1/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "2014年1月1日这天各个地方的平均风速是多少千米每小时，如果当天的平均风速增加了20%？同时给出对应的邮编。",
    "gold_sql": "SELECT zip_code , mean_wind_speed_mph * ( 1 + 0.2 ) * 1.609344 AS km_per_h FROM weather WHERE date = '1/1/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "给出各个地方的邮编，并以单位千米每小时返回二零一四年各个地方的平均风速，假如当天各地的平均风速增加20%。",
    "gold_sql": "SELECT zip_code , mean_wind_speed_mph * ( 1 + 0.2 ) * 1.609344 AS km_per_h FROM weather WHERE date = '1/1/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "邮编地址为94041的地方2014年11月12日和2014年3月12日这两天的降水量分别是多少毫米，相差多少？",
    "gold_sql": "SELECT mm_1 , mm_2 , ABS ( mm_1 - mm_2 ) AS diff FROM ( SELECT precipitation_inches * 25 AS mm_1 FROM weather WHERE zip_code = '94041' AND date = '12/11/2014' ) JOIN ( SELECT precipitation_inches * 25 AS mm_2 FROM weather WHERE zip_code = '94041' AND date = '12/3/2014' )"
  },
  {
    "db_id": "bike_1",
    "question": "以单位毫米给出邮编地址为94041的地方二零一四年十一月十二日和三月十二日这两天的降水量及差值。",
    "gold_sql": "SELECT mm_1 , mm_2 , ABS ( mm_1 - mm_2 ) AS diff FROM ( SELECT precipitation_inches * 25 AS mm_1 FROM weather WHERE zip_code = '94041' AND date = '12/11/2014' ) JOIN ( SELECT precipitation_inches * 25 AS mm_2 FROM weather WHERE zip_code = '94041' AND date = '12/3/2014' )"
  },
  {
    "db_id": "bike_1",
    "question": "如果邮编地址为94041的地方2014年11月12日和2014年3月12日那两天的降水量减少了15%，那两天的降水量分别是多少毫米，相差多少？",
    "gold_sql": "SELECT mm_1 , mm_2 , ABS ( mm_1 - mm_2 ) AS diff FROM ( SELECT precipitation_inches * ( 1 - 0.15 ) * 25 AS mm_1 FROM weather WHERE zip_code = '94041' AND date = '12/11/2014' ) JOIN ( SELECT precipitation_inches * ( 1 - 0.15 ) * 25 AS mm_2 FROM weather WHERE zip_code = '94041' AND date = '12/3/2014' )"
  },
  {
    "db_id": "bike_1",
    "question": "假设邮编地址为94041的地方二零一四年十一月十二日和三月十二日这两天的降水量减少15%，以单位毫米给出当地这两天的降水量及差值。",
    "gold_sql": "SELECT mm_1 , mm_2 , ABS ( mm_1 - mm_2 ) AS diff FROM ( SELECT precipitation_inches * ( 1 - 0.15 ) * 25 AS mm_1 FROM weather WHERE zip_code = '94041' AND date = '12/11/2014' ) JOIN ( SELECT precipitation_inches * ( 1 - 0.15 ) * 25 AS mm_2 FROM weather WHERE zip_code = '94041' AND date = '12/3/2014' )"
  },
  {
    "db_id": "bike_1",
    "question": "2013年国民悲痛意识日这天，各个地方的最高能见度、平均能见度、最低能见度是多少米？同时给出对应的邮编。",
    "gold_sql": "SELECT zip_code , max_visibility_miles * 1609.344 AS max_m , mean_visibility_miles * 1609.344 AS mean_m , min_visibility_miles * 1609.344 AS min_m FROM weather WHERE date = '8/30/2013'"
  },
  {
    "db_id": "bike_1",
    "question": "以米为单位列出二零一三年国民悲痛意识日这天各个地方的邮编、最高能见度、平均能见度和最低能见度。",
    "gold_sql": "SELECT zip_code , max_visibility_miles * 1609.344 AS max_m , mean_visibility_miles * 1609.344 AS mean_m , min_visibility_miles * 1609.344 AS min_m FROM weather WHERE date = '8/30/2013'"
  },
  {
    "db_id": "bike_1",
    "question": "如果给自行车停靠点最少的车站再添10个自行车停靠点，它会有多少自行车停靠点？",
    "gold_sql": "SELECT MIN ( dock_count ) + 10 AS n_dock FROM station"
  },
  {
    "db_id": "bike_1",
    "question": "返回给自行车停靠点最少的车站再添10个自行车停靠点后它的自行车停靠点数量。",
    "gold_sql": "SELECT MIN ( dock_count ) + 10 AS n_dock FROM station"
  },
  {
    "db_id": "bike_1",
    "question": "政府计划在加利福尼亚州的人口排名第三的城市中再建立四个车站，那里将总共有几个车站？",
    "gold_sql": "SELECT COUNT ( * ) + 4 AS n_stations FROM station WHERE city = 'San Jose'"
  },
  {
    "db_id": "bike_1",
    "question": "返回加利福尼亚州人口排名第三的城市再建四个车站后的车站总数。",
    "gold_sql": "SELECT COUNT ( * ) + 4 AS n_stations FROM station WHERE city = 'San Jose'"
  },
  {
    "db_id": "bike_1",
    "question": "给出各地区的邮政编码，并计算2014年10月24日，各地区的最高温度是多少？与地球上有记录以来的最高气温相差多少？",
    "gold_sql": "SELECT zip_code , max_temperature_f , ABS ( max_temperature_f - 136 ) AS diff FROM weather WHERE date = '10/24/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "返回二零一四年十月二十日各地区的邮政编码，最高温度，及与地球上有记录以来的最高气温的差值。",
    "gold_sql": "SELECT zip_code , max_temperature_f , ABS ( max_temperature_f - 136 ) AS diff FROM weather WHERE date = '10/24/2014'"
  },
  {
    "db_id": "bike_1",
    "question": "旧金山有百分之多少的车站有超过25个自行车停靠点？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM station WHERE city = 'San Francisco' ) AS propotion FROM station WHERE city = 'San Francisco' AND dock_count > 25"
  },
  {
    "db_id": "bike_1",
    "question": "旧金山的车站中有超过25个自行车停靠点的车站占百分之几？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM station WHERE city = 'San Francisco' ) AS propotion FROM station WHERE city = 'San Francisco' AND dock_count > 25"
  },
  {
    "db_id": "bike_1",
    "question": "拥有最多车站的城市的车站数量是拥有最少车站的城市的车站数量的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( n_station ) / MIN ( n_station ) AS times FROM ( SELECT city , COUNT ( * ) AS n_station FROM station GROUP BY city )"
  },
  {
    "db_id": "bike_1",
    "question": "请告诉我拥有最多车站的城市的车站数量是车站数量最少的城市的几倍。",
    "gold_sql": "SELECT 1.0 * MAX ( n_station ) / MIN ( n_station ) AS times FROM ( SELECT city , COUNT ( * ) AS n_station FROM station GROUP BY city )"
  },
  {
    "db_id": "bike_1",
    "question": "温差最大的时候最高温度是最低温度的多少倍？",
    "gold_sql": "SELECT 1.0 * max_temperature_f / min_temperature_f AS times FROM weather WHERE max_temperature_f - min_temperature_f = ( SELECT MAX ( max_temperature_f - min_temperature_f ) FROM weather )"
  },
  {
    "db_id": "bike_1",
    "question": "返回温度变化最大时最高温度是最低温度的几倍。",
    "gold_sql": "SELECT 1.0 * max_temperature_f / min_temperature_f AS times FROM weather WHERE max_temperature_f - min_temperature_f = ( SELECT MAX ( max_temperature_f - min_temperature_f ) FROM weather )"
  },
  {
    "db_id": "bike_1",
    "question": "邮编为94063的地方平均最高气温是多少摄氏度，比平均最低气温高多少？",
    "gold_sql": "SELECT ( AVG ( max_temperature_f ) - 32 ) * 5 / 9 AS avg_max_celsius , ( ( AVG ( max_temperature_f ) - AVG ( min_temperature_f ) ) ) * 5 / 9 AS diff_celsius FROM weather WHERE zip_code = '94063'"
  },
  {
    "db_id": "bike_1",
    "question": "以摄氏度为单位返回邮编为94063的地方的平均最高气温。它比当地的平均最低气温高多少？",
    "gold_sql": "SELECT ( AVG ( max_temperature_f ) - 32 ) * 5 / 9 AS avg_max_celsius , ( ( AVG ( max_temperature_f ) - AVG ( min_temperature_f ) ) ) * 5 / 9 AS diff_celsius FROM weather WHERE zip_code = '94063'"
  },
  {
    "db_id": "concert_singer",
    "question": "列出每个歌手的名字以及其在歌曲“Gentleman”发布的时候的年龄？",
    "gold_sql": "SELECT Name , Age + ( SELECT Song_release_year FROM singer WHERE Song_Name = 'Gentleman' ) - strftime ( '%Y' , 'now' ) AS target_age FROM singer"
  },
  {
    "db_id": "concert_singer",
    "question": "给出每个歌手的名字，以及在歌曲“Gentleman”发布的时候，每个人的年龄分别是多少？",
    "gold_sql": "SELECT Name , Age + ( SELECT Song_release_year FROM singer WHERE Song_Name = 'Gentleman' ) - strftime ( '%Y' , 'now' ) AS target_age FROM singer"
  },
  {
    "db_id": "concert_singer",
    "question": "假如“Gentleman”这首歌是21世纪的第一年发布的，列出每个歌手的名字以及其在歌曲“Gentleman”发布的时候的年龄？",
    "gold_sql": "SELECT Name , Age + 2001 - strftime ( '%Y' , 'now' ) AS target_age FROM singer"
  },
  {
    "db_id": "concert_singer",
    "question": "假设“Gentleman”这首歌发布于21世纪的第一年，那么在歌曲“Gentleman”发布的时候，每个歌手的年龄分别是多少？同时给出他们的名字。",
    "gold_sql": "SELECT Name , Age + 2001 - strftime ( '%Y' , 'now' ) AS target_age FROM singer"
  },
  {
    "db_id": "concert_singer",
    "question": "主题为“Free choice”的音乐会的参演歌手的名字分别是什么？他们当时多少岁？",
    "gold_sql": "SELECT C.Name , C.Age + ( A.Year - strftime ( '%Y' , 'now' ) ) AS age_at_concert FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.Theme = 'Free choice'"
  },
  {
    "db_id": "concert_singer",
    "question": "返回主题为“Free choice”的音乐会的参演歌手的姓名和参演时的年龄。",
    "gold_sql": "SELECT C.Name , C.Age + ( A.Year - strftime ( '%Y' , 'now' ) ) AS age_at_concert FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.Theme = 'Free choice'"
  },
  {
    "db_id": "concert_singer",
    "question": "假如1985年前出生的歌手都参加过主题为“Free choice”的音乐会，主题为“Free choice”的音乐会的参演歌手参演时多少岁？他们的名字分别是什么？",
    "gold_sql": "SELECT C.Name , C.Age + ( ( SELECT Year FROM concert WHERE Theme = 'Free choice' ) - strftime ( '%Y' , 'now' ) ) AS age_at_concert FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.Theme = 'Free choice' OR strftime ( '%Y' , 'now' ) - C.Age < 1985 GROUP BY C.Name"
  },
  {
    "db_id": "concert_singer",
    "question": "假如所有出生于1985年以前的歌手都是主题为“Free choice”的音乐会的参演歌手，那么主题为“Free choice”的音乐会的参演歌手当时分别多少岁？他们的名字分别是什么？",
    "gold_sql": "SELECT C.Name , C.Age + ( ( SELECT Year FROM concert WHERE Theme = 'Free choice' ) - strftime ( '%Y' , 'now' ) ) AS age_at_concert FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.Theme = 'Free choice' OR strftime ( '%Y' , 'now' ) - C.Age < 1985 GROUP BY C.Name"
  },
  {
    "db_id": "concert_singer",
    "question": "最早的一次音乐会距今多少年了？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) - MIN ( Year ) AS years FROM concert"
  },
  {
    "db_id": "concert_singer",
    "question": "多少年以前举行了最早的音乐会？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) - MIN ( Year ) AS years FROM concert"
  },
  {
    "db_id": "concert_singer",
    "question": "假如主题为“Wide Awake”的音乐会提前三年举办，最早的一次音乐会距今多少年了？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) - MIN ( Year ) AS years FROM ( SELECt Year - 3 AS Year FROM concert WHERE Theme = 'Wide Awake' UNION ALL SELECT Year FROM concert WHERE Theme != 'Wide Awake' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如主题为“Wide Awake”的音乐会的举办时间提前三年，那么多少年以前举行了最早的音乐会？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) - MIN ( Year ) AS years FROM ( SELECt Year - 3 AS Year FROM concert WHERE Theme = 'Wide Awake' UNION ALL SELECT Year FROM concert WHERE Theme != 'Wide Awake' )"
  },
  {
    "db_id": "concert_singer",
    "question": "“Home Visits”音乐会20周年的时候，它的参演歌手多少岁了？同时给出参演歌手的名字。",
    "gold_sql": "SELECT C.Name , A.Year - strftime ( '%Y' , 'now' ) + C.Age + 20 AS target_age FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.concert_Name = 'Home Visits'"
  },
  {
    "db_id": "concert_singer",
    "question": "返回“Home Visits”音乐会20周年的时候它的参演歌手的年纪，同时给出参演歌手的名字。",
    "gold_sql": "SELECT C.Name , A.Year - strftime ( '%Y' , 'now' ) + C.Age + 20 AS target_age FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.concert_Name = 'Home Visits'"
  },
  {
    "db_id": "concert_singer",
    "question": "假如参加过在斯塔克公园举行的音乐会的歌手全都参加过“Home Visits”音乐会，“Home Visits”音乐会20周年的时候，它的参演歌手都多少岁了？同时给出他们的名字。",
    "gold_sql": "SELECT C.Name , ( SELECT Year FROM concert WHERE concert_Name = 'Home Visits' ) - strftime ( '%Y' , 'now' ) + C.Age + 20 AS target_age FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.concert_Name = 'Home Visits' OR B.Singer_ID IN ( SELECT C.Singer_ID FROM concert A JOIN stadium B ON A.Stadium_ID = B.Stadium_ID JOIN singer_in_concert C ON A.concert_ID = C.concert_ID WHERE B.Name = 'Stark''s Park' ) GROUP BY B.Singer_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "假设所有参演过在斯塔克公园的组织的音乐会也都参加过“Home Visits”音乐会，返回“Home Visits”音乐会20周年的时候它的参演歌手的姓名和年纪。",
    "gold_sql": "SELECT C.Name , ( SELECT Year FROM concert WHERE concert_Name = 'Home Visits' ) - strftime ( '%Y' , 'now' ) + C.Age + 20 AS target_age FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID WHERE A.concert_Name = 'Home Visits' OR B.Singer_ID IN ( SELECT C.Singer_ID FROM concert A JOIN stadium B ON A.Stadium_ID = B.Stadium_ID JOIN singer_in_concert C ON A.concert_ID = C.concert_ID WHERE B.Name = 'Stark''s Park' ) GROUP BY B.Singer_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "巴尔穆尔场馆票价一张20美元，汉普登公园场馆票价一张5.5美元。满座的时候，巴尔穆尔场馆和汉普登公园场馆卖票一共能挣多少钱？",
    "gold_sql": "SELECT Capacity * 20 + ( SELECT Capacity * 5.5 FROM stadium WHERE Name = 'Hampden Park' ) AS total FROM stadium WHERE Name = 'Balmoor'"
  },
  {
    "db_id": "concert_singer",
    "question": "巴尔穆尔场馆的票价为20美元一张，汉普登公园场馆的票价为5.5美元一张。假设两个场馆都满座的话，它们的票房总收入是多少？",
    "gold_sql": "SELECT Capacity * 20 + ( SELECT Capacity * 5.5 FROM stadium WHERE Name = 'Hampden Park' ) AS total FROM stadium WHERE Name = 'Balmoor'"
  },
  {
    "db_id": "concert_singer",
    "question": "巴尔穆尔场馆票价一张20美元，汉普登公园场馆票价一张5.5美元。假如汉普登公园场馆的容量是巴尔穆尔场馆的两倍，满座的时候，巴尔穆尔场馆和汉普登公园场馆卖票一共能挣多少钱？",
    "gold_sql": "SELECT Capacity * 20 + 2 * Capacity * 5.5 AS total FROM stadium WHERE Name = 'Balmoor'"
  },
  {
    "db_id": "concert_singer",
    "question": "巴尔穆尔场馆的票价为20美元一张，汉普登公园场馆的票价为5.5美元一张。假设汉普登公园场馆的容量是巴尔穆尔场馆的两倍且两个场馆都满座的话，它们的票房总收入是多少？",
    "gold_sql": "SELECT Capacity * 20 + 2 * Capacity * 5.5 AS total FROM stadium WHERE Name = 'Balmoor'"
  },
  {
    "db_id": "concert_singer",
    "question": "1980年前出生的歌手出演一场音乐会薪酬355美元，1980年及以后出生的歌手出演一场音乐会薪酬228美元。在萨默塞特公园场馆举办的音乐会给歌手付薪酬一共花了多少钱？",
    "gold_sql": "SELECT p1 + p2 AS cost FROM ( SELECT 355 * ( COUNT ( * ) ) AS p1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND strftime ( '%Y' , 'now' ) - C.Age < 1980 ) JOIN ( SELECT 228 * ( COUNT ( * ) ) AS p2 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND strftime ( '%Y' , 'now' ) - C.Age >= 1980 )"
  },
  {
    "db_id": "concert_singer",
    "question": "对于1980年前出生的歌手，薪酬是355美元一场演出；而对于1980年及以后出生的歌手，薪酬是228美元一场演出。计算一下目前在萨默塞特公园场馆举办的音乐会总共花费了多少用于支付歌手的薪酬。",
    "gold_sql": "SELECT p1 + p2 AS cost FROM ( SELECT 355 * ( COUNT ( * ) ) AS p1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND strftime ( '%Y' , 'now' ) - C.Age < 1980 ) JOIN ( SELECT 228 * ( COUNT ( * ) ) AS p2 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND strftime ( '%Y' , 'now' ) - C.Age >= 1980 )"
  },
  {
    "db_id": "concert_singer",
    "question": "1980年前出生的歌手出演一场音乐会薪酬355美元，1980年及以后出生的歌手出演一场音乐会薪酬228美元。假如贾斯汀·布朗比约翰·尼西尼克大3岁，在萨默塞特公园场馆举办的音乐会给歌手付薪酬一共花了多少？",
    "gold_sql": "SELECT p1 + p2 AS cost FROM ( SELECT 355 * ( COUNT ( * ) ) AS p1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN ( SELECT Singer_ID , Name , strftime ( '%Y' , 'now' ) - Age AS birth_year FROM singer WHERE Name != 'Justin Brown' UNION ALL SELECT Singer_ID , Name , ( SELECT strftime ( '%Y' , 'now' ) - Age FROM singer WHERE Name = 'John Nizinik' ) - 3 AS birth_year FROM singer WHERE Name = 'Justin Brown' ) C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.birth_year < 1980 ) JOIN ( SELECT 228 * ( COUNT ( * ) ) AS p2 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN ( SELECT Singer_ID , Name , strftime ( '%Y' , 'now' ) - Age AS birth_year FROM singer WHERE Name != 'Justin Brown' UNION ALL SELECT Singer_ID , Name , ( SELECT strftime ( '%Y' , 'now' ) - Age FROM singer WHERE Name = 'John Nizinik' ) - 3 AS birth_year FROM singer WHERE Name = 'Justin Brown' ) C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.birth_year >= 1980 )"
  },
  {
    "db_id": "concert_singer",
    "question": "对于1980年前出生的歌手，薪酬是355美元一场演出；而对于1980年及以后出生的歌手，薪酬是228美元一场演出。假设贾斯汀·布朗比约翰·尼西尼克大3岁，计算一下目前在萨默塞特公园场馆举办的音乐会总共花费了多少用于支付歌手的薪酬。",
    "gold_sql": "SELECT p1 + p2 AS cost FROM ( SELECT 355 * ( COUNT ( * ) ) AS p1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN ( SELECT Singer_ID , Name , strftime ( '%Y' , 'now' ) - Age AS birth_year FROM singer WHERE Name != 'Justin Brown' UNION ALL SELECT Singer_ID , Name , ( SELECT strftime ( '%Y' , 'now' ) - Age FROM singer WHERE Name = 'John Nizinik' ) - 3 AS birth_year FROM singer WHERE Name = 'Justin Brown' ) C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.birth_year < 1980 ) JOIN ( SELECT 228 * ( COUNT ( * ) ) AS p2 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN ( SELECT Singer_ID , Name , strftime ( '%Y' , 'now' ) - Age AS birth_year FROM singer WHERE Name != 'Justin Brown' UNION ALL SELECT Singer_ID , Name , ( SELECT strftime ( '%Y' , 'now' ) - Age FROM singer WHERE Name = 'John Nizinik' ) - 3 AS birth_year FROM singer WHERE Name = 'Justin Brown' ) C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON A.Stadium_ID = D.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.birth_year >= 1980 )"
  },
  {
    "db_id": "concert_singer",
    "question": "平均入座率最低和最高的场馆分别是哪个，它们分别开过几场音乐会？",
    "gold_sql": "SELECT * FROM ( SELECT Name AS highest_name FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_highest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) ) JOIN ( SELECT Name AS lowest_name FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_lowest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "请告诉我平均入座率最低和最高的场馆的名字以及它们各自举办过的音乐会数量。",
    "gold_sql": "SELECT * FROM ( SELECT Name AS highest_name FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_highest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) ) JOIN ( SELECT Name AS lowest_name FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_lowest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM stadium GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如盖菲尔德公园场馆的容量是汉普登公园场馆的十分之一，平均入座率最低和最高的场馆分别是哪个，它们分别开过几场音乐会？",
    "gold_sql": "SELECT * FROM ( SELECT Name AS highest_name FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_highest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) ) JOIN ( SELECT Name AS lowest_name FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_lowest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如盖菲尔德公园场馆的容量是汉普登公园场馆的十分之一，请告诉我平均入座率最低和最高的场馆的名字以及它们各自举办过的音乐会数量。",
    "gold_sql": "SELECT * FROM ( SELECT Name AS highest_name FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_highest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity DESC LIMIT 1 ) ) JOIN ( SELECT Name AS lowest_name FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) JOIN ( SELECT COUNT ( * ) AS concerts_in_lowest_stadium FROM stadium A JOIN concert B ON A.Stadium_ID = B.Stadium_ID WHERE A.Stadium_ID = ( SELECT Stadium_ID FROM ( SELECT Stadium_ID , Name , ( SELECT Capacity FROM stadium WHERE Name = 'Hampden Park' ) / 10 AS Capacity , Average FROM stadium WHERE Name = 'Gayfield Park' UNION ALL SELECt Stadium_ID , Name , Capacity , Average FROM stadium WHERE Name != 'Gayfield Park' ) GROUP BY Stadium_ID ORDER BY 100.0 * Average / Capacity ASC LIMIT 1 ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "在萨默塞特公园场馆举办的每个音乐会的ID和名字分别是什么？每场音乐会中有百分之多少的歌手是女歌手？",
    "gold_sql": "SELECT t1.concert_ID, t1.concert_Name, 100.0 * n_female / n AS female_proportion FROM (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.Is_male = 'F' GROUP BY A.concert_ID UNION ALL SELECT A.concert_ID, A.concert_Name, 0 AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND A.concert_ID NOT IN (SELECT A.concert_ID FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.Is_male = 'F' GROUP BY A.concert_ID) GROUP BY A.concert_ID) t1 JOIN (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' GROUP BY A.concert_ID) t2 ON t1.concert_ID = t2.concert_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "列出在萨默塞特公园场馆举办的每场音乐会的ID和名字，以及其中女歌手在歌手中的百分比。",
    "gold_sql": "SELECT t1.concert_ID, t1.concert_Name, 100.0 * n_female / n AS female_proportion FROM (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.Is_male = 'F' GROUP BY A.concert_ID UNION ALL SELECT A.concert_ID, A.concert_Name, 0 AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND A.concert_ID NOT IN (SELECT A.concert_ID FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' AND C.Is_male = 'F' GROUP BY A.concert_ID) GROUP BY A.concert_ID) t1 JOIN (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE D.Name = 'Somerset Park' GROUP BY A.concert_ID) t2 ON t1.concert_ID = t2.concert_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "假如“Week 2”音乐会在萨默塞特公园场馆举办，在萨默塞特公园场馆举办的每个音乐会的ID和名字是什么，其中有百分之多少的歌手是女歌手？",
    "gold_sql": "SELECT t1.concert_ID, t1.concert_Name, 100.0 * n_female / n AS female_proportion FROM (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND C.Is_male = 'F' GROUP BY A.concert_ID UNION ALL SELECT A.concert_ID, A.concert_Name, 0 AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND A.concert_ID NOT IN (SELECT A.concert_ID FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND C.Is_male = 'F' GROUP BY A.concert_ID) GROUP BY A.concert_ID) t1 JOIN (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') GROUP BY A.concert_ID) t2 ON t1.concert_ID = t2.concert_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "假如“Week 2”音乐会的举办场地是萨默塞特公园场馆，列出在萨默塞特公园场馆举办的每场音乐会的ID，姓名，以及女歌手在歌手中的百分比。",
    "gold_sql": "SELECT t1.concert_ID, t1.concert_Name, 100.0 * n_female / n AS female_proportion FROM (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND C.Is_male = 'F' GROUP BY A.concert_ID UNION ALL SELECT A.concert_ID, A.concert_Name, 0 AS n_female FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND A.concert_ID NOT IN (SELECT A.concert_ID FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') AND C.Is_male = 'F' GROUP BY A.concert_ID) GROUP BY A.concert_ID) t1 JOIN (SELECT A.concert_ID, A.concert_Name, COUNT (*) AS n FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN singer C ON B.Singer_ID = C.Singer_ID JOIN stadium D ON D.Stadium_ID = A.Stadium_ID WHERE (D.Name = 'Somerset Park' OR A.concert_Name = 'Week 2') GROUP BY A.concert_ID) t2 ON t1.concert_ID = t2.concert_ID"
  },
  {
    "db_id": "concert_singer",
    "question": "总共有百分之多少的音乐会是在平均入座率前三的场馆举办的？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM concert ) AS percent FROM concert WHERE Stadium_ID IN ( SELECT Stadium_ID FROM stadium ORDER BY 100.0 * Average / Capacity DESC LIMIT 3 )"
  },
  {
    "db_id": "concert_singer",
    "question": "计算一下在平均入座率前三的场馆举办的音乐会数量占所有音乐会数量的百分比。",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM concert ) AS percent FROM concert WHERE Stadium_ID IN ( SELECT Stadium_ID FROM stadium ORDER BY 100.0 * Average / Capacity DESC LIMIT 3 )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如主题为“Bleeding Love”的音乐会在格里公园举办，总共有百分之多少的音乐会是在平均入座率前三的场馆举办的？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM concert ) AS percent FROM ( SELECT Stadium_ID FROM stadium WHERE Name = 'Glebe Park' UNION ALL SELECT Stadium_ID FROM concert WHERE Theme != 'Bleeding Love' ) WHERE Stadium_ID IN ( SELECT Stadium_ID FROM stadium ORDER BY 100.0 * Average / Capacity DESC LIMIT 3 )"
  },
  {
    "db_id": "concert_singer",
    "question": "假设主题为“Bleeding Love”的音乐会的举办场地是格里公园，计算一下在平均入座率前三的场馆举办的音乐会数量占所有音乐会数量的百分比。",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM concert ) AS percent FROM ( SELECT Stadium_ID FROM stadium WHERE Name = 'Glebe Park' UNION ALL SELECT Stadium_ID FROM concert WHERE Theme != 'Bleeding Love' ) WHERE Stadium_ID IN ( SELECT Stadium_ID FROM stadium ORDER BY 100.0 * Average / Capacity DESC LIMIT 3 )"
  },
  {
    "db_id": "concert_singer",
    "question": "哪个场馆去演唱过的歌手数量不少于去格里公园场馆唱过的歌手数量的三倍？",
    "gold_sql": "SELECT C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID GROUP BY C.Stadium_ID HAVING COUNT ( DISTINCT ( B.Singer_ID ) ) >= 3 * ( SELECT COUNT ( DISTINCT ( B.Singer_ID ) ) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Glebe Park' )"
  },
  {
    "db_id": "concert_singer",
    "question": "列出去演唱过的歌手数量不少于去格里公园场馆唱过的歌手数量的三倍的场馆。",
    "gold_sql": "SELECT C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID GROUP BY C.Stadium_ID HAVING COUNT ( DISTINCT ( B.Singer_ID ) ) >= 3 * ( SELECT COUNT ( DISTINCT ( B.Singer_ID ) ) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Glebe Park' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如去过萨默塞特公园场馆演唱的歌手都去过巴尔穆尔场馆，哪个场馆去演唱过歌手数量不少于格里公园场馆的三倍？列出这些场馆的名字。",
    "gold_sql": "SELECT Name FROM ( SELECT C.Stadium_ID , B.Singer_ID , C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID UNION ALL SELECT ( SELECT Stadium_ID FROM stadium WHERE Name = 'Balmoor' ) , B.Singer_ID , C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Somerset Park' ) GROUP BY Stadium_ID HAVING COUNT ( DISTINCT ( Singer_ID ) ) >= 3 * ( SELECT COUNT ( DISTINCT ( B.Singer_ID ) ) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Glebe Park' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如所有去萨默塞特公园场馆演唱过的歌手也都去过巴尔穆尔场馆，列出去演唱过的歌手数量不少于去格里公园场馆唱过的歌手数量的三倍的场馆的名字。",
    "gold_sql": "SELECT Name FROM ( SELECT C.Stadium_ID , B.Singer_ID , C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID UNION ALL SELECT ( SELECT Stadium_ID FROM stadium WHERE Name = 'Balmoor' ) , B.Singer_ID , C.Name FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Somerset Park' ) GROUP BY Stadium_ID HAVING COUNT ( DISTINCT ( Singer_ID ) ) >= 3 * ( SELECT COUNT ( DISTINCT ( B.Singer_ID ) ) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID JOIN stadium C ON A.Stadium_ID = C.Stadium_ID WHERE C.name = 'Glebe Park' )"
  },
  {
    "db_id": "concert_singer",
    "question": "哪个场馆的最高入座率比巴尔穆尔场馆的最高入座率两倍还多？列出这些场馆的名字。",
    "gold_sql": "SELECT Name FROM stadium WHERE 100.0 * Highest / Capacity > 2 * ( SELECT 100.0 * Highest / Capacity FROM stadium WHERE Name = 'Balmoor' )"
  },
  {
    "db_id": "concert_singer",
    "question": "列出最高入座率比巴尔穆尔场馆的最高入座率两倍还高的场馆的名字。",
    "gold_sql": "SELECT Name FROM stadium WHERE 100.0 * Highest / Capacity > 2 * ( SELECT 100.0 * Highest / Capacity FROM stadium WHERE Name = 'Balmoor' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如巴尔穆尔场馆的容量是5600，哪个场馆的最高入座率比巴尔穆尔场馆的最高入座率两倍还多？列出这些场馆的名字。",
    "gold_sql": "SELECT Name FROM stadium WHERE 100.0 * Highest / Capacity > 2 * ( SELECT 100.0 * Highest / 5600 FROM stadium WHERE Name = 'Balmoor' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假设巴尔穆尔场馆最多只能容下5600人，列出最高入座率比巴尔穆尔场馆的最高入座率两倍还高的场馆的名字。",
    "gold_sql": "SELECT Name FROM stadium WHERE 100.0 * Highest / Capacity > 2 * ( SELECT 100.0 * Highest / 5600 FROM stadium WHERE Name = 'Balmoor' )"
  },
  {
    "db_id": "concert_singer",
    "question": "哪场2012年后举办的音乐会的歌手数量比“Happy Tonight”主题音乐会歌手数量多，是它的多少倍？同时给出音乐会的ID和全名。",
    "gold_sql": "SELECT A.concert_ID, A.concert_Name, 1.0 * COUNT (DISTINCT (B.Singer_ID)) / (SELECT COUNT (DISTINCT (B.Singer_ID)) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' ) AS times FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Year > 2012 GROUP BY A.concert_ID HAVING COUNT (DISTINCT (B.Singer_ID)) > (SELECT COUNT (DISTINCT (B.Singer_ID)) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' )"
  },
  {
    "db_id": "concert_singer",
    "question": "举办于2012年以后的音乐会中，哪场音乐会的参演歌手比“Happy Tonight”主题音乐会歌手多，是它的多少倍？同时给出音乐会的ID和全名。",
    "gold_sql": "SELECT A.concert_ID, A.concert_Name, 1.0 * COUNT (DISTINCT (B.Singer_ID)) / (SELECT COUNT (DISTINCT (B.Singer_ID)) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' ) AS times FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Year > 2012 GROUP BY A.concert_ID HAVING COUNT (DISTINCT (B.Singer_ID)) > (SELECT COUNT (DISTINCT (B.Singer_ID)) FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如每场音乐会都有歌手乔·夏普，哪场2012年后举办的音乐会的歌手数量比“Happy Tonight”主题音乐会歌手数量多，是它的多少倍？同时给出这些音乐会的ID和全名。",
    "gold_sql": "SELECT A.concert_ID, A.concert_Name, 1.0 * (COUNT (DISTINCT (B.Singer_ID)) + 1) / (SELECT COUNT (DISTINCT (B.Singer_ID)) + 1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) ) AS times FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Year > 2012 AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) GROUP BY A.concert_ID HAVING (COUNT (DISTINCT (B.Singer_ID)) + 1) > (SELECT COUNT (DISTINCT (B.Singer_ID)) + 1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如乔·夏普参演了每一场音乐会，举办于2012年以后的音乐会中，哪场音乐会的参演歌手比“Happy Tonight”主题音乐会歌手多，是它的多少倍？同时给出这些音乐会的ID和全名。",
    "gold_sql": "SELECT A.concert_ID, A.concert_Name, 1.0 * (COUNT (DISTINCT (B.Singer_ID)) + 1) / (SELECT COUNT (DISTINCT (B.Singer_ID)) + 1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) ) AS times FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Year > 2012 AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) GROUP BY A.concert_ID HAVING (COUNT (DISTINCT (B.Singer_ID)) + 1) > (SELECT COUNT (DISTINCT (B.Singer_ID)) + 1 FROM concert A JOIN singer_in_concert B ON A.concert_ID = B.concert_ID WHERE A.Theme = 'Happy Tonight' AND B.Singer_ID != (SELECT Singer_ID FROM singer WHERE Name = 'Joe Sharp' ) )"
  },
  {
    "db_id": "concert_singer",
    "question": "“Love”这首歌发布的时候哪些歌手的年龄比这首歌的演唱者的两倍还大？列出这些歌手的名字。",
    "gold_sql": "SELECT Name FROM singer WHERE ( SELECT Song_release_year FROM singer WHERE Song_Name = 'Love' ) - ( strftime ( '%Y' , 'now' ) - Age ) > 2 * ( SELECT Age - ( strftime ( '%Y' , 'now' ) - Song_release_year ) FROM singer WHERE Song_Name = 'Love' )"
  },
  {
    "db_id": "concert_singer",
    "question": "列出“Love”这首歌发布的时候年龄比这首歌的演唱者的两倍还大的歌手的名字。",
    "gold_sql": "SELECT Name FROM singer WHERE ( SELECT Song_release_year FROM singer WHERE Song_Name = 'Love' ) - ( strftime ( '%Y' , 'now' ) - Age ) > 2 * ( SELECT Age - ( strftime ( '%Y' , 'now' ) - Song_release_year ) FROM singer WHERE Song_Name = 'Love' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如“Love”发布于2010年，“Love”这首歌发布的时候哪些歌手的年龄比这首歌的演唱者的两倍还大？列出这些歌手的名字。",
    "gold_sql": "SELECT Name FROM singer WHERE 2010 - ( strftime ( '%Y' , 'now' ) - Age ) > 2 * ( SELECT Age - ( strftime ( '%Y' , 'now' ) - 2010 ) FROM singer WHERE Song_Name = 'Love' )"
  },
  {
    "db_id": "concert_singer",
    "question": "假如“Love”发布于2010年，列出“Love”这首歌发布的时候年龄比这首歌的演唱者的两倍还大的歌手的名字。",
    "gold_sql": "SELECT Name FROM singer WHERE 2010 - ( strftime ( '%Y' , 'now' ) - Age ) > 2 * ( SELECT Age - ( strftime ( '%Y' , 'now' ) - 2010 ) FROM singer WHERE Song_Name = 'Love' )"
  },
   {
    "db_id": "customers_and_products_contacts",
    "question": "斯特林至今花了多少钱了？",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "到目前为止，斯特林已经花费了多少钱？",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如所有古琦产品的单价都是600，斯特林至今花了多少钱了？",
    "gold_sql": "SELECT SUM ( cost ) FROM ( SELECT SUM ( C.order_quantity * 600 ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling' AND product_name = 'gucci' UNION SELECT SUM ( C.order_quantity * D.product_price ) AS ost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling' AND product_name != 'gucci' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如所有古琦产品通通600一件，到目前为止，斯特林已经花费了多少钱？",
    "gold_sql": "SELECT SUM ( cost ) FROM ( SELECT SUM ( C.order_quantity * 600 ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling' AND product_name = 'gucci' UNION SELECT SUM ( C.order_quantity * D.product_price ) AS ost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling' AND product_name != 'gucci' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "斯特林是会员，买所有产品都有八折优惠，他至今花了多少钱了？",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price * ( 1.0 - 1.0 * 20 / 100 ) ) AS cost_after_discount FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "斯特林作为会员买所有产品都享有八折优惠，计算一下他目前为止的消费总金额。",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price * ( 1.0 - 1.0 * 20 / 100 ) ) AS cost_after_discount FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "斯特林是会员，买所有产品都有八折优惠，他至今节约了多少钱了？",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price * ( 1.0 * 20 / 100 ) ) AS svaed_money FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "斯特林作为会员买所有产品都享有八折优惠，计算一下他目前为止的总节省金额。",
    "gold_sql": "SELECT SUM ( C.order_quantity * D.product_price * ( 1.0 * 20 / 100 ) ) AS svaed_money FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Sterling'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "按照用户至今的花费总额的从多到少，列出客户id、姓名、地址、电话、电子邮件。",
    "gold_sql": "SELECT A.customer_id , A.customer_name , A.customer_address , A.customer_phone , A.customer_email , SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id GROUP BY A.customer_name ORDER BY cost DESC"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "请给出每个客户的id、姓名、地址、电话和电子邮件，按照他们截止当前消费金额的从高到低。",
    "gold_sql": "SELECT A.customer_id , A.customer_name , A.customer_address , A.customer_phone , A.customer_email , SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id GROUP BY A.customer_name ORDER BY cost DESC"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "克莱奥最新的订单总价多少？",
    "gold_sql": "SELECT cost FROM ( SELECT B.order_date , SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Cleo' GROUP BY C.order_id ) ORDER BY order_date DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "克莱奥在最近一次订单中总共花费了多少钱？",
    "gold_sql": "SELECT cost FROM ( SELECT B.order_date , SUM ( C.order_quantity * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Cleo' GROUP BY C.order_id ) ORDER BY order_date DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "克莱奥最新的订单总价多少，假如他每个产品都买了5个？",
    "gold_sql": "SELECT cost FROM ( SELECT B.order_date , SUM ( 5.0 * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Cleo' GROUP BY C.order_id ) ORDER BY order_date DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "克莱奥在最近一次订单中总共花费了多少钱，假设他每个产品的购买数量都为五？",
    "gold_sql": "SELECT cost FROM ( SELECT B.order_date , SUM ( 5.0 * D.product_price ) AS cost FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.customer_name = 'Cleo' GROUP BY C.order_id ) ORDER BY order_date DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "苹果产品的成本是出售价格的40%，古琦产品的成本是出售价格的20%，其他产品的成本是出售价格的50%。请列出各个产品的ID、名字、销售量、销售额、毛利润总额。",
    "gold_sql": "SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 40.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'Apple' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 20.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 50.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name != 'Apple' AND B.product_name != 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , 0 , 0 , 0 FROM ( SELECT product_id FROM Products A EXCEPT SELECT B.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id ) A JOIN Products B ON A.product_id = B.product_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "请提供各个产品的ID、名称、销售量、销售额和总毛利润金额。其中，苹果产品的成本是销售价格的40%，古琦产品的成本是销售价格的20%，其他产品的成本是销售价格的50%。",
    "gold_sql": "SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 40.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'Apple' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 20.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 50.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name != 'Apple' AND B.product_name != 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , 0 , 0 , 0 FROM ( SELECT product_id FROM Products A EXCEPT SELECT B.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id ) A JOIN Products B ON A.product_id = B.product_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "苹果产品的成本是出售价格的40%，古琦产品的成本是出售价格的20%，其他产品的成本是出售价格的50%。假如所有苹果产品降价了15%了，请列出各个产品的ID、名字、销售量、销售额、毛利润总额。",
    "gold_sql": "SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * ( B.product_price * ( 1.0 - 15.0 / 100 ) ) ) AS revenue , SUM ( A.order_quantity * ( B.product_price * ( 1.0 - 15.0 / 100 ) ) ) * ( 1.0 - 40.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'Apple' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 20.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 50.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name != 'Apple' AND B.product_name != 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , 0 , 0 , 0 FROM ( SELECT product_id FROM Products A EXCEPT SELECT B.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id ) A JOIN Products B ON A.product_id = B.product_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假设苹果产品的价格通通减少15%，请提供各个产品的ID、名称、销售量、销售额和总毛利润金额。其中，苹果产品的成本是销售价格的40%，古琦产品的成本是销售价格的20%，其他产品的成本是销售价格的50%。",
    "gold_sql": "SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * ( B.product_price * ( 1.0 - 15.0 / 100 ) ) ) AS revenue , SUM ( A.order_quantity * ( B.product_price * ( 1.0 - 15.0 / 100 ) ) ) * ( 1.0 - 40.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'Apple' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 20.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name = 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , SUM ( A.order_quantity ) AS quantity , SUM ( A.order_quantity * B.product_price ) AS revenue , SUM ( A.order_quantity * B.product_price ) * ( 1.0 - 50.0 / 100 ) AS profit FROM Order_Items A JOIN Products B ON A.product_id = B.product_id WHERE B.product_name != 'Apple' AND B.product_name != 'gucci' GROUP BY B.product_id UNION SELECT B.product_id , B.product_name , 0 , 0 , 0 FROM ( SELECT product_id FROM Products A EXCEPT SELECT B.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id ) A JOIN Products B ON A.product_id = B.product_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "有百分之多少的订单已经已完成？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customer_Orders ) * 100 AS percent FROM Customer_Orders WHERE order_status_code = 'Completed'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "计算一下处于已完成状态的订单占所有订单的百分比。",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customer_Orders ) * 100 AS percent FROM Customer_Orders WHERE order_status_code = 'Completed'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如2000年以前的订单都完成了，有百分之多少的订单已经已完成？",
    "gold_sql": "SELECT 100 - 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customer_Orders ) * 100 AS percent FROM Customer_Orders WHERE strftime ( '%Y' , order_date ) >= '2000' AND order_status_code != 'Completed'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如2000年前的订单都处于已完成状态，计算一下处于已完成状态的订单占所有订单的百分比。",
    "gold_sql": "SELECT 100 - 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customer_Orders ) * 100 AS percent FROM Customer_Orders WHERE strftime ( '%Y' , order_date ) >= '2000' AND order_status_code != 'Completed'"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "有多个联系方式的用户的姓名和第一个订单的金额是多少？",
    "gold_sql": "SELECT customer_name , price FROM ( SELECT M.customer_id , N.customer_name , M.price , MIN ( M.order_date ) FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Contacts GROUP BY customer_id HAVING COUNT ( * ) > 1 ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出有多个联系方式的用户的姓名，以及他的首单消费额。",
    "gold_sql": "SELECT customer_name , price FROM ( SELECT M.customer_id , N.customer_name , M.price , MIN ( M.order_date ) FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Contacts GROUP BY customer_id HAVING COUNT ( * ) > 1 ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如2000年前所有苹果产品的单价都是888，有多个联系方式的用户第一个订单的金额是多少？",
    "gold_sql": "SELECT customer_name , price FROM ( SELECT M.customer_id , N.customer_name , M.price , MIN ( M.order_date ) FROM ( SELECT customer_id , order_id , order_date , SUM ( price ) AS price FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * 888.0 ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id WHERE C.product_name = 'Apple' AND strftime ( '%Y' , B.order_date ) < '2000' GROUP BY B.customer_id , B.order_id UNION SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id WHERE C.product_name != 'Apple' OR strftime ( '%Y' , B.order_date ) >= '2000' GROUP BY B.customer_id , B.order_id ) GROUP BY customer_id , order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Contacts GROUP BY customer_id HAVING COUNT ( * ) > 1 ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如所有苹果产品在2000年以前的价格均为888，列出有多个联系方式的用户的姓名，以及他的首单消费额。",
    "gold_sql": "SELECT customer_name , price FROM ( SELECT M.customer_id , N.customer_name , M.price , MIN ( M.order_date ) FROM ( SELECT customer_id , order_id , order_date , SUM ( price ) AS price FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * 888.0 ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id WHERE C.product_name = 'Apple' AND strftime ( '%Y' , B.order_date ) < '2000' GROUP BY B.customer_id , B.order_id UNION SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id WHERE C.product_name != 'Apple' OR strftime ( '%Y' , B.order_date ) >= '2000' GROUP BY B.customer_id , B.order_id ) GROUP BY customer_id , order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Contacts GROUP BY customer_id HAVING COUNT ( * ) > 1 ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "哪些用户曾有过多个不同的地址，给出他们的名字，以及它们每个人至今用得最久的地址的邮编。",
    "gold_sql": "SELECT customer_name, zip_postcode FROM (SELECT C.customer_name, B.zip_postcode, MAX (julianday (A.date_to) - julianday (A.date_from)) FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Customers C ON C.customer_id = A.customer_id GROUP BY A.customer_id HAVING COUNT (*) > 1)"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出曾有过多个不同的地址的用户的名字，以及他们至今用得最久的邮编。",
    "gold_sql": "SELECT customer_name, zip_postcode FROM (SELECT C.customer_name, B.zip_postcode, MAX (julianday (A.date_to) - julianday (A.date_from)) FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Customers C ON C.customer_id = A.customer_id GROUP BY A.customer_id HAVING COUNT (*) > 1)"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "哪些用户从未有过多个不同的地址，给出他们的名字，以及它们每个人的邮编地址。",
    "gold_sql": "SELECT C.customer_name, B.zip_postcode FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Customers C ON C.customer_id = A.customer_id GROUP BY A.customer_id HAVING COUNT (*) = 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出从未有过多个不同地址的用户的名字，以及他们的邮编地址。",
    "gold_sql": "SELECT C.customer_name, B.zip_postcode FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Customers C ON C.customer_id = A.customer_id GROUP BY A.customer_id HAVING COUNT (*) = 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "哪个用户在2000年以后再也没有下过订单，列出他的id、名字、邮件以及最后一笔订单的金额？",
    "gold_sql": "SELECT customer_id , customer_name , customer_email , price AS last_order_price FROM ( SELECT M.customer_id , N.customer_name , N.customer_email , M.price , MAX ( M.order_date ) FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Customer_Orders GROUP BY customer_id HAVING strftime ( '%Y' , MAX ( order_date ) ) < '2000' ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出在2000年以后再也没有买过东西的用户的id、名字、邮件、以及最后一笔订单的的消费额。",
    "gold_sql": "SELECT customer_id , customer_name , customer_email , price AS last_order_price FROM ( SELECT M.customer_id , N.customer_name , N.customer_email , M.price , MAX ( M.order_date ) FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) M JOIN Customers N ON M.customer_id = N.customer_id WHERE M.customer_id IN ( SELECT customer_id FROM Customer_Orders GROUP BY customer_id HAVING strftime ( '%Y' , MAX ( order_date ) ) < '2000' ) GROUP BY M.customer_id )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "用户单笔订单总价超过1000可以获得222积分，超过2000可以再获得666积分。哪个用户目前获得的总积分最多？给出他的ID。",
    "gold_sql": "SELECT customer_id FROM ( SELECT customer_id , COUNT ( * ) * ( 666 + 222 ) AS points FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) WHERE price > 2000 GROUP BY customer_id UNION SELECT customer_id , COUNT ( * ) * 222 AS points FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) WHERE price > 1000 AND price < 2000 GROUP BY customer_id ) GROUP BY customer_id ORDER BY points DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "用户可以在单笔订单总价超过1000时获得222积分，在超过2000时再获得666积分。请告诉我目前总积分最高的用户的ID。",
    "gold_sql": "SELECT customer_id FROM ( SELECT customer_id , COUNT ( * ) * ( 666 + 222 ) AS points FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) WHERE price > 2000 GROUP BY customer_id UNION SELECT customer_id , COUNT ( * ) * 222 AS points FROM ( SELECT B.customer_id , B.order_id , B.order_date , SUM ( A.order_quantity * C.product_price ) AS price FROM Order_Items A JOIN Customer_Orders B ON A.order_id = B.order_id JOIN Products C ON C.product_id = A.product_id GROUP BY B.customer_id , B.order_id ) WHERE price > 1000 AND price < 2000 GROUP BY customer_id ) GROUP BY customer_id ORDER BY points DESC LIMIT 1"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "衣服的平均单价比硬件高多少？",
    "gold_sql": "SELECT clothes_avg - hw_avg AS diff FROM ( SELECT AVG ( product_price ) AS hw_avg FROM Products WHERE product_type_code = 'Hardware' ) JOIN ( SELECT AVG ( product_price ) AS clothes_avg FROM Products WHERE product_type_code = 'Clothes' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "衣服的平均单价与硬件的平均单价相比高多少？",
    "gold_sql": "SELECT clothes_avg - hw_avg AS diff FROM ( SELECT AVG ( product_price ) AS hw_avg FROM Products WHERE product_type_code = 'Hardware' ) JOIN ( SELECT AVG ( product_price ) AS clothes_avg FROM Products WHERE product_type_code = 'Clothes' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "如果衣服涨价20%，衣服的平均单价比硬件高多少？",
    "gold_sql": "SELECT ( 1 + 20.0 / 100 ) * clothes_avg - hw_avg AS diff FROM ( SELECT AVG ( product_price ) AS hw_avg FROM Products WHERE product_type_code = 'Hardware' ) JOIN ( SELECT AVG ( product_price ) AS clothes_avg FROM Products WHERE product_type_code = 'Clothes' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "如果所有衣服的价格上升20%，衣服的平均单价与硬件的平均单价相比高多少？",
    "gold_sql": "SELECT ( 1 + 20.0 / 100 ) * clothes_avg - hw_avg AS diff FROM ( SELECT AVG ( product_price ) AS hw_avg FROM Products WHERE product_type_code = 'Hardware' ) JOIN ( SELECT AVG ( product_price ) AS clothes_avg FROM Products WHERE product_type_code = 'Clothes' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "曾使用过首府为法兰克福的州的地址的用户有多少，他们中女性的比例是多少？",
    "gold_sql": "SELECT n_total , 1.0 * n_female / n_total AS female_ratio FROM ( SELECT COUNT ( DISTINCT ( A.customer_id ) ) AS n_female FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Contacts C ON A.customer_id = C.customer_id WHERE B.state_province_county = 'Kentucky' AND C.gender = 'female' ) JOIN ( SELECT COUNT ( DISTINCT ( A.customer_id ) ) AS n_total FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id WHERE B.state_province_county = 'Kentucky' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "有多少客户的曾用地址位于首府为法兰克福的州，他们中女性占比多少？",
    "gold_sql": "SELECT n_total , 1.0 * n_female / n_total AS female_ratio FROM ( SELECT COUNT ( DISTINCT ( A.customer_id ) ) AS n_female FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id JOIN Contacts C ON A.customer_id = C.customer_id WHERE B.state_province_county = 'Kentucky' AND C.gender = 'female' ) JOIN ( SELECT COUNT ( DISTINCT ( A.customer_id ) ) AS n_total FROM Customer_Address_History A JOIN Addresses B ON A.address_id = B.address_id WHERE B.state_province_county = 'Kentucky' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "给出销售量最高的产品的ID，名字，销量，以及给出其比销售量最低的产品的销售量高多少？",
    "gold_sql": "SELECT t1.product_id , t1.product_name , MAX ( t1.quantity ) AS max_quantity , t2.diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) t1 JOIN ( SELECT MAX ( quantity ) - MIN ( quantity ) AS diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) ) t2"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "销量第一的产品的ID和名字是什么？它的销量是多少，比销量倒数第一的产品销量高多少？",
    "gold_sql": "SELECT t1.product_id , t1.product_name , MAX ( t1.quantity ) AS max_quantity , t2.diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) t1 JOIN ( SELECT MAX ( quantity ) - MIN ( quantity ) AS diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) ) t2"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "给出销售量最高的产品的ID，名字。假如它的销售量又增加了500，它的销售量变成了多少，其比销售量最低的产品的销售量高多少？",
    "gold_sql": "SELECT t1.product_id , t1.product_name , MAX ( t1.quantity ) + 500 AS max_quantity , t2.diff + 500 FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) t1 JOIN ( SELECT MAX ( quantity ) - MIN ( quantity ) AS diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) ) t2"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "销量第一的产品的ID和名字是什么？假设它的销量增加500，它的销量是多少，比销量倒数第一的产品销量高多少？",
    "gold_sql": "SELECT t1.product_id , t1.product_name , MAX ( t1.quantity ) + 500 AS max_quantity , t2.diff + 500 FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) t1 JOIN ( SELECT MAX ( quantity ) - MIN ( quantity ) AS diff FROM ( SELECT A.product_id , B.product_name , SUM ( order_quantity ) AS quantity FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id UNION SELECT product_id , product_name , 0 AS quantity FROM Products WHERE product_id NOT IN ( SELECT A.product_id FROM Order_Items A JOIN Products B ON A.product_id = B.product_id GROUP BY A.product_id ) ) ) t2"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "使用信用卡付款需要交支付金额5%的手续费。列出每个客户的姓名，其每笔订单的id，以及每笔订单共花了多少钱。",
    "gold_sql": "SELECT A.customer_name , B.order_id , ( C.order_quantity * D.product_price ) * ( 1 + 5.0 / 100 ) AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code = 'Credit Card' GROUP BY A.customer_name , B.order_id UNION SELECT A.customer_name , B.order_id , C.order_quantity * D.product_price AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code != 'Credit Card' GROUP BY A.customer_name , B.order_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "请列出每个客户的姓名，及其每笔订单的id和总花费，其中使用信用卡付款的需要额外支付金额的5%作为手续费。",
    "gold_sql": "SELECT A.customer_name , B.order_id , ( C.order_quantity * D.product_price ) * ( 1 + 5.0 / 100 ) AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code = 'Credit Card' GROUP BY A.customer_name , B.order_id UNION SELECT A.customer_name , B.order_id , C.order_quantity * D.product_price AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code != 'Credit Card' GROUP BY A.customer_name , B.order_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "使用信用卡付款需要交支付金额5%的手续费。假如每个产品的单价都是99，列出每个客户的姓名，其每笔订单的id，以及每笔订单共花了多少钱。",
    "gold_sql": "SELECT A.customer_name , B.order_id , ( C.order_quantity * 99 ) * ( 1 + 5.0 / 100 ) AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code = 'Credit Card' GROUP BY A.customer_name , B.order_id UNION SELECT A.customer_name , B.order_id , C.order_quantity * 99 AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code != 'Credit Card' GROUP BY A.customer_name , B.order_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "假如所有产品通通99一个，请列出每个客户的姓名，及其每笔订单的id和总花费，其中使用信用卡付款的需要额外支付金额的5%作为手续费。",
    "gold_sql": "SELECT A.customer_name , B.order_id , ( C.order_quantity * 99 ) * ( 1 + 5.0 / 100 ) AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code = 'Credit Card' GROUP BY A.customer_name , B.order_id UNION SELECT A.customer_name , B.order_id , C.order_quantity * 99 AS cost_plus_fee FROM Customers A JOIN Customer_Orders B ON A.customer_id = B.customer_id JOIN Order_Items C ON B.order_id = C.order_id JOIN Products D ON C.product_id = D.product_id WHERE A.payment_method_code != 'Credit Card' GROUP BY A.customer_name , B.order_id"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出年份和对应的年销售额。",
    "gold_sql": "SELECT strftime ( '%Y' , A.order_date ) AS year , SUM ( B.order_quantity * C.product_price ) AS annual_sales_revenue FROM Customer_Orders A JOIN Order_Items B ON A.order_id = B.order_id JOIN Products C ON B.product_id = C.product_id GROUP BY strftime ( '%Y' , A.order_date )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "有记录的年份和对应的年销售额是多少？",
    "gold_sql": "SELECT strftime ( '%Y' , A.order_date ) AS year , SUM ( B.order_quantity * C.product_price ) AS annual_sales_revenue FROM Customer_Orders A JOIN Order_Items B ON A.order_id = B.order_id JOIN Products C ON B.product_id = C.product_id GROUP BY strftime ( '%Y' , A.order_date )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "列出苹果产品的最高价、最低价、方差。",
    "gold_sql": "SELECT max_price , min_price , variance FROM ( SELECT 1.0 * ( product_price - AVG ( product_price ) ) * ( product_price - AVG ( product_price ) ) / COUNT ( * ) AS variance FROM Products WHERE product_name = 'Apple' ) JOIN ( SELECT MAX ( product_price ) AS max_price , MIN ( product_price ) AS min_price FROM Products WHERE product_name = 'Apple' )"
  },
  {
    "db_id": "customers_and_products_contacts",
    "question": "苹果产品的最高价、最低价、价格方差是多少？",
    "gold_sql": "SELECT max_price , min_price , variance FROM ( SELECT 1.0 * ( product_price - AVG ( product_price ) ) * ( product_price - AVG ( product_price ) ) / COUNT ( * ) AS variance FROM Products WHERE product_name = 'Apple' ) JOIN ( SELECT MAX ( product_price ) AS max_price , MIN ( product_price ) AS min_price FROM Products WHERE product_name = 'Apple' )"
  },
  {
    "db_id": "hospital_1",
    "question": "约翰·史密斯住了几天院？",
    "gold_sql": "SELECT CAST ( julianday ( A.StayEnd ) - julianday ( A.StayStart ) AS INTEGER ) AS days_diff FROM Stay A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'John Smith'"
  },
  {
    "db_id": "hospital_1",
    "question": "约翰·史密斯的总住院时间是多少天？",
    "gold_sql": "SELECT CAST ( julianday ( A.StayEnd ) - julianday ( A.StayStart ) AS INTEGER ) AS days_diff FROM Stay A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'John Smith'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果约翰·史密斯是国际护士节那天出院的，他住了几天院？",
    "gold_sql": "SELECT julianday ( strftime ( '%Y-' , A.StayEnd ) || '05-12' ) - julianday ( strftime ( '%Y-' , A.StayStart ) || strftime ( '%m-%d' , A.StayStart ) ) AS date_diff FROM Stay A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'John Smith'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果约翰·史密斯的出院日期是国际护士节，那么他总住院时间是多少天？",
    "gold_sql": "SELECT julianday ( strftime ( '%Y-' , A.StayEnd ) || '05-12' ) - julianday ( strftime ( '%Y-' , A.StayStart ) || strftime ( '%m-%d' , A.StayStart ) ) AS date_diff FROM Stay A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'John Smith'"
  },
  {
    "db_id": "hospital_1",
    "question": "使用了Foo Labs品牌的药的病人比使用了Baz Industries品牌的药的病人多多少？",
    "gold_sql": "SELECT COUNT ( DISTINCT ( Patient ) ) - ( SELECT COUNT ( DISTINCT ( Patient ) ) FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Baz Industries' ) AS diff FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Foo Labs'"
  },
  {
    "db_id": "hospital_1",
    "question": "使用过品牌为Foo Labs的药物的病人的数量比用过品牌位Baz Industries的药物的病人数量多多少？",
    "gold_sql": "SELECT COUNT ( DISTINCT ( Patient ) ) - ( SELECT COUNT ( DISTINCT ( Patient ) ) FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Baz Industries' ) AS diff FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Foo Labs'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果使用过Foo Labs品牌的病人共有10个，使用了Foo Labs品牌的药的病人比使用了Baz Industries品牌的药的病人多多少？",
    "gold_sql": "SELECT 10 - ( SELECT COUNT ( DISTINCT ( Patient ) ) FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Baz Industries' ) AS diff"
  },
  {
    "db_id": "hospital_1",
    "question": "假如总共有10位病人使用过Foo Labs品牌的药品，那么使用过品牌为Foo Labs的药物的病人的数量比用过品牌位Baz Industries的药物的病人数量多多少？",
    "gold_sql": "SELECT 10 - ( SELECT COUNT ( DISTINCT ( Patient ) ) FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Brand = 'Baz Industries' ) AS diff"
  },
  {
    "db_id": "hospital_1",
    "question": "预约次数最多的医生的预约次数是预约次数最少的医生的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( c ) / MIN ( c ) AS times FROM ( SELECT Physician , COUNT ( * ) AS c FROM Appointment GROUP BY Physician )"
  },
  {
    "db_id": "hospital_1",
    "question": "预约次数排名第一的医生的预约次数是预约数量排名倒数第一的医生的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( c ) / MIN ( c ) AS times FROM ( SELECT Physician , COUNT ( * ) AS c FROM Appointment GROUP BY Physician )"
  },
  {
    "db_id": "hospital_1",
    "question": "如果预约最少的医师新添了2个预约，预约次数最多的医生的预约次数是他的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( c ) / ( MIN ( c ) + 2 ) AS times FROM ( SELECT Physician , COUNT ( * ) AS c FROM Appointment GROUP BY Physician )"
  },
  {
    "db_id": "hospital_1",
    "question": "如果预约数量垫底的医师新添了2个预约，那预约次数排名第一的医生的预约次数是他的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( c ) / ( MIN ( c ) + 2 ) AS times FROM ( SELECT Physician , COUNT ( * ) AS c FROM Appointment GROUP BY Physician )"
  },
  {
    "db_id": "hospital_1",
    "question": "所有药物每剂2美元。Dennis Doe在药物和治疗上总共花了多少钱？",
    "gold_sql": "SELECT med_cost + pro_cost AS total_cost FROM ( SELECT 2 * SUM ( A.dose ) AS med_cost FROM Prescribes A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'Dennis Doe' ) JOIN ( SELECT SUM ( COST ) AS pro_cost FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON B.Patient = C.SSN WHERE C.name = 'Dennis Doe' )"
  },
  {
    "db_id": "hospital_1",
    "question": "如果任何药物都是2美元一剂，那么Dennis Doe在药物和治疗上的总花费是多少？",
    "gold_sql": "SELECT med_cost + pro_cost AS total_cost FROM ( SELECT 2 * SUM ( A.dose ) AS med_cost FROM Prescribes A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'Dennis Doe' ) JOIN ( SELECT SUM ( COST ) AS pro_cost FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON B.Patient = C.SSN WHERE C.name = 'Dennis Doe' )"
  },
  {
    "db_id": "hospital_1",
    "question": "所有药物每剂2美元。假如丹尼斯·多伊2008年4月30日16:53多买了10剂Thesisin，他在药物和治疗上总共花了多少钱？",
    "gold_sql": "SELECT med_cost + pro_cost + 10 * 2 AS total_cost FROM ( SELECT 2 * SUM ( A.dose ) AS med_cost FROM Prescribes A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'Dennis Doe' AND A.Date != '2008-04-30 16:53' ) JOIN ( SELECT SUM ( COST ) AS pro_cost FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON B.Patient = C.SSN WHERE C.name = 'Dennis Doe' )"
  },
  {
    "db_id": "hospital_1",
    "question": "如果任何药物都是2美元一剂，假如丹尼斯·多伊2008年4月30日16:53多购买了10剂Thesisin，那么Dennis Doe在药物和治疗上的总花费是多少？",
    "gold_sql": "SELECT med_cost + pro_cost + 10 * 2 AS total_cost FROM ( SELECT 2 * SUM ( A.dose ) AS med_cost FROM Prescribes A JOIN Patient B ON A.Patient = B.SSN WHERE B.name = 'Dennis Doe' AND A.Date != '2008-04-30 16:53' ) JOIN ( SELECT SUM ( COST ) AS pro_cost FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON B.Patient = C.SSN WHERE C.name = 'Dennis Doe' )"
  },
  {
    "db_id": "hospital_1",
    "question": "John Wen 接受培训过的手术资格认证的有效期是多长？",
    "gold_sql": "SELECT C.name , CAST ( julianday ( A.CertificationExpires ) - julianday ( A.CertificationDate ) AS INTEGER ) AS lifetime FROM Trained_In A JOIN Physician B ON A.Physician = B.EmployeeID JOIN Procedures C ON C.code = A.Treatment WHERE B.name = 'John Wen'"
  },
  {
    "db_id": "hospital_1",
    "question": "John Wen经过培训的手术资格认证在多长时间内有效？",
    "gold_sql": "SELECT C.name , CAST ( julianday ( A.CertificationExpires ) - julianday ( A.CertificationDate ) AS INTEGER ) AS lifetime FROM Trained_In A JOIN Physician B ON A.Physician = B.EmployeeID JOIN Procedures C ON C.code = A.Treatment WHERE B.name = 'John Wen'"
  },
  {
    "db_id": "hospital_1",
    "question": "John Wen 接受培训过的手术资格认证的有效期是多长，假如有效期延长180天？",
    "gold_sql": "SELECT C.name , CAST ( julianday ( A.CertificationExpires ) - julianday ( A.CertificationDate ) AS INTEGER ) + 180 AS lifetime FROM Trained_In A JOIN Physician B ON A.Physician = B.EmployeeID JOIN Procedures C ON C.code = A.Treatment WHERE B.name = 'John Wen'"
  },
  {
    "db_id": "hospital_1",
    "question": "假如所有资格认证有效期延长180天，那么John Wen 接受培训过的手术资格认证的有效期是多长？",
    "gold_sql": "SELECT C.name , CAST ( julianday ( A.CertificationExpires ) - julianday ( A.CertificationDate ) AS INTEGER ) + 180 AS lifetime FROM Trained_In A JOIN Physician B ON A.Physician = B.EmployeeID JOIN Procedures C ON C.code = A.Treatment WHERE B.name = 'John Wen'"
  },
  {
    "db_id": "hospital_1",
    "question": "同时属于外科部门和普通内科部门的医生在属于外科的医生中所占的比例是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Affiliated_With WHERE Department = ( SELECT DepartmentID FROM Department WHERE Name = 'Surgery' ) ) AS prop FROM ( select * from Affiliated_With as A join department as B on A.Department = B.DepartmentID WHERE B.Name = 'Surgery' or B.Name = 'General Medicine' GROUP BY Physician HAVING COUNT ( DISTINCT ( B.Name ) ) = 2 )"
  },
  {
    "db_id": "hospital_1",
    "question": "在外科和普通内科两个部门同时工作的医生所占外科医生的比例是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Affiliated_With WHERE Department = ( SELECT DepartmentID FROM Department WHERE Name = 'Surgery' ) ) AS prop FROM ( select * from Affiliated_With as A join department as B on A.Department = B.DepartmentID WHERE B.Name = 'Surgery' or B.Name = 'General Medicine' GROUP BY Physician HAVING COUNT ( DISTINCT ( B.Name ) ) = 2 )"
  },
  {
    "db_id": "hospital_1",
    "question": "假如基思·杜德米斯特既属于外科部门又属于普通内科部门，同时属于外科部门和普通内科部门的医生在属于外科的医生中所占的比例是多少？",
    "gold_sql": "SELECT 1.0 * ( 1 + COUNT ( * ) ) / ( 1 + ( SELECT COUNT ( * ) FROM Affiliated_With as A join Physician as B on A.Physician = B.EmployeeID WHERE B.Name != 'Keith Dudermeister' and Department = ( SELECT DepartmentID FROM Department WHERE Name = 'Surgery' ) ) ) AS prop FROM ( select * from Affiliated_With as A join department as B on A.Department = B.DepartmentID join Physician as C on A.Physician = C.EmployeeID WHERE C.Name != 'Keith Dudermeister' and ( B.Name = 'Surgery' or B.Name = 'General Medicine' ) GROUP BY Physician HAVING COUNT ( DISTINCT ( B.Name ) ) = 2 )"
  },
  {
    "db_id": "hospital_1",
    "question": "假如基思·杜德米斯特既在外科部门工作又在普通内科部门工作，那么在外科和普通内科两个部门同时工作的医生所占外科医生的比例是多少？",
    "gold_sql": "SELECT 1.0 * ( 1 + COUNT ( * ) ) / ( 1 + ( SELECT COUNT ( * ) FROM Affiliated_With as A join Physician as B on A.Physician = B.EmployeeID WHERE B.Name != 'Keith Dudermeister' and Department = ( SELECT DepartmentID FROM Department WHERE Name = 'Surgery' ) ) ) AS prop FROM ( select * from Affiliated_With as A join department as B on A.Department = B.DepartmentID join Physician as C on A.Physician = C.EmployeeID WHERE C.Name != 'Keith Dudermeister' and ( B.Name = 'Surgery' or B.Name = 'General Medicine' ) GROUP BY Physician HAVING COUNT ( DISTINCT ( B.Name ) ) = 2 )"
  },
  {
    "db_id": "hospital_1",
    "question": "治疗的最高价格与最低价格相比是多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( Cost ) / MIN ( Cost ) AS times FROM Procedures"
  },
  {
    "db_id": "hospital_1",
    "question": "最贵的治疗的价格是最便宜的治疗的价格的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( Cost ) / MIN ( Cost ) AS times FROM Procedures"
  },
  {
    "db_id": "hospital_1",
    "question": "治疗的最高价格与最低价格相比是多少倍，如果最低价提高了75%？",
    "gold_sql": "SELECT 1.0 * MAX ( Cost ) / ( ( 1 + 0.75 ) * MIN ( Cost ) ) AS times FROM Procedures"
  },
  {
    "db_id": "hospital_1",
    "question": "如果最便宜的治疗价格提高75%，那么最贵的治疗的价格是最便宜的治疗的价格的多少倍？",
    "gold_sql": "SELECT 1.0 * MAX ( Cost ) / ( ( 1 + 0.75 ) * MIN ( Cost ) ) AS times FROM Procedures"
  },
  {
    "db_id": "hospital_1",
    "question": "治疗费用高于1000的案例占治疗案例总数的多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Procedures ) FROM Procedures WHERE Cost > 1000"
  },
  {
    "db_id": "hospital_1",
    "question": "价格在1000以上的治疗案例占治疗案例总数的比例是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Procedures ) FROM Procedures WHERE Cost > 1000"
  },
  {
    "db_id": "hospital_1",
    "question": "不使用Procrastin-X的患者占患者总数的多少？",
    "gold_sql": "SELECT 1.0 - 1.0 * COUNT ( DISTINCT ( Patient ) ) / ( SELECT COUNT ( DISTINCT ( SSN ) ) FROM Patient ) AS prop FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Name = 'Procrastin-X'"
  },
  {
    "db_id": "hospital_1",
    "question": "不服用Procrastin-X的患者的数量所占患者总数量的比例是多少？",
    "gold_sql": "SELECT 1.0 - 1.0 * COUNT ( DISTINCT ( Patient ) ) / ( SELECT COUNT ( DISTINCT ( SSN ) ) FROM Patient ) AS prop FROM Medication A JOIN Prescribes B ON A.code = B.Medication WHERE A.Name = 'Procrastin-X'"
  },
  {
    "db_id": "hospital_1",
    "question": "丹尼斯·多伊最昂贵的治疗和最便宜的治疗之间有多少区别？",
    "gold_sql": "SELECT MAX ( A.Cost ) - MIN ( A.Cost ) AS diff FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON C.SSN = B.Patient WHERE C.Name = 'Dennis Doe'"
  },
  {
    "db_id": "hospital_1",
    "question": "丹尼斯·多伊消费最高的一次治疗和消费最低的一次治疗相差多少钱？",
    "gold_sql": "SELECT MAX ( A.Cost ) - MIN ( A.Cost ) AS diff FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON C.SSN = B.Patient WHERE C.Name = 'Dennis Doe'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果每个治疗都涨价50%，丹尼斯·多伊做的最昂贵的治疗和最便宜的治疗相差多少钱？",
    "gold_sql": "SELECT ( ( 1 + 0.5 ) * MAX ( A.Cost ) ) - ( ( 1 + 0.5 ) * MIN ( A.Cost ) ) AS diff FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON C.SSN = B.Patient WHERE C.Name = 'Dennis Doe'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果每个治疗都涨价50%，那么丹尼斯·多伊消费最高的一次治疗和消费最低的一次治疗相差多少钱？",
    "gold_sql": "SELECT ( ( 1 + 0.5 ) * MAX ( A.Cost ) ) - ( ( 1 + 0.5 ) * MIN ( A.Cost ) ) AS diff FROM Procedures A JOIN Undergoes B ON A.Code = B.Procedures JOIN Patient C ON C.SSN = B.Patient WHERE C.Name = 'Dennis Doe'"
  },
  {
    "db_id": "hospital_1",
    "question": "可用房间占房间总数的多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Room ) AS prop FROM Room WHERE Unavailable = '0'"
  },
  {
    "db_id": "hospital_1",
    "question": "目前有多少比例的房间是空闲的？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Room ) AS prop FROM Room WHERE Unavailable = '0'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果每个房间有两张床，那么可用的房间总共可以容纳多少人？",
    "gold_sql": "SELECT 2 * COUNT ( * ) AS n_people FROM Room WHERE Unavailable = '0'"
  },
  {
    "db_id": "hospital_1",
    "question": "若每个房间有两张床位，列出目前空闲的房间可以容纳的总人数。",
    "gold_sql": "SELECT 2 * COUNT ( * ) AS n_people FROM Room WHERE Unavailable = '0'"
  },
  {
    "db_id": "hospital_1",
    "question": "预约ID为13216584的预约持续时间是多少分钟？",
    "gold_sql": "SELECT ( strftime ( '%s' , End ) - strftime ( '%s' , Start ) ) / 60.0 AS time FROM Appointment WHERE AppointmentID = '13216584'"
  },
  {
    "db_id": "hospital_1",
    "question": "列出预约ID为13216584的预约总共持续的分钟数。",
    "gold_sql": "SELECT ( strftime ( '%s' , End ) - strftime ( '%s' , Start ) ) / 60.0 AS time FROM Appointment WHERE AppointmentID = '13216584'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果预约ID为13216584的预约持续时间延长了半个小时，它的持续了多少分钟？",
    "gold_sql": "SELECT ( strftime ( '%s' , End ) - strftime ( '%s' , Start ) ) / 60.0 + 30 AS time FROM Appointment WHERE AppointmentID = '13216584'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果预约ID为13216584的预约持续时间比当前长半个小时，列出预约ID为13216584的预约总共持续的分钟数。",
    "gold_sql": "SELECT ( strftime ( '%s' , End ) - strftime ( '%s' , Start ) ) / 60.0 + 30 AS time FROM Appointment WHERE AppointmentID = '13216584'"
  },
  {
    "db_id": "hospital_1",
    "question": "如果每次培训的培训费是50英镑，那么谁是在培训上花费最多的医生？列出他的姓名、职位和培训费用。",
    "gold_sql": "SELECT A.Name , A.Position , 50 * COUNT ( * ) AS cost FROM Physician A JOIN Trained_In B ON A.EmployeeID = B.Physician GROUP BY A.EmployeeID HAVING COUNT ( * ) = ( SELECT MAX ( training_count ) FROM ( SELECT COUNT ( * ) AS training_count FROM Trained_In GROUP BY Physician ) )"
  },
  {
    "db_id": "hospital_1",
    "question": "若每次培训都需要收费50英镑，那么哪位医生在培训上花费最多？列出他的姓名、职位和培训所花的费用。",
    "gold_sql": "SELECT A.Name , A.Position , 50 * COUNT ( * ) AS cost FROM Physician A JOIN Trained_In B ON A.EmployeeID = B.Physician GROUP BY A.EmployeeID HAVING COUNT ( * ) = ( SELECT MAX ( training_count ) FROM ( SELECT COUNT ( * ) AS training_count FROM Trained_In GROUP BY Physician ) )"
  },
  {
    "db_id": "hospital_1",
    "question": "顶层的可用房间比最底层的多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MIN ( BlockFloor ) FROM Room ) ) AS diff FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MAX ( BlockFloor ) FROM Room )"
  },
  {
    "db_id": "hospital_1",
    "question": "最高楼层上的空闲房间数量比最低楼层的空闲房间数量多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MIN ( BlockFloor ) FROM Room ) ) AS diff FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MAX ( BlockFloor ) FROM Room )"
  },
  {
    "db_id": "hospital_1",
    "question": "假设在顶层有20个可用房间，顶层的可用房间比最底层的多多少？",
    "gold_sql": "SELECT 20 - ( SELECT COUNT ( * ) FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MIN ( BlockFloor ) FROM Room ) ) AS diff"
  },
  {
    "db_id": "hospital_1",
    "question": "如果在最高层上有20个空闲房间，那么最高楼层上的空闲房间数量比最低楼层的空闲房间数量多多少？",
    "gold_sql": "SELECT 20 - ( SELECT COUNT ( * ) FROM Room WHERE Unavailable = '0' AND BlockFloor = ( SELECT MIN ( BlockFloor ) FROM Room ) ) AS diff"
  },
  {
    "db_id": "riding_club",
    "question": "有教练的选手占选手总数的百分之多少？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Player_ID ) ) / ( SELECT COUNT ( DISTINCT ( Player_ID ) ) FROM player ) AS ratio FROM player_coach"
  },
  {
    "db_id": "riding_club",
    "question": "有教练指导的选手的数量占所有选手总数量的百分比是多少？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Player_ID ) ) / ( SELECT COUNT ( DISTINCT ( Player_ID ) ) FROM player ) AS ratio FROM player_coach"
  },
  {
    "db_id": "riding_club",
    "question": "如果吉姆·马洛维的教练是乔·法布里，有教练的选手占选手总数的百分之多少？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( DISTINCT ( A.Player_ID ) ) + 1 ) / ( SELECT COUNT ( DISTINCT ( Player_ID ) ) FROM player ) AS ratio FROM player_coach A JOIN player B ON A.Player_ID = B.Player_ID WHERE B.Player_name != 'Jim Maloway'"
  },
  {
    "db_id": "riding_club",
    "question": "如果乔·法布里是吉姆·马洛维的教练，那么有教练指导的选手的数量占所有选手总数量的百分比是多少？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( DISTINCT ( A.Player_ID ) ) + 1 ) / ( SELECT COUNT ( DISTINCT ( Player_ID ) ) FROM player ) AS ratio FROM player_coach A JOIN player B ON A.Player_ID = B.Player_ID WHERE B.Player_name != 'Jim Maloway'"
  },
  {
    "db_id": "riding_club",
    "question": "建于比特币网络第一次发布那年之前的俱乐部占俱乐部总数的百分之多少？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM club ) AS ratio FROM club WHERE Start_year < '2009'"
  },
  {
    "db_id": "riding_club",
    "question": "有百分之几的俱乐部建立于比特币网络首次发布哪一年之前？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM club ) AS ratio FROM club WHERE Start_year < '2009'"
  },
  {
    "db_id": "riding_club",
    "question": "如果Helsingborgs IF俱乐部建立于2000年，建于比特币网络第一次发布那年之前的俱乐部占俱乐部总数的百分之多少？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( * ) + 1 ) / ( SELECT COUNT ( * ) FROM club ) AS ratio FROM club WHERE Start_year < '2009' AND Club_name != 'Helsingborgs IF'"
  },
  {
    "db_id": "riding_club",
    "question": "若Helsingborgs IF俱乐部在2000年成立，那么有百分之几的俱乐部建立于比特币网络首次发布哪一年之前？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( * ) + 1 ) / ( SELECT COUNT ( * ) FROM club ) AS ratio FROM club WHERE Start_year < '2009' AND Club_name != 'Helsingborgs IF'"
  },
  {
    "db_id": "riding_club",
    "question": "拥有世界最长铁路的国家的所有俱乐部获得的奖牌一共有多少？",
    "gold_sql": "SELECT SUM ( Gold + Big_Silver + Small_Silver + Bronze ) AS total_medals FROM club A JOIN match_result B ON A.Club_ID = B.Club_ID WHERE A.Region = 'Russia'"
  },
  {
    "db_id": "riding_club",
    "question": "给出位于世界上最长的铁路所在的国家的所有俱乐部的获得的所有奖牌总数。",
    "gold_sql": "SELECT SUM ( Gold + Big_Silver + Small_Silver + Bronze ) AS total_medals FROM club A JOIN match_result B ON A.Club_ID = B.Club_ID WHERE A.Region = 'Russia'"
  },
  {
    "db_id": "riding_club",
    "question": "拥有世界最长铁路的国家的所有俱乐部获得的奖牌一共有多少，如果每个俱乐部的金牌翻倍了？",
    "gold_sql": "SELECT SUM ( 2 * Gold + Big_Silver + Small_Silver + Bronze ) AS total_medals FROM club A JOIN match_result B ON A.Club_ID = B.Club_ID WHERE A.Region = 'Russia'"
  },
  {
    "db_id": "riding_club",
    "question": "假设每个俱乐部的金牌数量都是现在的两倍，给出位于世界上最长的铁路所在的国家的所有俱乐部的获得的所有奖牌总数。",
    "gold_sql": "SELECT SUM ( 2 * Gold + Big_Silver + Small_Silver + Bronze ) AS total_medals FROM club A JOIN match_result B ON A.Club_ID = B.Club_ID WHERE A.Region = 'Russia'"
  },
  {
    "db_id": "riding_club",
    "question": "排名第一的俱乐部拥有的奖牌总数是第三名的多少倍？",
    "gold_sql": "SELECT 1.0 * n_1 / n_3 AS times FROM ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_1 FROM match_result WHERE rank = '1' ) JOIN ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_3 FROM match_result WHERE rank = '3' )"
  },
  {
    "db_id": "riding_club",
    "question": "排名最高的俱乐部所获得的所有奖牌总数是位于排行榜第三位的俱乐部的多少倍？",
    "gold_sql": "SELECT 1.0 * n_1 / n_3 AS times FROM ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_1 FROM match_result WHERE rank = '1' ) JOIN ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_3 FROM match_result WHERE rank = '3' )"
  },
  {
    "db_id": "riding_club",
    "question": "排名第一的俱乐部拥有的奖牌总数是第三名的多少倍，如果排名第一的俱乐部的铜牌翻了三倍？",
    "gold_sql": "SELECT 1.0 * n_1 / n_3 AS times FROM ( SELECT Gold + Big_Silver + Small_Silver + 3 * Bronze AS n_1 FROM match_result WHERE rank = '1' ) JOIN ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_3 FROM match_result WHERE rank = '3' )"
  },
  {
    "db_id": "riding_club",
    "question": "倘若位于排行榜第一位的俱乐部获得的铜牌数量是当前的三倍，那么排名最高俱乐部所获得的所有奖牌总数是位于排行榜第三位的俱乐部的多少倍？",
    "gold_sql": "SELECT 1.0 * n_1 / n_3 AS times FROM ( SELECT Gold + Big_Silver + Small_Silver + 3 * Bronze AS n_1 FROM match_result WHERE rank = '1' ) JOIN ( SELECT Gold + Big_Silver + Small_Silver + Bronze AS n_3 FROM match_result WHERE rank = '3' )"
  },
  {
    "db_id": "riding_club",
    "question": "如果一枚金牌可以获得5个积分，一枚大银牌获得3分，一枚小银牌获得2分，一枚铜牌获得1分。获得最多积分的俱乐部位于哪里，成立于哪年，有几个男教练，女教练？",
    "gold_sql": "SELECT * FROM ( SELECT A.Region , A.Start_year , COUNT ( * ) AS n_M FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze ) AS new_points , Club_ID FROM match_result ) ) AND B.Gender = 'M' ) JOIN ( SELECT COUNT ( * ) AS n_F FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze ) AS new_points , Club_ID FROM match_result ) ) AND B.Gender = 'F' )"
  },
  {
    "db_id": "riding_club",
    "question": "如果一枚金牌，一枚大银牌，一枚小银牌，和一枚铜牌分别对应5个积分，3个积分，2个积分和1个积分。那么积分数量最多的俱乐部位于哪里，成立于哪年，男女教练分别有多少位？",
    "gold_sql": "SELECT * FROM ( SELECT A.Region , A.Start_year , COUNT ( * ) AS n_M FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze ) AS new_points , Club_ID FROM match_result ) ) AND B.Gender = 'M' ) JOIN ( SELECT COUNT ( * ) AS n_F FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze ) AS new_points , Club_ID FROM match_result ) ) AND B.Gender = 'F' )"
  },
  {
    "db_id": "riding_club",
    "question": "一枚金牌可以获得5个积分，一枚大银牌获得3分，一枚小银牌获得2分，一枚铜牌获得1分。如果金牌数最少的俱乐部的铜牌数量和金牌数量最多的俱乐部的铜牌数量一样多，获得最多积分的俱乐部位于哪里，成立于哪年，有几个男教练，女教练？",
    "gold_sql": "SELECT * FROM ( SELECT A.Region , A.Start_year , COUNT ( * ) AS n_M FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( new_points ) , Club_ID FROM ( SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze AS new_points , Club_ID FROM match_result WHERE Club_ID != ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) UNION SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * ( SELECT Bronze FROM ( SELECT MAX ( Gold ) , Bronze FROM match_result ) ) AS new_points , Club_ID FROM match_result WHERE Club_ID = ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) ) ) ) AND B.Gender = 'M' ) JOIN ( SELECT COUNT ( * ) AS n_F FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( new_points ) , Club_ID FROM ( SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze AS new_points , Club_ID FROM match_result WHERE Club_ID != ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) UNION SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * ( SELECT Bronze FROM ( SELECT MAX ( Gold ) , Bronze FROM match_result ) ) AS new_points , Club_ID FROM match_result WHERE Club_ID = ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) ) ) ) AND B.Gender = 'F' )"
  },
  {
    "db_id": "riding_club",
    "question": "假设获得金牌数量最少的俱乐部的铜牌数量和金牌数量最多的俱乐部的铜牌数量一样多，且一枚金牌、一枚大银牌、一枚小银牌、和一枚铜牌分别对应5个积分、3个积分、2个积分和1个积分。那么积分数量最多的俱乐部位于哪里，成立于哪年，男女教练分别有多少位？",
    "gold_sql": "SELECT * FROM ( SELECT A.Region , A.Start_year , COUNT ( * ) AS n_M FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( new_points ) , Club_ID FROM ( SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze AS new_points , Club_ID FROM match_result WHERE Club_ID != ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) UNION SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * ( SELECT Bronze FROM ( SELECT MAX ( Gold ) , Bronze FROM match_result ) ) AS new_points , Club_ID FROM match_result WHERE Club_ID = ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) ) ) ) AND B.Gender = 'M' ) JOIN ( SELECT COUNT ( * ) AS n_F FROM club A JOIN coach B ON A.Club_ID = B.Club_ID WHERE A.Club_ID = ( SELECT Club_ID FROM ( SELECT MAX ( new_points ) , Club_ID FROM ( SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * Bronze AS new_points , Club_ID FROM match_result WHERE Club_ID != ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) UNION SELECT 5 * Gold + 3 * Big_Silver + 2 * Small_Silver + 1 * ( SELECT Bronze FROM ( SELECT MAX ( Gold ) , Bronze FROM match_result ) ) AS new_points , Club_ID FROM match_result WHERE Club_ID = ( SELECT Club_ID FROM ( SELECT MIN ( Gold ) , Club_ID FROM match_result ) ) ) ) ) AND B.Gender = 'F' )"
  },
  {
    "db_id": "riding_club",
    "question": "获得过冠军的选手中，小商人的占比是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM ( SELECT * FROM player WHERE Rank = '1st' GROUP BY Player_ID ) ) AS propotion FROM ( SELECT * FROM player WHERE Rank = '1st' AND Occupation = 'Small Businessman' GROUP BY Player_ID )"
  },
  {
    "db_id": "riding_club",
    "question": "给出小商人在所有夺冠选手中所占的比例。",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM ( SELECT * FROM player WHERE Rank = '1st' GROUP BY Player_ID ) ) AS propotion FROM ( SELECT * FROM player WHERE Rank = '1st' AND Occupation = 'Small Businessman' GROUP BY Player_ID )"
  },
  {
    "db_id": "riding_club",
    "question": "假如罗斯伊迪获得的其实是第一名，获得过冠军的选手中，小商人的占比是多少？",
    "gold_sql": "SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM player WHERE Player_name = 'Ross Eadie' AND Occupation = 'Small Businessman' ) ) / ( ( SELECT COUNT ( * ) FROM ( SELECT * FROM player WHERE Rank = '1st' and Player_name != 'Ross Eadie' GROUP BY Player_ID ) ) + ( SELECT COUNT ( * ) FROM player WHERE Player_name = 'Ross Eadie' ) ) AS propotion FROM ( SELECT * FROM player WHERE Rank = '1st' AND Occupation = 'Small Businessman' AND Player_name != 'Ross Eadie' GROUP BY Player_ID )"
  },
  {
    "db_id": "riding_club",
    "question": "如果罗斯伊迪在其参加的比赛中获得的其实是冠军，给出小商人在所有夺冠选手中所占的比例。",
    "gold_sql": "SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM player WHERE Player_name = 'Ross Eadie' AND Occupation = 'Small Businessman' ) ) / ( ( SELECT COUNT ( * ) FROM ( SELECT * FROM player WHERE Rank = '1st' and Player_name != 'Ross Eadie' GROUP BY Player_ID ) ) + ( SELECT COUNT ( * ) FROM player WHERE Player_name = 'Ross Eadie' ) ) AS propotion FROM ( SELECT * FROM player WHERE Rank = '1st' AND Occupation = 'Small Businessman' AND Player_name != 'Ross Eadie' GROUP BY Player_ID )"
  },
  {
    "db_id": "riding_club",
    "question": "詹姆森托马斯指导的选手取得冠军的概率有多大？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st'"
  },
  {
    "db_id": "riding_club",
    "question": "教练为詹姆森托马斯的选手获得第一名的概率是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st'"
  },
  {
    "db_id": "riding_club",
    "question": "假如菲奥娜希尔斯获得的其实是第一名，詹姆森托马斯指导的选手取得冠军的概率有多大？",
    "gold_sql": "SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Player_name = 'Fiona Shiells' ) ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st' AND A.Player_name != 'Fiona Shiells'"
  },
  {
    "db_id": "riding_club",
    "question": "如果菲奥娜希尔斯在其所参加的那场比赛中夺冠了，教练为詹姆森托马斯的选手获得第一名的概率是多少？",
    "gold_sql": "SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Player_name = 'Fiona Shiells' ) ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' ) AS prob FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE C.Coach_name = 'Jameson Tomas' AND A.Rank = '1st' AND A.Player_name != 'Fiona Shiells'"
  },
  {
    "db_id": "riding_club",
    "question": "哪个教练培养的冠军最多，他的名字是什么，比培养的冠军最少的教练培养的冠军数量多多少？",
    "gold_sql": "SELECT Coach_name , n_1st - ( SELECT MIN ( n_1st ) FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) ) AS diff FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) WHERE n_1st = ( SELECT MAX ( n_1st ) FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) )"
  },
  {
    "db_id": "riding_club",
    "question": "培养出最多冠军的教练的名字是什么，其培养的冠军数量比培养的冠军最少的教练培养的冠军数量多多少？",
    "gold_sql": "SELECT Coach_name , n_1st - ( SELECT MIN ( n_1st ) FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) ) AS diff FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) WHERE n_1st = ( SELECT MAX ( n_1st ) FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) )"
  },
  {
    "db_id": "riding_club",
    "question": "教练每培养一个冠军可以获得100美元奖金，每培养一个亚军可以获得60美元奖金，每培养一个季军可以获得20美元奖金。哪个教练获得的奖金最多，他的名字是什么，他的奖金是多少？",
    "gold_sql": "SELECT t1.Coach_name , MAX ( 100 * n_1st + 60 * n_2nd + 20 * n_3rd ) AS money FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) t1 JOIN ( SELECT Coach_name , COUNT ( * ) AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID ) ) t2 ON t1.Coach_name = t2.Coach_name JOIN ( SELECT Coach_name , COUNT ( * ) AS n_3rd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID ) ) t3 ON t2.Coach_name = t3.Coach_name"
  },
  {
    "db_id": "riding_club",
    "question": "教练每培养一个冠军、亚军、季军可以分别获得100美元、60美元和20美元的奖金，那么获得奖金数量最多的教练的名字是什么，其获得了多少奖金？",
    "gold_sql": "SELECT t1.Coach_name , MAX ( 100 * n_1st + 60 * n_2nd + 20 * n_3rd ) AS money FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) t1 JOIN ( SELECT Coach_name , COUNT ( * ) AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID ) ) t2 ON t1.Coach_name = t2.Coach_name JOIN ( SELECT Coach_name , COUNT ( * ) AS n_3rd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID ) ) t3 ON t2.Coach_name = t3.Coach_name"
  },
  {
    "db_id": "riding_club",
    "question": "教练每培养一个冠军可以获得100美元奖金，每培养一个亚军可以获得60美元奖金，每培养一个季军可以获得20美元奖金。如果雷切尔·海因里希获得的其实是第二名，哪个教练获得的奖金最多，其姓名和奖金分别是多少？",
    "gold_sql": "SELECT t1.Coach_name , MAX ( 100 * n_1st + 60 * n_2nd + 20 * n_3rd ) AS money FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) t1 JOIN ( SELECT Coach_name , COUNT ( * ) AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' AND C.Coach_ID != ( SELECT C.Coach_ID FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID ) AND Coach_ID != ( SELECT C.Coach_ID FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) UNION SELECT ( SELECT C.Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) AS Coach_name , COUNT ( * ) + 1 AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' AND A.Player_name = 'Rachel Heinrichs' ) t2 ON t1.Coach_name = t2.Coach_name JOIN ( SELECT Coach_name , COUNT ( * ) AS n_3rd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID ) ) t3 ON t2.Coach_name = t3.Coach_name"
  },
  {
    "db_id": "riding_club",
    "question": "教练每培养一个冠军、亚军、季军可以分别获得100美元、60美元和20美元的奖金，加入如果雷切尔·海因里希获得的其实是第二名，那么获得奖金数量最多的教练的名字是什么，其获得了多少奖金？",
    "gold_sql": "SELECT t1.Coach_name , MAX ( 100 * n_1st + 60 * n_2nd + 20 * n_3rd ) AS money FROM ( SELECT Coach_name , COUNT ( * ) AS n_1st FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '1st' GROUP BY C.Coach_ID ) ) t1 JOIN ( SELECT Coach_name , COUNT ( * ) AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' AND C.Coach_ID != ( SELECT C.Coach_ID FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' GROUP BY C.Coach_ID ) AND Coach_ID != ( SELECT C.Coach_ID FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) UNION SELECT ( SELECT C.Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Player_name = 'Rachel Heinrichs' ) AS Coach_name , COUNT ( * ) + 1 AS n_2nd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '2nd' AND A.Player_name = 'Rachel Heinrichs' ) t2 ON t1.Coach_name = t2.Coach_name JOIN ( SELECT Coach_name , COUNT ( * ) AS n_3rd FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID UNION SELECT Coach_name , 0 FROM coach WHERE Coach_name NOT IN ( SELECT Coach_name FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON C.Coach_ID = B.Coach_ID WHERE A.Rank = '3rd' GROUP BY C.Coach_ID ) ) t3 ON t2.Coach_name = t3.Coach_name"
  },
  {
    "db_id": "riding_club",
    "question": "有百分之多少的俱乐部成立于21世纪之前？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM club ) AS percent FROM club WHERE Start_year < 2001"
  },
  {
    "db_id": "riding_club",
    "question": "成立时间在21世纪以前的俱乐部数量占比是百分之几？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM club ) AS percent FROM club WHERE Start_year < 2001"
  },
  {
    "db_id": "riding_club",
    "question": "如果美国所有的俱乐部是在2000年成立的，有百分之多少的俱乐部成立于21世纪之前？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM club WHERE Region = 'USA' ) ) / ( SELECT COUNT ( * ) FROM club ) AS percent FROM club WHERE Start_year < 2001 AND Region != 'USA'"
  },
  {
    "db_id": "riding_club",
    "question": "假如位于美国的所有俱乐部成立时间都是2000年，那么成立时间在21世纪以前的俱乐部数量占比是百分之几？",
    "gold_sql": "SELECT 100.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) FROM club WHERE Region = 'USA' ) ) / ( SELECT COUNT ( * ) FROM club ) AS percent FROM club WHERE Start_year < 2001 AND Region != 'USA'"
  },
  {
    "db_id": "riding_club",
    "question": "哪位居住在加拿大马尼托巴省首府的球员获得的选票是罗斯马丁的两倍多？给出他们的名字。",
    "gold_sql": "SELECT Player_name FROM player WHERE Residence = 'Winnipeg' AND Votes > 2 * ( SELECT Votes FROM player WHERE Player_name = 'Ross C. Martin' )"
  },
  {
    "db_id": "riding_club",
    "question": "获得选票比罗斯马丁的两倍还多的球员中，哪些居住在加拿大马尼托巴省首府？给出他们的名字。",
    "gold_sql": "SELECT Player_name FROM player WHERE Residence = 'Winnipeg' AND Votes > 2 * ( SELECT Votes FROM player WHERE Player_name = 'Ross C. Martin' )"
  },
  {
    "db_id": "riding_club",
    "question": "如果罗斯马丁获得了2000张选票，哪位居住在加拿大马尼托巴省首府的球员获得的选票是罗斯马丁的两倍多？给出他们的名字。",
    "gold_sql": "SELECT Player_name FROM player WHERE Residence = 'Winnipeg' AND Votes > 2 * 2000 AND Player_name != 'Ross C. Martin'"
  },
  {
    "db_id": "riding_club",
    "question": "如果罗斯马丁获得了2000张选票，那么获得选票比罗斯马丁的两倍还多的球员中，哪些居住在加拿大马尼托巴省首府？给出他们的名字。",
    "gold_sql": "SELECT Player_name FROM player WHERE Residence = 'Winnipeg' AND Votes > 2 * 2000 AND Player_name != 'Ross C. Martin'"
  },
  {
    "db_id": "riding_club",
    "question": "哪些球员由21世纪之前成立的俱乐部的教练指导，他们的名字是什么？他们的选票比最低选票的高多少？",
    "gold_sql": "SELECT A.Player_name , A.Votes - ( SELECT MIN ( Votes ) FROM player ) AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID JOIN club D ON C.Club_ID = D.Club_ID WHERE D.Start_year < 2006"
  },
  {
    "db_id": "riding_club",
    "question": "哪些球员由成立于21世界之前的俱乐部的教练指导，他们的名字是什么？他们的选票超出最低选票多少？",
    "gold_sql": "SELECT A.Player_name , A.Votes - ( SELECT MIN ( Votes ) FROM player ) AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID JOIN club D ON C.Club_ID = D.Club_ID WHERE D.Start_year < 2006"
  },
  {
    "db_id": "riding_club",
    "question": "如果最低投票数量是1000，哪些球员由21世纪之前成立的俱乐部的教练指导，他们的姓名是什么？他们的选票比最低的高多少？",
    "gold_sql": "SELECT A.Player_name , A.Votes - 1000 AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID JOIN club D ON C.Club_ID = D.Club_ID WHERE D.Start_year < 2006"
  },
  {
    "db_id": "riding_club",
    "question": "假设最低投票数量是1000，那么哪些球员由成立于21世界之前的俱乐部的教练指导，他们叫什么名字？他们的选票超出最低选票多少？",
    "gold_sql": "SELECT A.Player_name , A.Votes - 1000 AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID JOIN club D ON C.Club_ID = D.Club_ID WHERE D.Start_year < 2006"
  },
  {
    "db_id": "riding_club",
    "question": "没有教练的选手获得冠军的概率是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) AS ratio FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND Rank = '1st'"
  },
  {
    "db_id": "riding_club",
    "question": "没有教练指导的参赛选手夺冠的概率是多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) AS ratio FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND Rank = '1st'"
  },
  {
    "db_id": "riding_club",
    "question": "有教练的选手获得前两名的概率比没有教练的选手获得前两名的概率大多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) - ( SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND ( Rank = '1st' OR Rank = '2nd' ) ) AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' )"
  },
  {
    "db_id": "riding_club",
    "question": "有教练指导的参赛选手获得冠亚军的概率比没有教练指导的选手获得冠亚军的概率高多少？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) - ( SELECT 1.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) ) FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND ( Rank = '1st' OR Rank = '2nd' ) ) AS diff FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' )"
  },
  {
    "db_id": "riding_club",
    "question": "假如尼基·阿什顿并没有教练，有教练的选手获得前两名的概率比没有教练的选手获得前两名的概率大多少？",
    "gold_sql": "SELECT prob_1 - prob_2 AS diff FROM ( SELECT 1.0 * ( COUNT ( * ) - ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' ) AND A.Player_name = 'Niki Ashton' ) ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE A.Player_name != 'Niki Ashton' ) AS prob_1 FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' ) ) JOIN ( SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) From player WHERE ( Rank = '1st' OR Rank = '2nd' ) AND Player_name = 'Niki Ashton' ) ) / ( SELECT COUNT ( * ) + 1 FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND Player_name != 'Niki Ashton' ) AS prob_2 FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND ( Rank = '1st' OR Rank = '2nd' ) AND Player_name != 'Niki Ashton' )"
  },
  {
    "db_id": "riding_club",
    "question": "如果尼基·阿什顿没有教练指导，那么有教练指导的参赛选手获得冠亚军的概率比没有教练指导的选手获得冠亚军的概率高多少？",
    "gold_sql": "SELECT prob_1 - prob_2 AS diff FROM ( SELECT 1.0 * ( COUNT ( * ) - ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' ) AND A.Player_name = 'Niki Ashton' ) ) / ( SELECT COUNT ( * ) FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE A.Player_name != 'Niki Ashton' ) AS prob_1 FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID WHERE ( A.Rank = '1st' OR A.Rank = '2nd' ) ) JOIN ( SELECT 1.0 * ( COUNT ( * ) + ( SELECT COUNT ( * ) From player WHERE ( Rank = '1st' OR Rank = '2nd' ) AND Player_name = 'Niki Ashton' ) ) / ( SELECT COUNT ( * ) + 1 FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND Player_name != 'Niki Ashton' ) AS prob_2 FROM player WHERE Player_ID NOT IN ( SELECT A.Player_ID AS player_with_coach FROM player A JOIN player_coach B ON A.Player_ID = B.Player_ID JOIN coach C ON B.Coach_ID = C.Coach_ID ) AND ( Rank = '1st' OR Rank = '2nd' ) AND Player_name != 'Niki Ashton' )"
  },
  {
    "db_id": "soccer_1",
    "question": "传球得分包括5%的弧线球、5%的任意球精度、15%的长传、20%的传中、20%的视野和35%的短传。列出传球得分最高的前10名球员的姓名和当前年龄。",
    "gold_sql": "SELECT name , age FROM ( SELECT B.player_name AS name , MAX ( 0.05 * A.curve + 0.05 * A.free_kick_accuracy + 0.15 * A.long_passing + 0.2 * A.crossing + 0.2 * A.vision + 0.35 * A.short_passing ) AS passing_rating , DATE ( 'now' ) - strftime ( '%Y-%m-%d' , B.birthday ) AS age FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY passing_rating DESC LIMIT 10 )"
  },
  {
    "db_id": "soccer_1",
    "question": "传球能力值由5%的弧线球、5%的任意球精度、15%的长传、20%的传中、20%的视野和35%的短传组成。给出传球能力值排名前10的球员姓名和当前的年龄。",
    "gold_sql": "SELECT name , age FROM ( SELECT B.player_name AS name , MAX ( 0.05 * A.curve + 0.05 * A.free_kick_accuracy + 0.15 * A.long_passing + 0.2 * A.crossing + 0.2 * A.vision + 0.35 * A.short_passing ) AS passing_rating , DATE ( 'now' ) - strftime ( '%Y-%m-%d' , B.birthday ) AS age FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY passing_rating DESC LIMIT 10 )"
  },
  {
    "db_id": "soccer_1",
    "question": "传球得分包括5%的弧线球、5%的任意球精度、15%的长传、20%的传中、20%的视野和35%的短传。假如所有球员的视野都是80分，列出传球得分最高的前10名球员的姓名和当前年龄。",
    "gold_sql": "SELECT name , age FROM ( SELECT B.player_name AS name , MAX ( 0.05 * A.curve + 0.05 * A.free_kick_accuracy + 0.15 * A.long_passing + 0.2 * A.crossing + 0.2 * 80 + 0.35 * A.short_passing ) AS passing_rating , DATE ( 'now' ) - strftime ( '%Y-%m-%d' , B.birthday ) AS age FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY passing_rating DESC LIMIT 10 )"
  },
  {
    "db_id": "soccer_1",
    "question": "传球能力值由5%的弧线球、5%的任意球精度、15%的长传、20%的传中、20%的视野和35%的短传组成。假设所有球员的视野得分都是80分，给出传球能力值排名前10的球员姓名和当前的年龄。",
    "gold_sql": "SELECT name , age FROM ( SELECT B.player_name AS name , MAX ( 0.05 * A.curve + 0.05 * A.free_kick_accuracy + 0.15 * A.long_passing + 0.2 * A.crossing + 0.2 * 80 + 0.35 * A.short_passing ) AS passing_rating , DATE ( 'now' ) - strftime ( '%Y-%m-%d' , B.birthday ) AS age FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY passing_rating DESC LIMIT 10 )"
  },
  {
    "db_id": "soccer_1",
    "question": "速度评分包括45%的加速评分和55%的冲刺速度评分。列出速度排名前三的选手的名字，并列出他们的身高、体重和体重指数。",
    "gold_sql": "SELECT player_name , height , weight , BMI FROM ( SELECT B.player_name , MAX ( 0.45 * A.acceleration + 0.55 * A.sprint_speed ) AS pace_rating , B.height , B.weight , B.weight * 0.45 / ( ( 1.0 * B.height / 100 ) * ( 1.0 * B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY pace_rating DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "速度能力值由加速评分的45%和冲刺速度评分的55%组成。速度排名前三的选手的名字是什么，并列出他们的身高、体重和体重指数。",
    "gold_sql": "SELECT player_name , height , weight , BMI FROM ( SELECT B.player_name , MAX ( 0.45 * A.acceleration + 0.55 * A.sprint_speed ) AS pace_rating , B.height , B.weight , B.weight * 0.45 / ( ( 1.0 * B.height / 100 ) * ( 1.0 * B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY pace_rating DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "速度评分包括45%的加速评分和55%的冲刺速度评分。假如所有球员的加速评分都是75分，列出速度排名前三的球员的名字，并列出他们的身高、体重和体重指数。",
    "gold_sql": "SELECT player_name , height , weight , BMI FROM ( SELECT B.player_name , MAX ( 0.45 * 75 + 0.55 * A.sprint_speed ) AS pace_rating , B.height , B.weight , B.weight * 0.45 / ( ( 1.0 * B.height / 100 ) * ( 1.0 * B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY pace_rating DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "速度能力值由加速评分的45%和冲刺速度评分的55%组成。如果每个球员的加速评分都是75分，那么速度排名前三的选手的名字是什么，并列出他们的身高、体重和体重指数。",
    "gold_sql": "SELECT player_name , height , weight , BMI FROM ( SELECT B.player_name , MAX ( 0.45 * 75 + 0.55 * A.sprint_speed ) AS pace_rating , B.height , B.weight , B.weight * 0.45 / ( ( 1.0 * B.height / 100 ) * ( 1.0 * B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY pace_rating DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "列出整体评分和潜在能力差异最大的前三名球员的名字，并列出差异。",
    "gold_sql": "SELECT B.player_name , MAX ( ABS ( A.potential - A.overall_rating ) ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY difference DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "整体评分和潜在能力相差最大的前三名球员的名字是什么，它们整体评分和潜在能力的差异分别是多少。",
    "gold_sql": "SELECT B.player_name , MAX ( ABS ( A.potential - A.overall_rating ) ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ORDER BY difference DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "假如总评分低于70的球员的总评分增加了5分，列出总评分和潜在能力差异最大的前三名球员的名字。",
    "gold_sql": "SELECT player_name , MAX ( difference ) FROM ( SELECT B.player_name , ABS ( A.overall_rating - A.potential ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.overall_rating >= 70 UNION SELECT B.player_name , ABS ( A.overall_rating + 5 - A.potential ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.overall_rating < 70 ) GROUP BY player_name ORDER BY difference DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "假设所有总评分不到70分的球员的总评分都增加5分，那么总评分和潜在能力值差异最大的前三名球员的名字是什么？",
    "gold_sql": "SELECT player_name , MAX ( difference ) FROM ( SELECT B.player_name , ABS ( A.overall_rating - A.potential ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.overall_rating >= 70 UNION SELECT B.player_name , ABS ( A.overall_rating + 5 - A.potential ) AS difference FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.overall_rating < 70 ) GROUP BY player_name ORDER BY difference DESC LIMIT 3"
  },
  {
    "db_id": "soccer_1",
    "question": "评分80到89分表示非常好。在过人不失球能力非常好的球员中，左脚球员有多少，右脚球员有多少，相差多少？",
    "gold_sql": "SELECT left_footed , right_footed , ABS ( left_footed - right_footed ) AS difference FROM ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS left_footed FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.dribbling BETWEEN 80 AND 89 AND A.preferred_foot = 'left' ) JOIN ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS right_footed FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.dribbling BETWEEN 80 AND 89 AND A.preferred_foot = 'right' )"
  },
  {
    "db_id": "soccer_1",
    "question": "如果一项能力的得分在80分和89分之间，我们称这位球员的这项能力非常好。那么在过人不失球能力非常好的球员中，左脚球员和右脚球员的数量是多少，差别是多少？",
    "gold_sql": "SELECT left_footed , right_footed , ABS ( left_footed - right_footed ) AS difference FROM ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS left_footed FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.dribbling BETWEEN 80 AND 89 AND A.preferred_foot = 'left' ) JOIN ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS right_footed FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.dribbling BETWEEN 80 AND 89 AND A.preferred_foot = 'right' )"
  },
  {
    "db_id": "soccer_1",
    "question": "就干净接球和扑救时正确站位的能力而言，哪名守门员的总得分最高？给出他的名字。",
    "gold_sql": "SELECT player_name FROM ( SELECT B.player_name , MAX ( A.positioning + A.gk_handling ) AS goalkeeper_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY goalkeeper_rating DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "哪名守门员在干净接球和扑救时正确站位的能力上总得分最高？给出他的名字。",
    "gold_sql": "SELECT player_name FROM ( SELECT B.player_name , MAX ( A.positioning + A.gk_handling ) AS goalkeeper_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id GROUP BY B.player_name ) ORDER BY goalkeeper_rating DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "在比赛中累得最快的球员的名字是什么，他在远射准确度和射门力量方面的总得分是多少？",
    "gold_sql": "SELECT B.player_name , A.long_shots + A.shot_power AS total_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE NOT ( A.stamina IS NULL ) ORDER BY A.stamina ASC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "给出在比赛中累得最快的球员的姓名，以及他在远射准确度和射门力量方面的总得分。",
    "gold_sql": "SELECT B.player_name , A.long_shots + A.shot_power AS total_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE NOT ( A.stamina IS NULL ) ORDER BY A.stamina ASC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "在比赛中累得最快的球员的名字是什么，如果他的远射准确度评分是90，他在远射准确度和射门力量方面的总得分是多少？",
    "gold_sql": "SELECT B.player_name , 90 + A.shot_power AS total_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE NOT ( A.stamina IS NULL ) ORDER BY A.stamina ASC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "给出在比赛中累得最快的球员的姓名，假设他的远射准确度评分为90分，那他在远射准确度和射门力量方面的总得分是多少。",
    "gold_sql": "SELECT B.player_name , 90 + A.shot_power AS total_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE NOT ( A.stamina IS NULL ) ORDER BY A.stamina ASC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "防守评分由压力、侵略性和球队宽度的评分组成。提供防守得分最高和最低的球队的缩写。",
    "gold_sql": "SELECT best_team_name , lowest_team_name FROM ( SELECT B.team_short_name AS best_team_name , A.defencePressure + A.defenceAggression + A.defenceTeamWidth AS defensive_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id ORDER BY defensive_rating DESC LIMIT 1 ) JOIN ( SELECT B.team_short_name AS lowest_team_name , A.defencePressure + A.defenceAggression + A.defenceTeamWidth AS defensive_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id ORDER BY defensive_rating ASC LIMIT 1 )"
  },
  {
    "db_id": "soccer_1",
    "question": "防守能力由压力、侵略性和球队宽度的评分构成。给出防守能力最好和最差的球队的缩写。",
    "gold_sql": "SELECT best_team_name , lowest_team_name FROM ( SELECT B.team_short_name AS best_team_name , A.defencePressure + A.defenceAggression + A.defenceTeamWidth AS defensive_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id ORDER BY defensive_rating DESC LIMIT 1 ) JOIN ( SELECT B.team_short_name AS lowest_team_name , A.defencePressure + A.defenceAggression + A.defenceTeamWidth AS defensive_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id ORDER BY defensive_rating ASC LIMIT 1 )"
  },
  {
    "db_id": "soccer_1",
    "question": "在使用自由式创造机会位置战术的球队中，哪支球队在进攻速度和盘带方面的综合得分最高？请提供球队的全名和综合得分。",
    "gold_sql": "SELECT B.team_long_name , A.buildUpPlaySpeed + A.buildUpPlayDribbling AS combined_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id WHERE A.chanceCreationPositioningClass = 'Free Form' ORDER BY A.buildUpPlaySpeed + A.buildUpPlayDribbling DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "哪支使用自由式创造机会位置战术的球队在进攻速度和盘带方面的综合得分最高？列出球队的全名和综合得分。",
    "gold_sql": "SELECT B.team_long_name , A.buildUpPlaySpeed + A.buildUpPlayDribbling AS combined_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id WHERE A.chanceCreationPositioningClass = 'Free Form' ORDER BY A.buildUpPlaySpeed + A.buildUpPlayDribbling DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "在使用自由式创造机会位置战术的球队中，哪支球队在进攻速度和盘带方面的综合得分最高，假设所有球队盘带方面的得分是60？请提供球队的全名和综合得分。",
    "gold_sql": "SELECT B.team_long_name , A.buildUpPlaySpeed + 60 AS combined_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id WHERE A.chanceCreationPositioningClass = 'Free Form' ORDER BY A.buildUpPlaySpeed + 60 DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "假设每一支球队盘带方面的得分都是60，哪支使用自由式创造机会位置战术的球队在进攻速度和盘带方面的综合得分最高？列出球队的全名和综合得分。",
    "gold_sql": "SELECT B.team_long_name , A.buildUpPlaySpeed + 60 AS combined_rating FROM Team_Attributes A JOIN Team B ON A.team_fifa_api_id = B.team_fifa_api_id WHERE A.chanceCreationPositioningClass = 'Free Form' ORDER BY A.buildUpPlaySpeed + 60 DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "射门评分由6个属性组成，包括45%的射门精度、20%的远射、5%的点球、5%的跑位、20%的射门力量和5%的凌空射门。射门评分最高的球员的名字和评分是多少？",
    "gold_sql": "SELECT B.player_name , 0.45 * A.finishing + 0.2 * A.long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ORDER BY shooting_rating DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "射门综合评分由45%的射门精度、20%的远射、5%的点球、5%的跑位、20%的射门力量和5%的凌空射门6个方面组合而成。列出射门综合评分最高的球员的名字和他们的评分。",
    "gold_sql": "SELECT B.player_name , 0.45 * A.finishing + 0.2 * A.long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ORDER BY shooting_rating DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "射门评分由5个属性组成，包括45%的射门精度、20%的远射、5%的点球、5%的跑位、20%的射门力量和5%的凌空射门。如果把所有球员射门属性中的最薄弱一项提高五分，那么射门评分最高的球员的名字和评分是多少？",
    "gold_sql": "SELECT player_name , MAX ( shooting_rating ) FROM ( SELECT B.player_name , MAX ( 0.45 * ( finishing + 5 ) + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE finishing <= long_shots AND finishing <= penalties AND finishing <= positioning AND finishing <= shot_power AND finishing <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * ( long_shots + 5 ) + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE long_shots <= finishing AND long_shots <= penalties AND long_shots <= positioning AND long_shots <= shot_power AND long_shots <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * ( penalties + 5 ) + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE penalties <= finishing AND penalties <= long_shots AND penalties <= positioning AND penalties <= shot_power AND penalties <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * ( positioning + 5 ) + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE positioning <= finishing AND positioning <= long_shots AND positioning <= penalties AND positioning <= shot_power AND positioning <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * ( shot_power + 5 ) + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE shot_power <= finishing AND shot_power <= long_shots AND shot_power <= penalties AND shot_power <= positioning AND shot_power <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * ( volleys + 5 ) ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE volleys <= finishing AND volleys <= long_shots AND volleys <= penalties AND volleys <= positioning AND volleys <= shot_power )"
  },
  {
    "db_id": "soccer_1",
    "question": "射门综合评分由45%的射门精度、20%的远射、5%的点球、5%的跑位、20%的射门力量和5%的凌空射门6个方面组合而成。如果每个球员射门综合评分中最薄弱的一环的粉提高5分，请列出射门评分最高的球员的名字和他们的评分。",
    "gold_sql": "SELECT player_name , MAX ( shooting_rating ) FROM ( SELECT B.player_name , MAX ( 0.45 * ( finishing + 5 ) + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE finishing <= long_shots AND finishing <= penalties AND finishing <= positioning AND finishing <= shot_power AND finishing <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * ( long_shots + 5 ) + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE long_shots <= finishing AND long_shots <= penalties AND long_shots <= positioning AND long_shots <= shot_power AND long_shots <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * ( penalties + 5 ) + 0.05 * positioning + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE penalties <= finishing AND penalties <= long_shots AND penalties <= positioning AND penalties <= shot_power AND penalties <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * ( positioning + 5 ) + 0.2 * shot_power + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE positioning <= finishing AND positioning <= long_shots AND positioning <= penalties AND positioning <= shot_power AND positioning <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * ( shot_power + 5 ) + 0.05 * volleys ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE shot_power <= finishing AND shot_power <= long_shots AND shot_power <= penalties AND shot_power <= positioning AND shot_power <= volleys UNION ALL SELECT B.player_name , MAX ( 0.45 * finishing + 0.2 * long_shots + 0.05 * penalties + 0.05 * positioning + 0.2 * shot_power + 0.05 * ( volleys + 5 ) ) AS shooting_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE volleys <= finishing AND volleys <= long_shots AND volleys <= penalties AND volleys <= positioning AND volleys <= shot_power )"
  },
  {
    "db_id": "soccer_1",
    "question": "对周围队友和对手的位置认知最好和最差的球员的长传得分是多少？他们相差多少？",
    "gold_sql": "SELECT best_vision_long_passing , worst_vision_long_passing , ABS ( worst_vision_long_passing - best_vision_long_passing ) AS diff FROM ( SELECT A.long_passing AS best_vision_long_passing , MAX ( A.vision ) FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ) JOIN ( SELECT A.long_passing AS worst_vision_long_passing , MIN ( A.vision ) FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id )"
  },
  {
    "db_id": "soccer_1",
    "question": "列出对周围队友和对手的位置认知最强和最弱的球员的长传得分，以及他们的差距。",
    "gold_sql": "SELECT best_vision_long_passing , worst_vision_long_passing , ABS ( worst_vision_long_passing - best_vision_long_passing ) AS diff FROM ( SELECT A.long_passing AS best_vision_long_passing , MAX ( A.vision ) FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ) JOIN ( SELECT A.long_passing AS worst_vision_long_passing , MIN ( A.vision ) FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id )"
  },
  {
    "db_id": "soccer_1",
    "question": "在进攻得分中等的球员中，身体强壮程度指标的最高得分和最低得分之间的比例是多少？",
    "gold_sql": "SELECT 1.0 * max_strength / min_strength AS ratio FROM ( SELECT MAX ( A.strength ) AS max_strength FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'medium' ) JOIN ( SELECT MIN ( A.strength ) AS min_strength FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'medium' )"
  },
  {
    "db_id": "soccer_1",
    "question": "列出进攻得分为中等的球员中，身体强壮程度指标的最高分和最低分之间的比例。",
    "gold_sql": "SELECT 1.0 * max_strength / min_strength AS ratio FROM ( SELECT MAX ( A.strength ) AS max_strength FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'medium' ) JOIN ( SELECT MIN ( A.strength ) AS min_strength FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'medium' )"
  },
  {
    "db_id": "soccer_1",
    "question": "评分在80到89分之间意味着非常好。评分在70到79分之间表示良好。罚球区内射门准确度非常好的球员数量与准确度良好的球员数量的比例是多少？",
    "gold_sql": "SELECT 1.0 * very_good / good AS proportion FROM ( SELECT COUNT ( * ) AS very_good FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.penalties BETWEEN 80 AND 89 ) JOIN ( SELECT COUNT ( * ) AS good FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.penalties BETWEEN 70 AND 79 )"
  },
  {
    "db_id": "soccer_1",
    "question": "某项能力评分在80分和89分之间被称之为非常好，评分在70分和79分之间为良好。列出罚球区内射门准确度非常好的球员数量与准确度良好的球员数量的比例。",
    "gold_sql": "SELECT 1.0 * very_good / good AS proportion FROM ( SELECT COUNT ( * ) AS very_good FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.penalties BETWEEN 80 AND 89 ) JOIN ( SELECT COUNT ( * ) AS good FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.penalties BETWEEN 70 AND 79 )"
  },
  {
    "db_id": "soccer_1",
    "question": "最高的选手比最矮的选手重多少倍？",
    "gold_sql": "SELECT 1.0 * highest_weight / lowest_weight AS times FROM ( SELECT weight AS highest_weight , MAX ( height ) FROM Player ) JOIN ( SELECT weight AS lowest_weight , MIN ( height ) FROM Player )"
  },
  {
    "db_id": "soccer_1",
    "question": "身高最高的选手比身高最矮的选手的体重重多少倍？",
    "gold_sql": "SELECT 1.0 * highest_weight / lowest_weight AS times FROM ( SELECT weight AS highest_weight , MAX ( height ) FROM Player ) JOIN ( SELECT weight AS lowest_weight , MIN ( height ) FROM Player )"
  },
  {
    "db_id": "soccer_1",
    "question": "最高的选手比最矮的选手重多少倍，假如最高的选手重170磅？",
    "gold_sql": "SELECT 170.0 / lowest_weight AS times FROM ( SELECT weight AS lowest_weight , MIN ( height ) FROM Player )"
  },
  {
    "db_id": "soccer_1",
    "question": "假设身高最高的选手体重为170磅，那身高最高的选手比身高最矮的选手的体重重多少倍？",
    "gold_sql": "SELECT 170.0 / lowest_weight AS times FROM ( SELECT weight AS lowest_weight , MIN ( height ) FROM Player )"
  },
  {
    "db_id": "soccer_1",
    "question": "列出体重指数最高的球员的姓名、身高、体重和整体评分。",
    "gold_sql": "SELECT B.player_name , B.height , B.weight , A.overall_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id JOIN ( SELECT B.player_fifa_api_id , B.weight * 0.45 / ( ( B.height / 100 ) * ( B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ) AS C ON A.player_fifa_api_id = C.player_fifa_api_id ORDER BY C.BMI DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "体重指数最高的球员是谁，他的身高、体重和整体评分分别是多少？",
    "gold_sql": "SELECT B.player_name , B.height , B.weight , A.overall_rating FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id JOIN ( SELECT B.player_fifa_api_id , B.weight * 0.45 / ( ( B.height / 100 ) * ( B.height / 100 ) ) AS BMI FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id ) AS C ON A.player_fifa_api_id = C.player_fifa_api_id ORDER BY C.BMI DESC LIMIT 1"
  },
  {
    "db_id": "soccer_1",
    "question": "在进攻和防守工作率都“低”的球员中，有多少球员是右脚球员，有多少是左脚球员，相差多少？",
    "gold_sql": "SELECT left_count , right_count , ABS ( left_count - right_count ) FROM ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS left_count FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'low' and A.defensive_work_rate = 'low' and A.preferred_foot = 'left' ) JOIN ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS right_count FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'low' and A.defensive_work_rate = 'low' and A.preferred_foot = 'right' )"
  },
  {
    "db_id": "soccer_1",
    "question": "列出在进攻和防守工作率都为“低”的球员中，右脚球员和左脚球员的数量，以及二者相差的数量。",
    "gold_sql": "SELECT left_count , right_count , ABS ( left_count - right_count ) FROM ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS left_count FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'low' and A.defensive_work_rate = 'low' and A.preferred_foot = 'left' ) JOIN ( SELECT COUNT ( DISTINCT ( B.player_name ) ) AS right_count FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.attacking_work_rate = 'low' and A.defensive_work_rate = 'low' and A.preferred_foot = 'right' )"
  },
  {
    "db_id": "soccer_1",
    "question": "提供一份球员名单、他们的总体评分、以及他们的属性记录日期，且这些球员的传中评分超过了2007年8月30日记录的法比奥·卡纳瓦罗的传中评分的两倍。",
    "gold_sql": "SELECT B.player_name , A.overall_rating , A.date FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id , ( SELECT A.crossing AS FC_crossing FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE B.player_name = 'Fabio Cannavaro' and date ( A.date ) = '2007-08-30' ) WHERE A.crossing > 2.0 * FC_crossing"
  },
  {
    "db_id": "soccer_1",
    "question": "列出所有传中评分超过了2007年8月30日记录的法比奥·卡纳瓦罗的传中评分的两倍的球员的姓名、总体评分、以及他们的属性记录日期。",
    "gold_sql": "SELECT B.player_name , A.overall_rating , A.date FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id , ( SELECT A.crossing AS FC_crossing FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE B.player_name = 'Fabio Cannavaro' and date ( A.date ) = '2007-08-30' ) WHERE A.crossing > 2.0 * FC_crossing"
  },
  {
    "db_id": "soccer_1",
    "question": "假如2007年8月30日法比奥·卡纳瓦罗获得的传中评分是45，提供一份球员名单、他们的总体评分、以及他们的属性记录日期，且这些球员的传中评分超过了2007年8月30日记录的法比奥·卡纳瓦罗的传中评分的两倍。",
    "gold_sql": "SELECT B.player_name , A.overall_rating , A.date FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.crossing > 2.0 * 45"
  },
  {
    "db_id": "soccer_1",
    "question": "假设法比奥·卡纳瓦罗在2007年8月30日获得的传中评分是45分，列出所有传中评分超过了2007年8月30日记录的法比奥·卡纳瓦罗的传中评分的两倍的球员的姓名、总体评分、以及他们的属性记录日期。",
    "gold_sql": "SELECT B.player_name , A.overall_rating , A.date FROM Player_Attributes A JOIN Player B ON A.player_fifa_api_id = B.player_fifa_api_id WHERE A.crossing > 2.0 * 45"
  },
  {
    "db_id": "soccer_1",
    "question": "乔纳森·莱科的体重指数是多少？",
    "gold_sql": "SELECT weight * 0.45 / ( ( 1.0 * height / 100 ) * ( height / 100 ) ) AS BMI FROM Player WHERE player_name = 'Jonathan Leko'"
  },
  {
    "db_id": "soccer_1",
    "question": "名为乔纳森·莱科的运动员的体重指数是多少？",
    "gold_sql": "SELECT weight * 0.45 / ( ( 1.0 * height / 100 ) * ( height / 100 ) ) AS BMI FROM Player WHERE player_name = 'Jonathan Leko'"
  },
  {
    "db_id": "soccer_1",
    "question": "乔纳森·莱科的体重指数是多少，假如他高190cm？",
    "gold_sql": "SELECT weight * 0.45 / ( ( 190.0 / 100 ) * ( 190.0 / 100 ) ) AS BMI FROM Player WHERE player_name = 'Jonathan Leko'"
  },
  {
    "db_id": "soccer_1",
    "question": "假设名为乔纳森·莱科的运动员的身高是190cm，那么他的体重指数是多少？",
    "gold_sql": "SELECT weight * 0.45 / ( ( 190.0 / 100 ) * ( 190.0 / 100 ) ) AS BMI FROM Player WHERE player_name = 'Jonathan Leko'"
  },
   {
    "db_id": "wine_1",
    "question": "2009年总共生产了多少箱酒，比2007年增长了百分之多少？",
    "gold_sql": "SELECT n_2009 , 100.0 * ( n_2009 - n_2007 ) / n_2007 AS growth_rate FROM ( SELECT SUM ( Cases ) AS n_2009 FROM wine WHERE Year = '2009' ) JOIN ( SELECT SUM ( Cases ) AS n_2007 FROM wine WHERE Year = '2007' )"
  },
  {
    "db_id": "wine_1",
    "question": "2009年所有酒总产量是多少箱，比2007年增长的百分比是多少？",
    "gold_sql": "SELECT n_2009 , 100.0 * ( n_2009 - n_2007 ) / n_2007 AS growth_rate FROM ( SELECT SUM ( Cases ) AS n_2009 FROM wine WHERE Year = '2009' ) JOIN ( SELECT SUM ( Cases ) AS n_2007 FROM wine WHERE Year = '2007' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如2009年没有生产长相思葡萄酒，2009年总共生产了多少箱酒，比2007年增长了百分之多少？",
    "gold_sql": "SELECT n_2009 , 100.0 * ( n_2009 - n_2007 ) / n_2007 AS growth_rate FROM ( SELECT SUM ( Cases ) AS n_2009 FROM wine WHERE Year = '2009' AND Name != 'Sauvignon Blanc' ) JOIN ( SELECT SUM ( Cases ) AS n_2007 FROM wine WHERE Year = '2007' )"
  },
  {
    "db_id": "wine_1",
    "question": "假设2009年没有生产长相思葡萄酒，那2009年所有酒总产量是多少箱，比2007年增长的百分比是多少？",
    "gold_sql": "SELECT n_2009 , 100.0 * ( n_2009 - n_2007 ) / n_2007 AS growth_rate FROM ( SELECT SUM ( Cases ) AS n_2009 FROM wine WHERE Year = '2009' AND Name != 'Sauvignon Blanc' ) JOIN ( SELECT SUM ( Cases ) AS n_2007 FROM wine WHERE Year = '2007' )"
  },
  {
    "db_id": "wine_1",
    "question": "有多少种酒不是产自美国葡萄种植区，比产自美国葡萄种植区的酒多多少？",
    "gold_sql": "SELECT no_ava , no_ava - ava AS diff FROM ( SELECT COUNT ( * ) AS no_ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'N' ) JOIN ( SELECT COUNT ( * ) AS ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'Y' )"
  },
  {
    "db_id": "wine_1",
    "question": "产自非美国葡萄种植区的酒有多少种，比产地是美国葡萄种植区的酒多多少？",
    "gold_sql": "SELECT no_ava , no_ava - ava AS diff FROM ( SELECT COUNT ( * ) AS no_ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'N' ) JOIN ( SELECT COUNT ( * ) AS ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'Y' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如价格比葡萄酒均价低10美元以上的酒都产自非美国葡萄种植区，有多少种酒不是产自美国葡萄种植区，比产自美国葡萄种植区的酒多多少？",
    "gold_sql": "SELECT no_ava , no_ava - ava AS diff FROM ( SELECT COUNT ( * ) AS no_ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'N' OR B.Price <= ( SELECT AVG ( Price ) FROM wine ) - 10 ) JOIN ( SELECT COUNT ( * ) AS ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'Y' AND B.Price > ( SELECT AVG ( Price ) FROM wine ) - 10 )"
  },
  {
    "db_id": "wine_1",
    "question": "假设所有价格比葡萄酒平均价格低至少10美元的酒都产自非美国葡萄种植区，那产自非美国葡萄种植区的酒有多少种，比产地是美国葡萄种植区的酒多多少？",
    "gold_sql": "SELECT no_ava , no_ava - ava AS diff FROM ( SELECT COUNT ( * ) AS no_ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'N' OR B.Price <= ( SELECT AVG ( Price ) FROM wine ) - 10 ) JOIN ( SELECT COUNT ( * ) AS ava FROM appellations A JOIN wine B ON A.Appelation = B.Appelation WHERE A.isAVA = 'Y' AND B.Price > ( SELECT AVG ( Price ) FROM wine ) - 10 )"
  },
  {
    "db_id": "wine_1",
    "question": "2008年红葡萄酒的产量是白葡萄酒的多少倍？",
    "gold_sql": "SELECT 1.0 * n_red / n_white AS times FROM ( SELECT SUM ( A.Cases ) AS n_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND A.Year = '2008' ) JOIN ( SELECT SUM ( A.Cases ) AS n_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' AND A.Year = '2008' )"
  },
  {
    "db_id": "wine_1",
    "question": "红葡萄酒的产量在2008年是白葡萄酒同年产量的多少倍？",
    "gold_sql": "SELECT 1.0 * n_red / n_white AS times FROM ( SELECT SUM ( A.Cases ) AS n_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND A.Year = '2008' ) JOIN ( SELECT SUM ( A.Cases ) AS n_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' AND A.Year = '2008' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如每种酒的产量都增加100箱，2008年红葡萄酒的产量是白葡萄酒的多少倍？",
    "gold_sql": "SELECT 1.0 * n_red / n_white AS times FROM ( SELECT SUM ( A.Cases + 100 ) AS n_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND A.Year = '2008' ) JOIN ( SELECT SUM ( A.Cases + 100 ) AS n_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' AND A.Year = '2008' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如每一种酒的产量都增加100箱，那红葡萄酒的产量在2008年是白葡萄酒同年产量的多少倍？",
    "gold_sql": "SELECT 1.0 * n_red / n_white AS times FROM ( SELECT SUM ( A.Cases + 100 ) AS n_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND A.Year = '2008' ) JOIN ( SELECT SUM ( A.Cases + 100 ) AS n_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' AND A.Year = '2008' )"
  },
  {
    "db_id": "wine_1",
    "question": "98评分的酒的最高价和最低价相差多少？",
    "gold_sql": "SELECT MAX ( Price ) - MIN ( Price ) AS diff FROM wine WHERE Score = '98'"
  },
  {
    "db_id": "wine_1",
    "question": "评分为98的酒中，最贵的和最便宜的价格相差多少？",
    "gold_sql": "SELECT MAX ( Price ) - MIN ( Price ) AS diff FROM wine WHERE Score = '98'"
  },
  {
    "db_id": "wine_1",
    "question": "假如卡莱尔酒厂的酒全部涨价10%，98评分的酒的最高价和最低价相差多少？",
    "gold_sql": "SELECT MAX ( Price ) - MIN ( Price ) AS diff FROM ( SELECT price * ( 1 + 0.1 ) AS price , Score FROM wine WHERE Winery = 'Carlisle' UNION ALL SELECT price , Score FROM wine WHERE Winery != 'Carlisle' ) WHERE Score = '98'"
  },
  {
    "db_id": "wine_1",
    "question": "假如卡莱尔酒厂的酒价格全部上调10%，那评分为98的酒中，最贵的和最便宜的价格相差多少？",
    "gold_sql": "SELECT MAX ( Price ) - MIN ( Price ) AS diff FROM ( SELECT price * ( 1 + 0.1 ) AS price , Score FROM wine WHERE Winery = 'Carlisle' UNION ALL SELECT price , Score FROM wine WHERE Winery != 'Carlisle' ) WHERE Score = '98'"
  },
  {
    "db_id": "wine_1",
    "question": "美国葡萄种植区中哪个酒产区的酒总产量没有达到卡拉维拉斯县产区的两倍？",
    "gold_sql": "SELECT A.Appelation FROM wine A JOIN appellations B ON A.Appelation = B.Appelation WHERE B.isAVA = 'Y' GROUP BY A.Appelation HAVING SUM ( A.Cases ) < 2 * ( SELECT SUM ( Cases ) FROM wine WHERE Appelation = 'Calaveras County' )"
  },
  {
    "db_id": "wine_1",
    "question": "属于美国葡萄种植区的酒产区中，哪个酒产区的酒总产量小于卡拉维拉斯县产区的两倍？",
    "gold_sql": "SELECT A.Appelation FROM wine A JOIN appellations B ON A.Appelation = B.Appelation WHERE B.isAVA = 'Y' GROUP BY A.Appelation HAVING SUM ( A.Cases ) < 2 * ( SELECT SUM ( Cases ) FROM wine WHERE Appelation = 'Calaveras County' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如生产于2009年的酒的产量翻倍，美国葡萄种植区中哪个产区的酒总产量没有达到卡拉维拉斯县产区的两倍？",
    "gold_sql": "SELECT A.Appelation FROM (SELECT Appelation, Cases FROM wine WHERE YEAR != '2009' UNION ALL SELECT Appelation, 2 * Cases FROM wine WHERE YEAR = '2009' ) A JOIN appellations B ON A.Appelation = B.Appelation WHERE B.isAVA = 'Y' GROUP BY A.Appelation HAVING SUM (A.Cases) < 2 * (SELECT SUM(Cases) FROM (SELECT SUM (Cases) AS Cases FROM wine WHERE Appelation = 'Calaveras County' AND Year!= 2009 UNION ALL SELECT 2*SUM (Cases) AS Cases FROM wine WHERE Appelation = 'Calaveras County' AND Year= 2009))"
  },
  {
    "db_id": "wine_1",
    "question": "假如在2009年所有酒的产量都翻倍，那属于美国葡萄种植区的酒产区中，哪个酒产区的酒总产量小于卡拉维拉斯县产区的两倍？",
    "gold_sql": "SELECT A.Appelation FROM (SELECT Appelation, Cases FROM wine WHERE YEAR != '2009' UNION ALL SELECT Appelation, 2 * Cases FROM wine WHERE YEAR = '2009' ) A JOIN appellations B ON A.Appelation = B.Appelation WHERE B.isAVA = 'Y' GROUP BY A.Appelation HAVING SUM (A.Cases) < 2 * (SELECT SUM(Cases) FROM (SELECT SUM (Cases) AS Cases FROM wine WHERE Appelation = 'Calaveras County' AND Year!= 2009 UNION ALL SELECT 2*SUM (Cases) AS Cases FROM wine WHERE Appelation = 'Calaveras County' AND Year= 2009))"
  },
  {
    "db_id": "wine_1",
    "question": "价格低于40的酒中，有百分之多少的酒评分高于85？",
    "gold_sql": "SELECT 100.0 * n1 / n2 AS ratio FROM ( SELECT COUNT ( * ) AS n1 FROM wine WHERE Price < '40' AND Score > '85' ) JOIN ( SELECT COUNT ( * ) AS n2 FROM wine WHERE Price < '40' )"
  },
  {
    "db_id": "wine_1",
    "question": "价格不到40的酒中，评分85以上的酒占的百分比是多少？",
    "gold_sql": "SELECT 100.0 * n1 / n2 AS ratio FROM ( SELECT COUNT ( * ) AS n1 FROM wine WHERE Price < '40' AND Score > '85' ) JOIN ( SELECT COUNT ( * ) AS n2 FROM wine WHERE Price < '40' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如用仙粉黛葡萄酿造的葡萄酒全部涨价15，价格低于40的酒中，有百分之多少的酒评分高于85？",
    "gold_sql": "SELECT 100.0 * n1 / n2 AS ratio FROM ( SELECT COUNT ( * ) AS n1 FROM ( SELECT Price , Score FROM wine WHERE Grape != 'Zinfandel' UNION ALL SELECT Price + 15 , Score FROM wine WHERE Grape = 'Zinfandel' ) WHERE Price < '40' AND Score > '85' ) JOIN ( SELECT COUNT ( * ) AS n2 FROM ( SELECT Price , Score FROM wine WHERE Grape != 'Zinfandel' UNION ALL SELECT Price + 15 , Score FROM wine WHERE Grape = 'Zinfandel' ) WHERE Price < '40' )"
  },
  {
    "db_id": "wine_1",
    "question": "假设所有用仙粉黛葡萄酿造的葡萄酒全部涨价15，那价格不到40的酒中，评分85以上的酒占的百分比是多少？",
    "gold_sql": "SELECT 100.0 * n1 / n2 AS ratio FROM ( SELECT COUNT ( * ) AS n1 FROM ( SELECT Price , Score FROM wine WHERE Grape != 'Zinfandel' UNION ALL SELECT Price + 15 , Score FROM wine WHERE Grape = 'Zinfandel' ) WHERE Price < '40' AND Score > '85' ) JOIN ( SELECT COUNT ( * ) AS n2 FROM ( SELECT Price , Score FROM wine WHERE Grape != 'Zinfandel' UNION ALL SELECT Price + 15 , Score FROM wine WHERE Grape = 'Zinfandel' ) WHERE Price < '40' )"
  },
  {
    "db_id": "wine_1",
    "question": "价格最高的酒的产区生产的酒中，有哪些酒的评分比价格最高的酒的最低评分高10分以上？给出它们的编号和名字。",
    "gold_sql": "SELECT No, name FROM wine WHERE Appelation IN ( SELECT Appelation FROM wine WHERE Price = ( SELECT MAX ( Price ) FROM wine ) ) AND Score > ( SELECT MIN ( Score ) FROM wine WHERE Price = ( SELECT MAX ( Price ) FROM wine ) ) + 10"
  },
  {
    "db_id": "wine_1",
    "question": "生产最贵的酒的产区所生产的所有酒当中，列出所有比最贵的酒的最低评分高10分以上的酒的编号和名字。",
    "gold_sql": "SELECT No, name FROM wine WHERE Appelation IN ( SELECT Appelation FROM wine WHERE Price = ( SELECT MAX ( Price ) FROM wine ) ) AND Score > ( SELECT MIN ( Score ) FROM wine WHERE Price = ( SELECT MAX ( Price ) FROM wine ) ) + 10"
  },
  {
    "db_id": "wine_1",
    "question": "假如2008年生产的酒涨价15%，价格最高的酒的产区生产的酒中，有哪些酒的评分比价格最高的酒的最低评分高10分以上？给出它们的编号和名字。",
    "gold_sql": "SELECT No, Name FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Appelation IN (SELECT Appelation FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Price = (SELECT MAX (Price) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' )) ) AND Score > (SELECT MIN (Score) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Price = (SELECT MAX (Price) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' )) ) + 10"
  },
  {
    "db_id": "wine_1",
    "question": "假设2008年所生产的酒价格上涨15%，列出在生产最贵的酒的产区所生产的所有酒当中，比最贵的酒的最低评分高10分以上的酒的编号和名字。",
    "gold_sql": "SELECT No, Name FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Appelation IN (SELECT Appelation FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Price = (SELECT MAX (Price) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' )) ) AND Score > (SELECT MIN (Score) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' ) WHERE Price = (SELECT MAX (Price) FROM (SELECT No, Name, Appelation, Price, Score FROM wine WHERE YEAR != '2008' UNION ALL SELECT No, Name, Appelation, (1 + 0.15) * Price, Score FROM wine WHERE YEAR = '2008' )) ) + 10"
  },
  {
    "db_id": "wine_1",
    "question": "酿造一瓶红葡萄酒需要1.2千克的葡萄。2005年生产的红葡萄酒用了多少吨葡萄？",
    "gold_sql": "SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Year = '2005' AND B.Color = 'Red'"
  },
  {
    "db_id": "wine_1",
    "question": "使用1.2千克的葡萄可以酿造出一瓶红葡萄酒，那么产于2005年的红葡萄酒总共用了多少葡萄酿成？",
    "gold_sql": "SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Year = '2005' AND B.Color = 'Red'"
  },
  {
    "db_id": "wine_1",
    "question": "酿造一瓶红葡萄酒需要1.2千克的葡萄。假如帕洛玛酒厂2005年没有生产葡萄酒，2005年生产的红葡萄酒用了多少吨葡萄？",
    "gold_sql": "SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Year = '2005' AND B.Color = 'Red' AND A.Winery != 'Paloma'"
  },
  {
    "db_id": "wine_1",
    "question": "使用1.2千克的葡萄可以酿造出一瓶红葡萄酒，如果帕洛玛酒厂2005年没有生产葡萄酒，那么产于2005年的红葡萄酒总共用了多少葡萄酿成？",
    "gold_sql": "SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Year = '2005' AND B.Color = 'Red' AND A.Winery != 'Paloma'"
  },
  {
    "db_id": "wine_1",
    "question": "酿造一瓶葡萄酒需要1.2千克的葡萄。在纳帕县生产的葡萄酒一共用了多少吨红葡萄，多少吨白葡萄？",
    "gold_sql": "SELECT * FROM ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_red FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'Red' ) JOIN ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_while FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "使用1.2千克的葡萄可以酿造出一瓶红葡萄酒，产于纳帕县的葡萄酒一共花费了多少吨红葡萄，多少吨白葡萄？",
    "gold_sql": "SELECT * FROM ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_red FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'Red' ) JOIN ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_while FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "酿造一瓶葡萄酒需要1.2千克的葡萄。假如所有卡内罗斯葡萄酒的产区都不在纳帕县，产区在纳帕县的葡萄酒一共用了多少吨红葡萄，多少吨白葡萄？",
    "gold_sql": "SELECT * FROM ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_red FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'Red' AND A.Appelation != 'Carneros' ) JOIN ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_while FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'White' AND A.Appelation != 'Carneros' )"
  },
  {
    "db_id": "wine_1",
    "question": "使用1.2千克的葡萄可以酿造出一瓶红葡萄酒，假如所有卡内罗斯葡萄酒的产区都不在纳帕县，产于纳帕县的葡萄酒一共花费了多少吨红葡萄，多少吨白葡萄？",
    "gold_sql": "SELECT * FROM ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_red FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'Red' AND A.Appelation != 'Carneros' ) JOIN ( SELECT 1.2 * SUM ( A.Cases ) * 12 / 1000 AS tons_while FROM wine A JOIN grapes B ON A.Grape = B.Grape JOIN appellations C ON A.Appelation = C.Appelation WHERE C.County = 'Napa' AND B.Color = 'White' AND A.Appelation != 'Carneros' )"
  },
  {
    "db_id": "wine_1",
    "question": "评分最高的赤霞珠葡萄酒来自哪些酒厂，它们的价格比赤霞珠葡萄酒的平均价高多少？",
    "gold_sql": "SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM wine WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM wine WHERE name = 'Cabernet Sauvignon' )"
  },
  {
    "db_id": "wine_1",
    "question": "评分最高的赤霞珠葡萄酒生产自哪些酒厂，这些酒的价格比赤霞珠葡萄酒的平均价贵多少？",
    "gold_sql": "SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM wine WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM wine WHERE name = 'Cabernet Sauvignon' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如2005年生产的全部酒的评分下降10分，评分最高的赤霞珠葡萄酒来自哪些酒厂，它们的价格比赤霞珠葡萄酒的平均价高多少？",
    "gold_sql": "SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' )"
  },
  {
    "db_id": "wine_1",
    "question": "如果产于2005年的所有酒的评分全部降低10分，那么评分最高的赤霞珠葡萄酒生产自哪些酒厂，这些酒的价格比赤霞珠葡萄酒的平均价贵多少？",
    "gold_sql": "SELECT Winery , Price - ( SELECT AVG ( Price ) FROM wine WHERE name = 'Cabernet Sauvignon' ) AS diff FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' AND Score = ( SELECT MAX ( Score ) FROM ( SELECT Winery , Price , Score - 10 AS Score , Name FROM wine WHERE Year = '2005' UNION ALL SELECT Winery , Price , Score , Name FROM wine WHERE Year != '2005' ) WHERE name = 'Cabernet Sauvignon' )"
  },
  {
    "db_id": "wine_1",
    "question": "最贵的红葡萄酒比最贵的白葡萄酒贵多少？",
    "gold_sql": "SELECT max_red - max_white AS diff FROM ( SELECT MAX ( A.Price ) AS max_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' ) JOIN ( SELECT MAX ( A.Price ) AS max_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "价格最高的红葡萄酒比价格最高的白葡萄酒贵多少？",
    "gold_sql": "SELECT max_red - max_white AS diff FROM ( SELECT MAX ( A.Price ) AS max_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' ) JOIN ( SELECT MAX ( A.Price ) AS max_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "假如安培洛斯酒厂的酒降价20%，最贵的红葡萄酒比最贵的白葡萄酒贵多少？",
    "gold_sql": "SELECT max_red - max_white AS diff FROM ( SELECT MAX ( Price ) AS max_red FROM ( SELECT B.Color , A.Price * ( 1 - 0.2 ) AS Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery = 'Ampelos' UNION ALL SELECT B.Color , A.Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery != 'Ampelos' ) WHERE Color = 'Red' ) JOIN ( SELECT MAX ( Price ) AS max_white FROM ( SELECT B.Color , A.Price * ( 1 - 0.2 ) AS Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery = 'Ampelos' UNION ALL SELECT B.Color , A.Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery != 'Ampelos' ) WHERE Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "如果产自安培洛斯酒厂的酒价格下调20%，价格最高的红葡萄酒比价格最高的白葡萄酒贵多少？",
    "gold_sql": "SELECT max_red - max_white AS diff FROM ( SELECT MAX ( Price ) AS max_red FROM ( SELECT B.Color , A.Price * ( 1 - 0.2 ) AS Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery = 'Ampelos' UNION ALL SELECT B.Color , A.Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery != 'Ampelos' ) WHERE Color = 'Red' ) JOIN ( SELECT MAX ( Price ) AS max_white FROM ( SELECT B.Color , A.Price * ( 1 - 0.2 ) AS Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery = 'Ampelos' UNION ALL SELECT B.Color , A.Price FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE A.Winery != 'Ampelos' ) WHERE Color = 'White' )"
  },
  {
    "db_id": "wine_1",
    "question": "如果一个酒厂能做到连续3年生产的酒评分从未低于90，它就会被评为“优质酒厂”。有百分之多少的酒厂是优质酒厂？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM wine A JOIN wine B ON A.Winery = B.Winery JOIN wine C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
  },
  {
    "db_id": "wine_1",
    "question": "“优质酒厂”是连续3年生产的酒评分从未低于90的酒厂，那么所有酒厂中优质酒厂占多少百分比？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM wine A JOIN wine B ON A.Winery = B.Winery JOIN wine C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
  },
  {
    "db_id": "wine_1",
    "question": "如果一个酒厂能做到连续3年生产的酒评分从未低于90，它就会被评为“优质酒厂”。假如用黑比诺葡萄酿造的葡萄酒评分下降5分，有百分之多少的酒厂是优质酒厂？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) A JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) B ON A.Winery = B.Winery JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
  },
  {
    "db_id": "wine_1",
    "question": "“优质酒厂”是连续3年生产的酒评分从未低于90的酒厂，假设用黑比诺葡萄酿造的葡萄酒评分降低5分，那么所有酒厂中优质酒厂占多少百分比？",
    "gold_sql": "SELECT 100.0 * COUNT ( DISTINCT ( Winery ) ) / ( SELECT COUNT ( DISTINCT ( Winery ) ) FROM wine ) AS percent FROM ( SELECT A.Winery , A.No , A.Year , A.Score , B.No , B.Year , B.Score , C.No , C.Year , C.Score FROM ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) A JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) B ON A.Winery = B.Winery JOIN ( SELECt Winery , No , Year , Score - 5 AS Score FROM wine WHERE Grape = 'Pinot Noir' UNION ALL SELECt Winery , No , Year , Score FROM wine WHERE Grape != 'Pinot Noir' ) C ON A.Winery = C.Winery WHERE A.Score >= 90 AND B.Score >= 90 AND C.Score >= 90 AND B.Year - A.Year = 1 AND C.Year - B.Year = 1 )"
  },
  {
    "db_id": "wine_1",
    "question": "哪年白葡萄酒的产量最高，比当年红葡萄酒的产量高多少？",
    "gold_sql": "SELECT Year , cases_white - cases_red AS diff FROM ( SELECT A.Year , SUM ( A.Cases ) AS cases_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) JOIN ( SELECT SUM ( A.Cases ) AS cases_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND Year = ( SELECT A.Year FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) )"
  },
  {
    "db_id": "wine_1",
    "question": "白葡萄酒产量最高的年份是哪一年，比同年红葡萄酒的产量高多少？",
    "gold_sql": "SELECT Year , cases_white - cases_red AS diff FROM ( SELECT A.Year , SUM ( A.Cases ) AS cases_white FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) JOIN ( SELECT SUM ( A.Cases ) AS cases_red FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND Year = ( SELECT A.Year FROM wine A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) )"
  },
  {
    "db_id": "wine_1",
    "question": "假如贝灵哲酒厂的全部酒产量翻倍，哪年白葡萄酒的产量最高，比当年红葡萄酒的产量高多少？",
    "gold_sql": "SELECT Year , cases_white - cases_red AS diff FROM ( SELECT A.Year , SUM ( A.Cases ) AS cases_white FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) JOIN ( SELECT SUM ( A.Cases ) AS cases_red FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND Year = ( SELECT A.Year FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) )"
  },
  {
    "db_id": "wine_1",
    "question": "假设贝灵哲酒厂的全部酒产量翻倍，白葡萄酒产量最高的年份是哪一年，比同年红葡萄酒的产量高多少？",
    "gold_sql": "SELECT Year , cases_white - cases_red AS diff FROM ( SELECT A.Year , SUM ( A.Cases ) AS cases_white FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) JOIN ( SELECT SUM ( A.Cases ) AS cases_red FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'Red' AND Year = ( SELECT A.Year FROM ( SELECT Grape , Year , 2 * Cases AS Cases FROM wine WHERE Winery = 'Beringer' UNION ALL SELECT Grape , Year , Cases AS Cases FROM wine WHERE Winery != 'Beringer' ) A JOIN grapes B ON A.Grape = B.Grape WHERE B.Color = 'White' GROUP BY A.Year ORDER BY SUM ( A.Cases ) DESC LIMIT 1 ) )"
  },
  {
    "db_id": "world_1",
    "question": "人均国民生产总值最高的国家在哪个大洲？",
    "gold_sql": "SELECT Continent FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "给出人均国民生产总值最高的国家所在的大洲的名字。",
    "gold_sql": "SELECT Continent FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假如库尔勒市所在的国家国民生产总值为1982268，人均国民生产总值最高的国家在哪个大洲？",
    "gold_sql": "SELECT Continent FROM (SELECT '1982268.0' AS GNP, Population, Continent FROM country WHERE name = (SELECT A.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE B.name = 'Korla' ) UNION ALL SELECT GNP, Population, Continent FROM country WHERE name != (SELECT A.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE B.name = 'Korla' ) ) ORDER BY 1.0 * GNP / Population DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "如果库尔勒市所在的国家国民生产总值为1982268，给出人均国民生产总值最高的国家所在的大洲的名字。",
    "gold_sql": "SELECT Continent FROM (SELECT '1982268.0' AS GNP, Population, Continent FROM country WHERE name = (SELECT A.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE B.name = 'Korla' ) UNION ALL SELECT GNP, Population, Continent FROM country WHERE name != (SELECT A.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE B.name = 'Korla' ) ) ORDER BY 1.0 * GNP / Population DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "1979年后独立的国家中，哪个国家的国民生产总值增长率最高？",
    "gold_sql": "SELECT Name FROM country WHERE IndepYear > 1979 ORDER BY 1.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "独立日期在1979年之后的国家中，国民生产总值增长率最高的国家是哪个？",
    "gold_sql": "SELECT Name FROM country WHERE IndepYear > 1979 ORDER BY 1.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "1979年后独立的国家中，哪个国家的国民生产总值增长率最高假如大洋洲所有国家现在的国民生产总值增加1000000？",
    "gold_sql": "SELECT name FROM ( SELECT name , GNP + 1000000 AS GNP , GNPOld , IndepYear FROM country WHERE Continent = 'Oceania' UNION ALL SELECT name , GNP , GNPOld , IndepYear FROM country WHERE Continent != 'Oceania' ) WHERE IndepYear > 1979 ORDER BY 1.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假设大洋洲所有国家现在的国民生产总值增加1000000，给出在1979年之后独立的国家中，所有国民生产总值增长率最高的国家名字。",
    "gold_sql": "SELECT name FROM ( SELECT name , GNP + 1000000 AS GNP , GNPOld , IndepYear FROM country WHERE Continent = 'Oceania' UNION ALL SELECT name , GNP , GNPOld , IndepYear FROM country WHERE Continent != 'Oceania' ) WHERE IndepYear > 1979 ORDER BY 1.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "哪个绝大多数人说英语的国家的人口密度最高，是人口密度最低的国家的多少倍？",
    "gold_sql": "SELECT Name , ( 100.0 * Population / SurfaceArea ) / ( SELECT MIN ( 100.0 * Population / SurfaceArea ) FROM country WHERE 100.0 * Population / SurfaceArea > 0 ) AS times FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT * , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'English' ) ORDER BY 100.0 * Population / SurfaceArea DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "在使用人数占比最高的语言为英语的国家中，人口密度最高的国家是哪个？它的人口密度是人口密度最低的国家的多少倍？",
    "gold_sql": "SELECT Name , ( 100.0 * Population / SurfaceArea ) / ( SELECT MIN ( 100.0 * Population / SurfaceArea ) FROM country WHERE 100.0 * Population / SurfaceArea > 0 ) AS times FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT * , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'English' ) ORDER BY 100.0 * Population / SurfaceArea DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假如爱尔兰没有一个人说英语，哪个绝大多数人说英语的国家的人口密度最高，是人口密度最低的国家的多少倍？",
    "gold_sql": "SELECT Name , ( 100.0 * Population / SurfaceArea ) / ( SELECT MIN ( 100.0 * Population / SurfaceArea ) FROM country WHERE 100.0 * Population / SurfaceArea > 0 ) AS times FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT * , MAX ( Percentage ) FROM countrylanguage A JOIN country B ON A.CountryCode = B.Code WHERE B.name != 'Ireland' GROUP BY A.CountryCode ) WHERE Language = 'English' ) ORDER BY 100.0 * Population / SurfaceArea DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假设爱尔兰没有说英语的人，那么在使用人数占比最高的语言为英语的国家中，人口密度最高的国家是哪个？它的人口密度是人口密度最低的国家的多少倍？",
    "gold_sql": "SELECT Name , ( 100.0 * Population / SurfaceArea ) / ( SELECT MIN ( 100.0 * Population / SurfaceArea ) FROM country WHERE 100.0 * Population / SurfaceArea > 0 ) AS times FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT * , MAX ( Percentage ) FROM countrylanguage A JOIN country B ON A.CountryCode = B.Code WHERE B.name != 'Ireland' GROUP BY A.CountryCode ) WHERE Language = 'English' ) ORDER BY 100.0 * Population / SurfaceArea DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "阿拉伯语不是官方语言的国家中，哪个国家的国民生产总值的增长幅度最大？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM countrylanguage WHERE Language = 'Arabic' AND IsOfficial = 'T' ) ORDER BY 100.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "所有不以阿拉伯语为官方语言的国家中，国民生产总值增长幅度最大的国家的名字是什么？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM countrylanguage WHERE Language = 'Arabic' AND IsOfficial = 'T' ) ORDER BY 100.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假如南美洲所有国家过去的国民生产总值增加9999，在阿拉伯语不是官方语言的国家中，哪个国家的国民生产总值的增长幅度最大？",
    "gold_sql": "SELECT Name FROM ( SELECT Name , Code , GNP , GNPOld + 9999.0 AS GNPOld FROM country WHERE Continent = 'South America' UNION ALL SELECT Name , Code , GNP , GNPOld FROM country WHERE Continent != 'South America' ) WHERE Code NOT IN ( SELECT CountryCode FROM countrylanguage WHERE Language = 'Arabic' AND IsOfficial = 'T' ) ORDER BY 100.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "如果所有位于南美洲的国家的过去的国民生产总值增加9999，在所有不以阿拉伯语为官方语言的国家中，国民生产总值增长幅度最大的国家的名字是什么？",
    "gold_sql": "SELECT Name FROM ( SELECT Name , Code , GNP , GNPOld + 9999.0 AS GNPOld FROM country WHERE Continent = 'South America' UNION ALL SELECT Name , Code , GNP , GNPOld FROM country WHERE Continent != 'South America' ) WHERE Code NOT IN ( SELECT CountryCode FROM countrylanguage WHERE Language = 'Arabic' AND IsOfficial = 'T' ) ORDER BY 100.0 * ( GNP - GNPOld ) / GNPOld DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "北美洲哪个城市的人口数量至少是江原道行政区的两倍？",
    "gold_sql": "SELECT B.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE A.Continent = 'North America' AND B.Population >= 2 * ( SELECT SUM ( Population ) FROM city WHERE District = 'Kang-won' )"
  },
  {
    "db_id": "world_1",
    "question": "列出位于北美洲的人口数量至少是江原道行政区的两倍的所有城市名字。",
    "gold_sql": "SELECT B.name FROM country A JOIN city B ON A.Code = B.CountryCode WHERE A.Continent = 'North America' AND B.Population >= 2 * ( SELECT SUM ( Population ) FROM city WHERE District = 'Kang-won' )"
  },
  {
    "db_id": "world_1",
    "question": "假如北美洲以英语为官方语言的国家的城市人口增加1%，北美洲哪个城市的人口数量至少是江原道行政区的两倍？",
    "gold_sql": "SELECT DISTINCT ( name ) FROM ( SELECT B.name , B.Population * ( 1 + 0.01 ) AS Population FROM country A JOIN city B ON A.Code = B.CountryCode JOIN countrylanguage C ON A.Code = C.CountryCode WHERE A.Continent = 'North America' AND C.Language = 'English' AND C.IsOfficial = 'T' UNION ALL SELECT B.name , B.Population FROM country A JOIN city B ON A.Code = B.CountryCode JOIN countrylanguage C ON A.Code = C.CountryCode WHERE A.Continent = 'North America' AND NOT ( C.Language = 'English' AND C.IsOfficial = 'T' ) ) WHERE Population >= 2 * ( SELECT SUM ( Population ) FROM city WHERE District = 'Kang-won' )"
  },
  {
    "db_id": "world_1",
    "question": "假如以英语为官方语言的北美洲国家的城市人口增加1%，列出位于北美洲的人口数量至少是江原道行政区的两倍的所有城市名字。",
    "gold_sql": "SELECT DISTINCT ( name ) FROM ( SELECT B.name , B.Population * ( 1 + 0.01 ) AS Population FROM country A JOIN city B ON A.Code = B.CountryCode JOIN countrylanguage C ON A.Code = C.CountryCode WHERE A.Continent = 'North America' AND C.Language = 'English' AND C.IsOfficial = 'T' UNION ALL SELECT B.name , B.Population FROM country A JOIN city B ON A.Code = B.CountryCode JOIN countrylanguage C ON A.Code = C.CountryCode WHERE A.Continent = 'North America' AND NOT ( C.Language = 'English' AND C.IsOfficial = 'T' ) ) WHERE Population >= 2 * ( SELECT SUM ( Population ) FROM city WHERE District = 'Kang-won' )"
  },
  {
    "db_id": "world_1",
    "question": "哪个大洲的国民生产总值增长率至少是非洲的1.5倍？",
    "gold_sql": "SELECT Continent FROM country GROUP BY Continent HAVING 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) > 1.5 * ( SELECT 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) FROM country WHERE Continent = 'Africa' )"
  },
  {
    "db_id": "world_1",
    "question": "列出所有国民生产总值增长率至少是非洲的1.5倍的大洲的名字。",
    "gold_sql": "SELECT Continent FROM country GROUP BY Continent HAVING 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) > 1.5 * ( SELECT 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) FROM country WHERE Continent = 'Africa' )"
  },
  {
    "db_id": "world_1",
    "question": "假如绝大多数人说捷克语的国家现在的国民生产总值增加0.5%，哪个大洲的国民生产总值增长率至少是非洲的1.5倍？",
    "gold_sql": "SELECT Continent FROM ( SELECT Code , GNP * ( 1 + 0.005 ) AS GNP , GNPOld , Continent FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Czech' ) UNION ALL SELECT Code , GNP , GNPOld , Continent FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Czech' ) ) GROUP BY Continent HAVING 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) > 1.5 * ( SELECT 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) FROM country WHERE Continent = 'Africa' )"
  },
  {
    "db_id": "world_1",
    "question": "如果使用人数比例最高的语言是捷克语的国家现在的国民生产总值增加0.5%，列出所有国民生产总值增长率至少是非洲的1.5倍的大洲的名字。",
    "gold_sql": "SELECT Continent FROM ( SELECT Code , GNP * ( 1 + 0.005 ) AS GNP , GNPOld , Continent FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Czech' ) UNION ALL SELECT Code , GNP , GNPOld , Continent FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Czech' ) ) GROUP BY Continent HAVING 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) > 1.5 * ( SELECT 100.0 * ( SUM ( GNP ) - SUM ( GNPOld ) ) / SUM ( GNPOld ) FROM country WHERE Continent = 'Africa' )"
  },
  {
    "db_id": "world_1",
    "question": "哪个国家的人口预期寿命不低于赞比亚的1.5倍？",
    "gold_sql": "SELECT Name FROM country WHERE LifeExpectancy >= 1.5 * ( SELECT LifeExpectancy FROM country WHERE name = 'Zambia' )"
  },
  {
    "db_id": "world_1",
    "question": "列出所有人口预期寿命不低于赞比亚的1.5倍的国家名字。",
    "gold_sql": "SELECT Name FROM country WHERE LifeExpectancy >= 1.5 * ( SELECT LifeExpectancy FROM country WHERE name = 'Zambia' )"
  },
  {
    "db_id": "world_1",
    "question": "假如人均国民生产总值是全球前20的国家的人口预期寿命都是90，哪个国家的人口预期寿命不低于赞比亚的1.5倍？",
    "gold_sql": "SELECT Name FROM ( SELECT Name , 90 AS LifeExpectancy FROM country WHERE Code IN ( SELECT Code FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 20 ) UNION ALL SELECT Name , LifeExpectancy FROM country WHERE Code NOT IN ( SELECT Code FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 20 ) ) WHERE LifeExpectancy >= 1.5 * ( SELECT LifeExpectancy FROM country WHERE name = 'Zambia' )"
  },
  {
    "db_id": "world_1",
    "question": "假如人均国民生产总值排名全球前20的国家的人口预期寿命都是90，列出所有人口预期寿命不低于赞比亚的1.5倍的国家名字。",
    "gold_sql": "SELECT Name FROM ( SELECT Name , 90 AS LifeExpectancy FROM country WHERE Code IN ( SELECT Code FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 20 ) UNION ALL SELECT Name , LifeExpectancy FROM country WHERE Code NOT IN ( SELECT Code FROM country ORDER BY 1.0 * GNP / Population DESC LIMIT 20 ) ) WHERE LifeExpectancy >= 1.5 * ( SELECT LifeExpectancy FROM country WHERE name = 'Zambia' )"
  },
  {
    "db_id": "world_1",
    "question": "荷兰语不是最主要语言的国家中，哪个国家的国民生产总值的减少量最大？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Dutch' ) ORDER BY GNPOld - GNP DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "在所有不以荷兰语为最主要语言的国家中，哪个国家的国民生产总值降低幅度最大？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Dutch' ) ORDER BY GNPOld - GNP DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假如阿鲁巴岛所有人都说荷兰语，荷兰语不是最主要语言的国家中，哪个国家的国民生产总值的减少量最大？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Dutch' UNION SELECT Code FROM country WHERE name = 'Aruba' ) ORDER BY GNPOld - GNP DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "假如荷兰语事阿鲁巴岛唯一一种使用的语言，那么在所有不以荷兰语为最主要语言的国家中，哪个国家的国民生产总值降低幅度最大？",
    "gold_sql": "SELECT Name FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Dutch' UNION SELECT Code FROM country WHERE name = 'Aruba' ) ORDER BY GNPOld - GNP DESC LIMIT 1"
  },
  {
    "db_id": "world_1",
    "question": "北美洲洲国民生产总值呈下降趋势的国家比南美洲多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM country WHERE GNP < GNPOld AND Continent = 'North America'"
  },
  {
    "db_id": "world_1",
    "question": "位于北美洲的国家中，国民生产总值呈下降趋势的国家比南美洲多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM country WHERE GNP < GNPOld AND Continent = 'North America'"
  },
  {
    "db_id": "world_1",
    "question": "假如北美洲人口最多的前两个国家当前的国民生产总值增加2%，北美洲洲国民生产总值呈下降趋势的国家比南美洲多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM ( SELECT Name , GNP * ( 1 + 0.02 ) AS GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) UNION ALL SELECT Name , GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code NOT IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) ) WHERE GNP < GNPOld AND Continent = 'North America'"
  },
  {
    "db_id": "world_1",
    "question": "假如北美洲人口数量排名最高的两个国家的当前的国民生产总值增加2%，那么在位于北美洲的国家中，国民生产总值呈下降趋势的国家比南美洲多多少？",
    "gold_sql": "SELECT COUNT ( * ) - ( SELECT COUNT ( * ) FROM country WHERE GNP < GNPOld AND Continent = 'South America' ) AS diff FROM ( SELECT Name , GNP * ( 1 + 0.02 ) AS GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) UNION ALL SELECT Name , GNP , GNPOld , Continent FROM country WHERE Continent = 'North America' AND Code NOT IN ( SELECT Code FROM country WHERE Continent = 'North America' ORDER BY Population DESC LIMIT 2 ) ) WHERE GNP < GNPOld AND Continent = 'North America'"
  },
  {
    "db_id": "world_1",
    "question": "哪个大洲的人均国民生产总值增长率比欧洲高至少两个点？",
    "gold_sql": "SELECT Continent FROM country GROUP BY Continent HAVING 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) >= ( SELECT 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) FROM country WHERE Continent = 'Europe' ) + 0.02"
  },
  {
    "db_id": "world_1",
    "question": "列出所有人均国民生产总值增长率比欧洲高至少两个百分点的大洲。",
    "gold_sql": "SELECT Continent FROM country GROUP BY Continent HAVING 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) >= ( SELECT 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) FROM country WHERE Continent = 'Europe' ) + 0.02"
  },
  {
    "db_id": "world_1",
    "question": "假如人口预期寿命最长的前3个国家国民生产总值减少2%，哪个大洲的人均国民生产总值增长率比欧洲高至少两个点？",
    "gold_sql": "SELECT Continent FROM ( SELECT name , Continent , GNP * ( 1 - 0.02 ) AS GNP , Population , GNPOld FROM country WHERE Code IN ( SELECT Code FROM country ORDER BY LifeExpectancy DESC LIMIT 3 ) UNION ALL SELECT name , Continent , GNP , Population , GNPOld FROM country WHERE Code NOT IN ( SELECT Code FROM country ORDER BY LifeExpectancy DESC LIMIT 3 ) ) GROUP BY Continent HAVING 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) >= ( SELECT 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) FROM country WHERE Continent = 'Europe' ) + 0.02"
  },
  {
    "db_id": "world_1",
    "question": "假设人口预期寿命位列前3的国家国民生产总值减少2%，列出所有人均国民生产总值增长率比欧洲高至少两个百分点的大洲。",
    "gold_sql": "SELECT Continent FROM ( SELECT name , Continent , GNP * ( 1 - 0.02 ) AS GNP , Population , GNPOld FROM country WHERE Code IN ( SELECT Code FROM country ORDER BY LifeExpectancy DESC LIMIT 3 ) UNION ALL SELECT name , Continent , GNP , Population , GNPOld FROM country WHERE Code NOT IN ( SELECT Code FROM country ORDER BY LifeExpectancy DESC LIMIT 3 ) ) GROUP BY Continent HAVING 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) >= ( SELECT 1.0 * ( SUM ( GNP ) / SUM ( Population ) - SUM ( GNPOld ) / SUM ( Population ) ) / ( SUM ( GNPOld ) / SUM ( Population ) ) FROM country WHERE Continent = 'Europe' ) + 0.02"
  },
  {
    "db_id": "world_1",
    "question": "如果增长幅度保持不变，列出亚洲每个国家的名字、过去的国民生产总值、现在的国民生产总值，并预估一下未来的国民生产总值。",
    "gold_sql": "SELECT name , GNPOld , GNP , GNP + ( GNP - GNPOld ) AS GNPFuture FROM country WHERE Continent = 'Asia'"
  },
  {
    "db_id": "world_1",
    "question": "假设国民生产总值增长幅度保持恒定，列出每个位于亚洲的国家的名字、过去的国民生产总值、现在的国民生产总值，和预期的未来的国民生产总值。",
    "gold_sql": "SELECT name , GNPOld , GNP , GNP + ( GNP - GNPOld ) AS GNPFuture FROM country WHERE Continent = 'Asia'"
  },
  {
    "db_id": "world_1",
    "question": "如果增长幅度保持不变且以中文为主要语言的国家现在的国民生产总值是1000000.0，列出亚洲每个国家的名字、过去的国民生产总值、现在的国民生产总值，并预估一下未来的国民生产总值？",
    "gold_sql": "SELECT name , GNPOld , GNP , GNP + ( GNP - GNPOld ) AS GNPFuture FROM ( SELECT name , GNPOld , 1000000.0 AS GNP , Continent FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Chinese' ) UNION ALL SELECT name , GNPOld , GNP , Continent FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Chinese' ) ) WHERE Continent = 'Asia'"
  },
  {
    "db_id": "world_1",
    "question": "假设以中文为主要语言的国家现在的国民生产总值是1000000.0，且所有国家国民生产总值增长幅度保持恒定，列出每个位于亚洲的国家的名字、过去的国民生产总值、现在的国民生产总值，和预期的未来的国民生产总值。",
    "gold_sql": "SELECT name , GNPOld , GNP , GNP + ( GNP - GNPOld ) AS GNPFuture FROM ( SELECT name , GNPOld , 1000000.0 AS GNP , Continent FROM country WHERE Code IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Chinese' ) UNION ALL SELECT name , GNPOld , GNP , Continent FROM country WHERE Code NOT IN ( SELECT CountryCode FROM ( SELECT CountryCode , Language , MAX ( Percentage ) FROM countrylanguage GROUP BY CountryCode ) WHERE Language = 'Chinese' ) ) WHERE Continent = 'Asia'"
  },
  {
    "db_id": "world_1",
    "question": "英国的人口年增长率是0.4%，1年后英国的人口数量是多少？",
    "gold_sql": "SELECT Population * ( 1 + 0.004 ) AS population_in_1year FROM country WHERE name = 'United Kingdom'"
  },
  {
    "db_id": "world_1",
    "question": "列出1年之后英国的人口数量，已知英国的人口年增长率是0.4%。",
    "gold_sql": "SELECT Population * ( 1 + 0.004 ) AS population_in_1year FROM country WHERE name = 'United Kingdom'"
  },
  {
    "db_id": "world_1",
    "question": "假如欧洲人口预期寿命大于75的国家的人口数量为103000，英国的人口年增长率是0.4%，1年后英国的人口数量是多少？",
    "gold_sql": "SELECT Population * ( 1 + 0.004 ) AS population_in_1year FROM ( SELECT Continent , name , 103000 AS Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy > 75 UNION SELECT Continent , name , Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy <= 75 ) WHERE name = 'United Kingdom'"
  },
  {
    "db_id": "world_1",
    "question": "假设位于欧洲且人口预期寿命大于75的国家的人口数量为103000，请列出1年之后英国的人口数量，已知英国的人口年增长率是0.4%。",
    "gold_sql": "SELECT Population * ( 1 + 0.004 ) AS population_in_1year FROM ( SELECT Continent , name , 103000 AS Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy > 75 UNION SELECT Continent , name , Population FROM country WHERE Continent = 'Europe' AND LifeExpectancy <= 75 ) WHERE name = 'United Kingdom'"
  },
  {
    "db_id": "world_1",
    "question": "按照赞比亚的预期寿命，出生于赞比亚独立那年的人的预期死亡年份是哪年？",
    "gold_sql": "SELECT CAST ( IndepYear + LifeExpectancy AS INT ) AS death_year FROM country WHERE name = 'Zambia'"
  },
  {
    "db_id": "world_1",
    "question": "假设一个赞比亚人出生于赞比亚独立的那一年，请根据赞比亚的预期寿命预测这个人的预期死亡年份。",
    "gold_sql": "SELECT CAST ( IndepYear + LifeExpectancy AS INT ) AS death_year FROM country WHERE name = 'Zambia'"
  },
  {
    "db_id": "world_1",
    "question": "假如人均国民生产总值大于欧洲所有国家的平均人均国民生产总值的国家的人口预期寿命增加10年，按照赞比亚的预期寿命，出生于赞比亚独立那年的人的预期死亡年份是哪年？",
    "gold_sql": "SELECT CAST ( IndepYear + LifeExpectancy AS INT ) AS death_year FROM ( SELECT name , IndepYear , LifeExpectancy + 10 AS LifeExpectancy FROM country WHERE 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) UNION ALL SELECT name , IndepYear , LifeExpectancy FROM country WHERE NOT ( 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) ) ) WHERE name = 'Zambia'"
  },
  {
    "db_id": "world_1",
    "question": "假如人均国民生产总值大于欧洲所有国家的平均人均国民生产总值的国家的人口预期寿命增加10年，那么如果一个赞比亚人出生于赞比亚独立的那一年，请根据赞比亚的预期寿命预测这个人的预期死亡年份。",
    "gold_sql": "SELECT CAST ( IndepYear + LifeExpectancy AS INT ) AS death_year FROM ( SELECT name , IndepYear , LifeExpectancy + 10 AS LifeExpectancy FROM country WHERE 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) UNION ALL SELECT name , IndepYear , LifeExpectancy FROM country WHERE NOT ( 1.0 * GNP / Population > ( SELECT 1.0 * SUM ( GNP ) / SUM ( Population ) FROM country WHERE Continent = 'Europe' ) ) ) WHERE name = 'Zambia'"
  },
  {
    "db_id": "formula_1",
    "question": "五年后，刘易斯·汉密尔顿多大了？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) + 5 - substr ( dob , 7 , 4 ) + ( strftime ( '%m' , 'now' ) > substr ( dob , 4 , 2 ) OR ( strftime ( '%m' , 'now' ) = substr ( dob , 4 , 2 ) AND strftime ( '%d' , 'now' ) > substr ( dob , 1 , 2 ) ) ) AS age FROM drivers WHERE forename = 'Lewis' and surname = 'Hamilton'"
  },
  {
    "db_id": "formula_1",
    "question": "刘易斯·汉密尔顿在五年后的年龄是多大？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) + 5 - substr ( dob , 7 , 4 ) + ( strftime ( '%m' , 'now' ) > substr ( dob , 4 , 2 ) OR ( strftime ( '%m' , 'now' ) = substr ( dob , 4 , 2 ) AND strftime ( '%d' , 'now' ) > substr ( dob , 1 , 2 ) ) ) AS age FROM drivers WHERE forename = 'Lewis' and surname = 'Hamilton'"
  },
  {
    "db_id": "formula_1",
    "question": "五年后，刘易斯·汉密尔顿多大了，假如他出生于2020年1月1日？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) + 5 - 2020 + ( strftime ( '%m' , 'now' ) > 1 OR ( strftime ( '%m' , 'now' ) = substr ( dob , 4 , 2 ) AND strftime ( '%d' , 'now' ) > 1 ) ) AS age FROM drivers WHERE forename = 'Lewis' and surname = 'Hamilton'"
  },
  {
    "db_id": "formula_1",
    "question": "如果刘易斯·汉密尔顿的生日是2020年1月1日，那他在五年后的年龄是多大？",
    "gold_sql": "SELECT strftime ( '%Y' , 'now' ) + 5 - 2020 + ( strftime ( '%m' , 'now' ) > 1 OR ( strftime ( '%m' , 'now' ) = substr ( dob , 4 , 2 ) AND strftime ( '%d' , 'now' ) > 1 ) ) AS age FROM drivers WHERE forename = 'Lewis' and surname = 'Hamilton'"
  },
  {
    "db_id": "formula_1",
    "question": "在2009年澳大利亚大奖赛资格赛中，排名第一的车手在三场比赛中的平均圈速是多少？",
    "gold_sql": "SELECT time ( ( strftime ( '%s' , '00:0' || q1 ) + strftime ( '%s' , '00:0' || q2 ) + strftime ( '%s' , '00:0' || q3 ) ) / 3.0 , 'unixepoch' ) AS avg_lap FROM qualifying A JOIN races B ON A.raceId = B.raceId WHERE B.name = 'Australian Grand Prix' AND B.year = '2009' AND A.position = '1'"
  },
  {
    "db_id": "formula_1",
    "question": "在2009年澳大利亚大奖赛资格赛中排名最高的车手三场比赛的平均圈速是多少？",
    "gold_sql": "SELECT time ( ( strftime ( '%s' , '00:0' || q1 ) + strftime ( '%s' , '00:0' || q2 ) + strftime ( '%s' , '00:0' || q3 ) ) / 3.0 , 'unixepoch' ) AS avg_lap FROM qualifying A JOIN races B ON A.raceId = B.raceId WHERE B.name = 'Australian Grand Prix' AND B.year = '2009' AND A.position = '1'"
  },
  {
    "db_id": "formula_1",
    "question": "在2009年澳大利亚大奖赛资格赛中，排名第一的车手在三场比赛中的平均圈速是多少，假设他在q1中的圈速是1:26.026？",
    "gold_sql": "SELECT time ( ( strftime ( '%s' , '00:0' || '1:26.026' ) + strftime ( '%s' , '00:0' || q2 ) + strftime ( '%s' , '00:0' || q3 ) ) / 3.0 , 'unixepoch' ) AS avg_lap FROM qualifying A JOIN races B ON A.raceId = B.raceId WHERE B.name = 'Australian Grand Prix' AND B.year = '2009' AND A.position = '1'"
  },
  {
    "db_id": "formula_1",
    "question": "如果在2009年澳大利亚大奖赛资格赛中排名最高的车手在q1中的圈速是1:26.026，那他三场比赛中的平均圈速是多少？",
    "gold_sql": "SELECT time ( ( strftime ( '%s' , '00:0' || '1:26.026' ) + strftime ( '%s' , '00:0' || q2 ) + strftime ( '%s' , '00:0' || q3 ) ) / 3.0 , 'unixepoch' ) AS avg_lap FROM qualifying A JOIN races B ON A.raceId = B.raceId WHERE B.name = 'Australian Grand Prix' AND B.year = '2009' AND A.position = '1'"
  },
  {
    "db_id": "formula_1",
    "question": "最靠近北回归线的赛道的名称和位置是什么？",
    "gold_sql": "SELECT name , location FROM circuits ORDER BY ABS ( lat - 23.4394 ) ASC LIMIT 1"
  },
  {
    "db_id": "formula_1",
    "question": "列出离北回归线最近的赛道的名称和位置。",
    "gold_sql": "SELECT name , location FROM circuits ORDER BY ABS ( lat - 23.4394 ) ASC LIMIT 1"
  },
  {
    "db_id": "formula_1",
    "question": "离南回归线最远的赛道叫什么名字？",
    "gold_sql": "SELECT name FROM circuits ORDER BY ABS ( lat - ( - 23.4394 ) ) DESC LIMIT 1"
  },
  {
    "db_id": "formula_1",
    "question": "给出距离南回归线距离最远的赛道名称。",
    "gold_sql": "SELECT name FROM circuits ORDER BY ABS ( lat - ( - 23.4394 ) ) DESC LIMIT 1"
  },
  {
    "db_id": "formula_1",
    "question": "2009年和2010年分别举行了多少场比赛？它们相差多少？",
    "gold_sql": "SELECT n_2009 , n_2010 , ABS ( n_2009 - n_2010 ) AS diff FROM ( SELECT COUNT ( * ) AS n_2009 FROM races WHERE year = '2009' ) JOIN ( SELECT COUNT ( * ) AS n_2010 FROM races WHERE year = '2010' )"
  },
  {
    "db_id": "formula_1",
    "question": "分别列出在2009年和2010年举行的比赛数量，以及二者的差距。",
    "gold_sql": "SELECT n_2009 , n_2010 , ABS ( n_2009 - n_2010 ) AS diff FROM ( SELECT COUNT ( * ) AS n_2009 FROM races WHERE year = '2009' ) JOIN ( SELECT COUNT ( * ) AS n_2010 FROM races WHERE year = '2010' )"
  },
  {
    "db_id": "formula_1",
    "question": "2009年和2010年分别举行了多少场比赛？它们相差多少假如2010年再多举行了5场比赛？",
    "gold_sql": "SELECT n_2009 , n_2010 + 5 , ABS ( n_2010 + 5 - n_2009 ) AS diff FROM ( SELECT COUNT ( * ) AS n_2009 FROM races WHERE year = '2009' ) JOIN ( SELECT COUNT ( * ) AS n_2010 FROM races WHERE year = '2010' )"
  },
  {
    "db_id": "formula_1",
    "question": "如果2010年再多举办5场比赛，分别列出在2009年和2010年举行的比赛数量，以及二者的差距。",
    "gold_sql": "SELECT n_2009 , n_2010 + 5 , ABS ( n_2010 + 5 - n_2009 ) AS diff FROM ( SELECT COUNT ( * ) AS n_2009 FROM races WHERE year = '2009' ) JOIN ( SELECT COUNT ( * ) AS n_2010 FROM races WHERE year = '2010' )"
  },
  {
    "db_id": "formula_1",
    "question": "法国比意大利多举行了多少场比赛？",
    "gold_sql": "SELECT n_france - n_italy FROM ( SELECT COUNT ( * ) AS n_france FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.Country = 'France' ) JOIN ( SELECT COUNT ( * ) AS n_italy FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.Country = 'Italy' )"
  },
  {
    "db_id": "formula_1",
    "question": "在法国举办的比赛数量比在意大利举办的比赛数量多多少？",
    "gold_sql": "SELECT n_france - n_italy FROM ( SELECT COUNT ( * ) AS n_france FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.Country = 'France' ) JOIN ( SELECT COUNT ( * ) AS n_italy FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.Country = 'Italy' )"
  },
  {
    "db_id": "formula_1",
    "question": "北半球和南半球分别举行了多少场比赛？它们相差多少？",
    "gold_sql": "SELECT n_north , n_south , n_north - n_south FROM ( SELECT COUNT ( * ) AS n_north FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.lat > 0 ) JOIN ( SELECT COUNT ( * ) AS n_south FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.lat < 0 )"
  },
  {
    "db_id": "formula_1",
    "question": "分别列出举办位置在北半球和南半球的比赛数量，以及二者的差距。",
    "gold_sql": "SELECT n_north , n_south , n_north - n_south FROM ( SELECT COUNT ( * ) AS n_north FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.lat > 0 ) JOIN ( SELECT COUNT ( * ) AS n_south FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.lat < 0 )"
  },
  {
    "db_id": "formula_1",
    "question": "在2006年英国大奖赛资格赛第一轮比赛中，给出速度最快、最慢的车手的姓，名，以及他们圈速的差距。",
    "gold_sql": "SELECT forename_slowest , surname_slowest , forename_fastest , surname_fastest , time ( ( strftime ( '%s' , '00:0' || slowest_q1 ) - strftime ( '%s' , '00:0' || fastest_q1 ) ) , 'unixepoch' ) AS diff FROM ( SELECT MAX ( A.q1 ) AS slowest_q1 , D.forename AS forename_slowest , D.surname AS surname_slowest FROM qualifying A JOIN races B ON A.raceId = B.raceId JOIN drivers D ON A.driverId = D.driverId WHERE B.name = 'British Grand Prix' AND B.year = '2006' ) JOIN ( SELECT MIN ( A.q1 ) AS fastest_q1 , D.forename AS forename_fastest , D.surname AS surname_fastest FROM qualifying A JOIN races B ON A.raceId = B.raceId JOIN drivers D ON A.driverId = D.driverId WHERE B.name = 'British Grand Prix' AND B.year = '2006' AND A.q1 != '' )"
  },
  {
    "db_id": "formula_1",
    "question": "列出2006年英国大奖赛资格赛第一轮比赛中速度最快和最慢的车手的姓，名，以及他们圈速的差距。",
    "gold_sql": "SELECT forename_slowest , surname_slowest , forename_fastest , surname_fastest , time ( ( strftime ( '%s' , '00:0' || slowest_q1 ) - strftime ( '%s' , '00:0' || fastest_q1 ) ) , 'unixepoch' ) AS diff FROM ( SELECT MAX ( A.q1 ) AS slowest_q1 , D.forename AS forename_slowest , D.surname AS surname_slowest FROM qualifying A JOIN races B ON A.raceId = B.raceId JOIN drivers D ON A.driverId = D.driverId WHERE B.name = 'British Grand Prix' AND B.year = '2006' ) JOIN ( SELECT MIN ( A.q1 ) AS fastest_q1 , D.forename AS forename_fastest , D.surname AS surname_fastest FROM qualifying A JOIN races B ON A.raceId = B.raceId JOIN drivers D ON A.driverId = D.driverId WHERE B.name = 'British Grand Prix' AND B.year = '2006' AND A.q1 != '' )"
  },
  {
    "db_id": "formula_1",
    "question": "哪些国家的赛道数量是日本的两倍多？",
    "gold_sql": "SELECT B.country FROM circuits B , ( SELECT COUNT ( * ) AS n_japan FROM circuits B WHERE B.country = 'Japan' ) GROUP BY B.country HAVING COUNT ( * ) > 2 * n_japan"
  },
  {
    "db_id": "formula_1",
    "question": "列出赛道数量比日本赛道数量的两倍还要多的国家。",
    "gold_sql": "SELECT B.country FROM circuits B , ( SELECT COUNT ( * ) AS n_japan FROM circuits B WHERE B.country = 'Japan' ) GROUP BY B.country HAVING COUNT ( * ) > 2 * n_japan"
  },
  {
    "db_id": "formula_1",
    "question": "假设日本有2条赛道，那么哪些国家的赛道数量是日本的两倍多？",
    "gold_sql": "SELECT country FROM circuits GROUP BY country HAVING COUNT ( * ) > 2 * 2"
  },
  {
    "db_id": "formula_1",
    "question": "如果日本有2条赛道，列出赛道数量比日本赛道数量的两倍还要多的国家。",
    "gold_sql": "SELECT country FROM circuits GROUP BY country HAVING COUNT ( * ) > 2 * 2"
  },
  {
    "db_id": "formula_1",
    "question": "列出圈速超过最低圈速记录1.5倍的车手的姓和名。",
    "gold_sql": "SELECT DISTINCT B.forename , B.surname FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE milliseconds != '' AND CAST ( milliseconds AS INT ) > 1.5 * ( SELECT MIN ( CAST ( milliseconds AS INT ) ) FROM results WHERE milliseconds != '' )"
  },
  {
    "db_id": "formula_1",
    "question": "哪些车手的圈速超过最低圈速记录1.5倍？列出他们的姓和名。",
    "gold_sql": "SELECT DISTINCT B.forename , B.surname FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE milliseconds != '' AND CAST ( milliseconds AS INT ) > 1.5 * ( SELECT MIN ( CAST ( milliseconds AS INT ) ) FROM results WHERE milliseconds != '' )"
  },
  {
    "db_id": "formula_1",
    "question": "如果最低圈速记录为93000毫秒，请列出圈速超过最低圈速记录1.5倍的驾驶员姓和名。",
    "gold_sql": "SELECT DISTINCT B.forename , B.surname FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE CAST ( milliseconds AS INT ) > 1.5 * 93000"
  },
  {
    "db_id": "formula_1",
    "question": "若最低圈速纪录是93000毫秒，那哪些车手的圈速超过最低圈速记录1.5倍？列出他们的姓和名。",
    "gold_sql": "SELECT DISTINCT B.forename , B.surname FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE CAST ( milliseconds AS INT ) > 1.5 * 93000"
  },
  {
    "db_id": "formula_1",
    "question": "列出比赛次数比葡萄牙首都的比赛次数的三倍多的地点和比赛次数。",
    "gold_sql": "SELECT B.location , COUNT ( * ) AS num_races FROM races A JOIN circuits B ON A.circuitId = B.circuitId GROUP BY B.location HAVING COUNT ( * ) > 3 * ( SELECT COUNT ( * ) FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.location = 'Lisbon' )"
  },
  {
    "db_id": "formula_1",
    "question": "哪些地点举办的比赛数量比葡萄牙首都的比赛次数的三倍还要多？列出这些地点和他们举办的比赛次数。",
    "gold_sql": "SELECT B.location , COUNT ( * ) AS num_races FROM races A JOIN circuits B ON A.circuitId = B.circuitId GROUP BY B.location HAVING COUNT ( * ) > 3 * ( SELECT COUNT ( * ) FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE B.location = 'Lisbon' )"
  },
  {
    "db_id": "formula_1",
    "question": "如果在里斯本举行了5场比赛，列出比赛次数比葡萄牙首都的比赛次数的三倍多的地点和比赛次数。",
    "gold_sql": "SELECT B.location , COUNT ( * ) AS num_races FROM races A JOIN circuits B ON A.circuitId = B.circuitId GROUP BY B.location HAVING COUNT ( * ) > 3 * 5"
  },
  {
    "db_id": "formula_1",
    "question": "如果里斯本举行的比赛数量为5场，那么哪些地点举办的比赛数量比葡萄牙首都的比赛次数的三倍还要多？列出这些地点和他们举办的比赛次数。",
    "gold_sql": "SELECT B.location , COUNT ( * ) AS num_races FROM races A JOIN circuits B ON A.circuitId = B.circuitId GROUP BY B.location HAVING COUNT ( * ) > 3 * 5"
  },
  {
    "db_id": "formula_1",
    "question": "刘易斯·汉密尔顿参加了多少场比赛？他有多少次获得了第一名？他获得第一名的概率是多少？",
    "gold_sql": "SELECT num_matches , num_no1 , 1.0 * num_no1 / num_matches AS possibility FROM ( SELECT COUNT ( * ) AS num_matches FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE B.surname = 'Albers' AND B.forename = 'Christijan' ) JOIN ( SELECT COUNT ( * ) AS num_no1 FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE B.surname = 'Hamilton' AND B.forename = 'Lewis' AND A.rank = '1' )"
  },
  {
    "db_id": "formula_1",
    "question": "列出刘易斯·汉密尔顿参加的比赛数量，获得第一名的次数，以及获得冠军的概率。",
    "gold_sql": "SELECT num_matches , num_no1 , 1.0 * num_no1 / num_matches AS possibility FROM ( SELECT COUNT ( * ) AS num_matches FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE B.surname = 'Albers' AND B.forename = 'Christijan' ) JOIN ( SELECT COUNT ( * ) AS num_no1 FROM results A JOIN drivers B ON A.driverId = B.driverId WHERE B.surname = 'Hamilton' AND B.forename = 'Lewis' AND A.rank = '1' )"
  },
  {
    "db_id": "formula_1",
    "question": "美国的赛道数量是世界上陆地面积最大的国家的多少倍？",
    "gold_sql": "SELECT 1.0 * ( SELECT COUNT ( * ) FROM circuits WHERE country = 'USA' ) / COUNT ( * ) AS ratio FROM circuits WHERE country = 'Russia'"
  },
  {
    "db_id": "formula_1",
    "question": "请给出位于美国的赛道数量是位于世界上陆地面积最大的国家的赛道数量的多少倍。",
    "gold_sql": "SELECT 1.0 * ( SELECT COUNT ( * ) FROM circuits WHERE country = 'USA' ) / COUNT ( * ) AS ratio FROM circuits WHERE country = 'Russia'"
  },
  {
    "db_id": "formula_1",
    "question": "假设美国有2个赛道，美国的赛道数量是世界上陆地面积最大的国家的多少倍？",
    "gold_sql": "SELECT 1.0 * 2 / COUNT ( * ) AS ratio FROM circuits WHERE country = 'Russia'"
  },
  {
    "db_id": "formula_1",
    "question": "如果美国的赛道数量为2，请给出位于美国的赛道数量是位于世界上陆地面积最大的国家的赛道数量的多少倍。",
    "gold_sql": "SELECT 1.0 * 2 / COUNT ( * ) AS ratio FROM circuits WHERE country = 'Russia'"
  },
  {
    "db_id": "formula_1",
    "question": "在与著名足球运动员克里斯蒂亚诺·罗纳尔多拥有相同国籍的车手中，参加过2006年美国大奖赛的选手是没有参加过的选手的多少倍？",
    "gold_sql": "SELECT 1.0 * n_p / n_all FROM ( SELECT COUNT ( DISTINCT A.driverId ) AS n_p FROM drivers A JOIN results B ON A.driverId = B.driverId JOIN races C ON B.raceId = C.raceID WHERE A.nationality = 'Portuguese' AND C.name = 'United States Grand Prix' AND C.year = '2006' ) JOIN ( SELECT COUNT ( DISTINCT A.driverId ) AS n_all FROM drivers A JOIN results B ON A.driverId = B.driverId JOIN races C ON B.raceId = C.raceID WHERE A.nationality = 'Portuguese' )"
  },
  {
    "db_id": "formula_1",
    "question": "国籍与著名足球运动员克里斯蒂亚诺·罗纳尔多相同的赛车手中，参加过2006年美国大奖赛的选手数量是没有参加过的选手数量的多少倍？",
    "gold_sql": "SELECT 1.0 * n_p / n_all FROM ( SELECT COUNT ( DISTINCT A.driverId ) AS n_p FROM drivers A JOIN results B ON A.driverId = B.driverId JOIN races C ON B.raceId = C.raceID WHERE A.nationality = 'Portuguese' AND C.name = 'United States Grand Prix' AND C.year = '2006' ) JOIN ( SELECT COUNT ( DISTINCT A.driverId ) AS n_all FROM drivers A JOIN results B ON A.driverId = B.driverId JOIN races C ON B.raceId = C.raceID WHERE A.nationality = 'Portuguese' )"
  },
  {
    "db_id": "formula_1",
    "question": "在乔治·W·布什担任总统期间，美国举办了多少场比赛？是英国举办的比赛的多少倍？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT 1.0 * COUNT ( * ) FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'UK' ) AS ratio FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'USA'"
  },
  {
    "db_id": "formula_1",
    "question": "美国在乔治·W·布什担任总统期间举办的比赛数量是多少？是英国同期举办比赛数量的多少倍？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / ( SELECT 1.0 * COUNT ( * ) FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'UK' ) AS ratio FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'USA'"
  },
  {
    "db_id": "formula_1",
    "question": "在乔治·布什担任总统期间，美国举办了多少场比赛？是英国举办的比赛的多少倍，假如英国那段时间举办了10次比赛？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / 10 AS ratio FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'USA'"
  },
  {
    "db_id": "formula_1",
    "question": "美国在乔治·W·布什担任总统期间举办的比赛数量是多少？是英国举办比赛数量的多少倍，假设英国在这段时间举办了10次比赛？",
    "gold_sql": "SELECT 1.0 * COUNT ( * ) / 10 AS ratio FROM races A JOIN circuits B ON A.circuitId = B.circuitId WHERE A.year BETWEEN 2001 AND 2009 AND country = 'USA'"
  },
  {
    "db_id": "formula_1",
    "question": "请提供参加过的比赛次数至少是艾伦·伯格的两倍且与著名的歌手迈克尔·杰克逊具有相同国籍的车手的ID、名字、比赛次数。",
    "gold_sql": "SELECT A.driverId , forename AS first_name , COUNT ( * ) AS n_races FROM drivers A JOIN results B ON A.driverId = B.driverId GROUP BY A.driverId HAVING COUNT ( * ) >= 2 * ( SELECT COUNT ( * ) FROM drivers A JOIN results B ON A.driverId = B.driverId WHERE A.forename = 'Allen' AND A.surname = 'Berg' ) AND A.nationality = 'American'"
  },
  {
    "db_id": "formula_1",
    "question": "给出国籍与著名的歌手迈克尔·杰克逊具有相同，且参加过比赛的数量不少于艾伦·伯格的两倍的车手的ID、名字和参加过比赛次数。",
    "gold_sql": "SELECT A.driverId , forename AS first_name , COUNT ( * ) AS n_races FROM drivers A JOIN results B ON A.driverId = B.driverId GROUP BY A.driverId HAVING COUNT ( * ) >= 2 * ( SELECT COUNT ( * ) FROM drivers A JOIN results B ON A.driverId = B.driverId WHERE A.forename = 'Allen' AND A.surname = 'Berg' ) AND A.nationality = 'American'"
  },
  {
    "db_id": "formula_1",
    "question": "假设艾伦·伯格参加了10场比赛，请提供参加过的比赛次数至少是艾伦·伯格的两倍且与著名的歌手迈克尔·约瑟夫·杰克逊具有相同国籍的车手的ID、名字、比赛次数。",
    "gold_sql": "SELECT A.driverId , forename AS first_name , COUNT ( * ) AS n_races FROM drivers A JOIN results B ON A.driverId = B.driverId GROUP BY A.driverId HAVING COUNT ( * ) >= 2 * 10 AND A.nationality = 'American'"
  },
  {
    "db_id": "formula_1",
    "question": "假设艾伦·伯格参加过的比赛的数量是10，给出国籍与著名的歌手迈克尔·杰克逊具有相同，且参加过比赛的数量不少于艾伦·伯格的两倍的车手的ID、名字和参加过比赛次数。",
    "gold_sql": "SELECT A.driverId , forename AS first_name , COUNT ( * ) AS n_races FROM drivers A JOIN results B ON A.driverId = B.driverId GROUP BY A.driverId HAVING COUNT ( * ) >= 2 * 10 AND A.nationality = 'American'"
  },
  {
    "db_id": "driving_school",
    "question": "列出每个客户的ID和报名驾校时的年龄。",
    "gold_sql": "SELECT customer_id , strftime ( '%Y' , date_became_customer ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_became_customer ) < strftime ( '%m-%d' , date_of_birth ) ) AS age FROM Customers"
  },
  {
    "db_id": "driving_school",
    "question": "每个客户的ID是多少，他们报名驾校时候年龄都多大了？",
    "gold_sql": "SELECT customer_id , strftime ( '%Y' , date_became_customer ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_became_customer ) < strftime ( '%m-%d' , date_of_birth ) ) AS age FROM Customers"
  },
  {
    "db_id": "driving_school",
    "question": "假如达蒙·桑福德出生于21世纪的第一天，列出每个客户的ID和报名驾校时的年龄。",
    "gold_sql": "SELECT customer_id, strftime ('%Y', date_became_customer) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_became_customer) < strftime ('%m-%d', date_of_birth)) AS age FROM Customers WHERE NOT (first_name = 'Dameon' AND last_name = 'Sanford') UNION ALL SELECT customer_id, strftime ('%Y', date_became_customer) - strftime ('%Y', '2001-01-01') - (strftime ('%m-%d', date_became_customer) < strftime ('%m-%d', '2001-01-01')) AS age FROM Customers WHERE first_name = 'Dameon' AND last_name = 'Sanford'"
  },
  {
    "db_id": "driving_school",
    "question": "假如达蒙·桑福德的生日是21世纪的第一天，那么每个客户的ID是多少，他们报名驾校时候年龄都多大了？",
    "gold_sql": "SELECT customer_id, strftime ('%Y', date_became_customer) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_became_customer) < strftime ('%m-%d', date_of_birth)) AS age FROM Customers WHERE NOT (first_name = 'Dameon' AND last_name = 'Sanford') UNION ALL SELECT customer_id, strftime ('%Y', date_became_customer) - strftime ('%Y', '2001-01-01') - (strftime ('%m-%d', date_became_customer) < strftime ('%m-%d', '2001-01-01')) AS age FROM Customers WHERE first_name = 'Dameon' AND last_name = 'Sanford'"
  },
  {
    "db_id": "driving_school",
    "question": "未偿金额大于2000的客户中有百分之多少客户是优质客户？",
    "gold_sql": "SELECT 100.0 * good / n AS percent FROM ( SELECT COUNT ( * ) AS good FROM Customers WHERE amount_outstanding > 2000 AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n FROM Customers WHERE amount_outstanding > 2000 )"
  },
  {
    "db_id": "driving_school",
    "question": "列出优质客户在未偿金额大于2000的客户中所占的百分比。",
    "gold_sql": "SELECT 100.0 * good / n AS percent FROM ( SELECT COUNT ( * ) AS good FROM Customers WHERE amount_outstanding > 2000 AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n FROM Customers WHERE amount_outstanding > 2000 )"
  },
  {
    "db_id": "driving_school",
    "question": "假如所有2015年报名的客户未偿金额为200，未偿金额大于2000的客户中有百分之多少客户是优质客户？",
    "gold_sql": "SELECT 100.0 * good / n AS percent FROM ( SELECT COUNT ( * ) AS good FROM ( SELECT 200 AS amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) = '2015' UNION ALL SELECT amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) != '2015' ) WHERE amount_outstanding > 2000 AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n FROM ( SELECT 200 AS amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) = '2015' UNION ALL SELECT amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) != '2015' ) WHERE amount_outstanding > 2000 )"
  },
  {
    "db_id": "driving_school",
    "question": "如果所有在2015年报名的客户的未偿金额都是200，列出优质客户在未偿金额大于2000的客户中所占的百分比。",
    "gold_sql": "SELECT 100.0 * good / n AS percent FROM ( SELECT COUNT ( * ) AS good FROM ( SELECT 200 AS amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) = '2015' UNION ALL SELECT amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) != '2015' ) WHERE amount_outstanding > 2000 AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n FROM ( SELECT 200 AS amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) = '2015' UNION ALL SELECT amount_outstanding , customer_status_code FROM Customers WHERE strftime ( '%Y' , date_became_customer ) != '2015' ) WHERE amount_outstanding > 2000 )"
  },
  {
    "db_id": "driving_school",
    "question": "列出入职时大于20岁的教练的ID和安排的课程数量。",
    "gold_sql": "SELECT A.staff_id, COUNT (*) AS n_lesson FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id WHERE strftime ('%Y', A.date_joined_staff) - strftime ('%Y', A.date_of_birth) - (strftime ('%m-%d', A.date_joined_staff) < strftime ('%m-%d', A.date_of_birth)) > 20 UNION ALL SELECT staff_id, 0 AS n_lesson FROM Staff WHERE strftime ('%Y', date_joined_staff) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_joined_staff) < strftime ('%m-%d', date_of_birth)) > 20 AND staff_id NOT IN (SELECT A.staff_id FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id)"
  },
  {
    "db_id": "driving_school",
    "question": "哪些教练在入职时的年龄大于20岁，他们的ID和安排的课程数量分别是多少？",
    "gold_sql": "SELECT A.staff_id, COUNT (*) AS n_lesson FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id WHERE strftime ('%Y', A.date_joined_staff) - strftime ('%Y', A.date_of_birth) - (strftime ('%m-%d', A.date_joined_staff) < strftime ('%m-%d', A.date_of_birth)) > 20 UNION ALL SELECT staff_id, 0 AS n_lesson FROM Staff WHERE strftime ('%Y', date_joined_staff) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_joined_staff) < strftime ('%m-%d', date_of_birth)) > 20 AND staff_id NOT IN (SELECT A.staff_id FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id)"
  },
  {
    "db_id": "driving_school",
    "question": "假如2018年3月8日离职的教练都是2016年3月8日入职的，列出入职时大于20岁的教练的ID、安排的课程数量。",
    "gold_sql": "SELECT A.staff_id, COUNT (*) AS n_lesson FROM (SELECT staff_id, date_of_birth, '2016-03-08' AS date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) = '2018-03-08' UNION ALL SELECT staff_id, date_of_birth, date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) != '2018-03-08' ) A JOIN Lessons B ON A.staff_id = B.staff_id WHERE strftime ('%Y', A.date_joined_staff) - strftime ('%Y', A.date_of_birth) - (strftime ('%m-%d', A.date_joined_staff) < strftime ('%m-%d', A.date_of_birth)) > 20 UNION ALL SELECT staff_id, 0 AS n_lesson FROM (SELECT staff_id, date_of_birth, '2016-03-08' AS date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) = '2018-03-08' UNION ALL SELECT staff_id, date_of_birth, date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) != '2018-03-08' ) WHERE strftime ('%Y', date_joined_staff) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_joined_staff) < strftime ('%m-%d', date_of_birth)) > 20 AND staff_id NOT IN (SELECT A.staff_id FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id)"
  },
  {
    "db_id": "driving_school",
    "question": "假设所有2018年3月8日离职的教练的入职日期都是2016年3月8日，那么哪些教练在入职时的年龄大于20岁，他们的ID和安排的课程数量分别是多少？",
    "gold_sql": "SELECT A.staff_id, COUNT (*) AS n_lesson FROM (SELECT staff_id, date_of_birth, '2016-03-08' AS date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) = '2018-03-08' UNION ALL SELECT staff_id, date_of_birth, date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) != '2018-03-08' ) A JOIN Lessons B ON A.staff_id = B.staff_id WHERE strftime ('%Y', A.date_joined_staff) - strftime ('%Y', A.date_of_birth) - (strftime ('%m-%d', A.date_joined_staff) < strftime ('%m-%d', A.date_of_birth)) > 20 UNION ALL SELECT staff_id, 0 AS n_lesson FROM (SELECT staff_id, date_of_birth, '2016-03-08' AS date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) = '2018-03-08' UNION ALL SELECT staff_id, date_of_birth, date_joined_staff FROM Staff WHERE strftime ('%Y-%m-%d', date_left_staff) != '2018-03-08' ) WHERE strftime ('%Y', date_joined_staff) - strftime ('%Y', date_of_birth) - (strftime ('%m-%d', date_joined_staff) < strftime ('%m-%d', date_of_birth)) > 20 AND staff_id NOT IN (SELECT A.staff_id FROM Staff A JOIN Lessons B ON A.staff_id = B.staff_id)"
  },
  {
    "db_id": "driving_school",
    "question": "哪个教练在驾校工作得最久？给出他们的ID。",
    "gold_sql": "SELECT staff_id FROM Staff ORDER BY julianday ( date_left_staff ) - julianday ( date_joined_staff ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "在驾校工作时间最长的教练的ID是多少？",
    "gold_sql": "SELECT staff_id FROM Staff ORDER BY julianday ( date_left_staff ) - julianday ( date_joined_staff ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "假如林肯·本尼·卡罗尔21岁生日那天入职的，给出在驾校工作得最久的教练的ID。",
    "gold_sql": "SELECT staff_id FROM (SELECT staff_id, strftime ('%Y-%m-%d', julianday (date_of_birth) + 21 * 365.25) AS date_joined_staff, date_left_staff FROM Staff WHERE first_name = 'Lincoln' AND middle_name = 'Benny' AND last_name = 'Carroll' UNION ALL SELECT staff_id, date_joined_staff, date_left_staff FROM Staff WHERE NOT (first_name = 'Lincoln' AND middle_name = 'Benny' AND last_name = 'Carroll') ) ORDER BY julianday (date_left_staff) - julianday (date_joined_staff) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "如果林肯·本尼·卡罗尔的入职日期是他的21岁生日那天，在驾校工作时间最长的教练的ID是多少？",
    "gold_sql": "SELECT staff_id FROM (SELECT staff_id, strftime ('%Y-%m-%d', julianday (date_of_birth) + 21 * 365.25) AS date_joined_staff, date_left_staff FROM Staff WHERE first_name = 'Lincoln' AND middle_name = 'Benny' AND last_name = 'Carroll' UNION ALL SELECT staff_id, date_joined_staff, date_left_staff FROM Staff WHERE NOT (first_name = 'Lincoln' AND middle_name = 'Benny' AND last_name = 'Carroll') ) ORDER BY julianday (date_left_staff) - julianday (date_joined_staff) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "一次课都没上过的客户中不良客户比优质客户多多少？",
    "gold_sql": "SELECT n_bad - n_good AS diff FROM ( SELECT COUNT ( * ) AS n_good FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM Lessons WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n_bad FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM Lessons WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Bad Customer' )"
  },
  {
    "db_id": "driving_school",
    "question": "列出在从未上过课的客户中不良客户比优质客户多的数量。",
    "gold_sql": "SELECT n_bad - n_good AS diff FROM ( SELECT COUNT ( * ) AS n_good FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM Lessons WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n_bad FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM Lessons WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Bad Customer' )"
  },
  {
    "db_id": "driving_school",
    "question": "假如2018年3月7日所有课都没有被取消，一次课都没上过的客户中不良客户比优质客户多多少？",
    "gold_sql": "SELECT n_bad - n_good AS diff FROM ( SELECT COUNT ( * ) AS n_good FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM ( SELECT customer_id , 'Completed' AS lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) = '2018-03-07' UNION ALL SELECT customer_id , lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) != '2018-03-07' ) WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n_bad FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM ( SELECT customer_id , 'Completed' AS lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) = '2018-03-07' UNION ALL SELECT customer_id , lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) != '2018-03-07' ) WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Bad Customer' )"
  },
  {
    "db_id": "driving_school",
    "question": "如果2018年3月7日所有课都没有被取消，列出在从未上过课的客户中不良客户比优质客户多的数量。",
    "gold_sql": "SELECT n_bad - n_good AS diff FROM ( SELECT COUNT ( * ) AS n_good FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM ( SELECT customer_id , 'Completed' AS lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) = '2018-03-07' UNION ALL SELECT customer_id , lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) != '2018-03-07' ) WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Good Customer' ) JOIN ( SELECT COUNT ( * ) AS n_bad FROM Customers WHERE customer_id NOT IN ( SELECT DISTINCT ( customer_id ) FROM ( SELECT customer_id , 'Completed' AS lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) = '2018-03-07' UNION ALL SELECT customer_id , lesson_status_code FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) != '2018-03-07' ) WHERE lesson_status_code != 'Cancelled' ) AND customer_status_code = 'Bad Customer' )"
  },
  {
    "db_id": "driving_school",
    "question": "2018年3月5日后没有课程安排的教练的ID是多少，其一次课平均多少钱，他今年多少岁了？",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) AS avg_price , strftime ( '%Y' , 'now' ) - strftime ( '%Y' , B.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , B.date_of_birth ) ) AS age FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id NOT IN ( SELECT staff_id FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) > '2018-03-05' ) GROUP BY A.staff_id"
  },
  {
    "db_id": "driving_school",
    "question": "列出在2018年3月5日之后没有任何课程安排的教练的ID，其课程的平均价格，以及其年龄。",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) AS avg_price , strftime ( '%Y' , 'now' ) - strftime ( '%Y' , B.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , B.date_of_birth ) ) AS age FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id NOT IN ( SELECT staff_id FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) > '2018-03-05' ) GROUP BY A.staff_id"
  },
  {
    "db_id": "driving_school",
    "question": "假如2018年2月所有课涨价8%，2018年3月5日后没有课程安排的教练的ID是多少，其一次课平均多少钱，这些教练今年多少岁？",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) AS avg_price , strftime ( '%Y' , 'now' ) - strftime ( '%Y' , B.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , B.date_of_birth ) ) AS age FROM ( SELECT staff_id , ( 1 + 0.08 ) * price AS price FROM Lessons WHERE strftime ( '%Y-%m' , lesson_date ) = '2018-02' UNION ALL SELECT staff_id , price FROM Lessons WHERE strftime ( '%Y-%m' , lesson_date ) != '2018-02' ) A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id NOT IN ( SELECT staff_id FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) > '2018-03-05' ) GROUP BY A.staff_id"
  },
  {
    "db_id": "driving_school",
    "question": "假设2018年2月所有课程价格上调8%，列出在2018年3月5日之后没有任何课程安排的教练的ID，其课程的平均价格，以及其年龄。",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) AS avg_price , strftime ( '%Y' , 'now' ) - strftime ( '%Y' , B.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , B.date_of_birth ) ) AS age FROM ( SELECT staff_id , ( 1 + 0.08 ) * price AS price FROM Lessons WHERE strftime ( '%Y-%m' , lesson_date ) = '2018-02' UNION ALL SELECT staff_id , price FROM Lessons WHERE strftime ( '%Y-%m' , lesson_date ) != '2018-02' ) A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id NOT IN ( SELECT staff_id FROM Lessons WHERE strftime ( '%Y-%m-%d' , lesson_date ) > '2018-03-05' ) GROUP BY A.staff_id"
  },
  {
    "db_id": "driving_school",
    "question": "哪个教练课程均价最高，给出他的ID。其均价比课程均价最低的教练高多少？",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) - ( SELECT AVG ( price ) FROM Lessons GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id GROUP BY A.staff_id ORDER BY AVG ( A.price ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "课程平均价格最贵的教练的ID是多少，其平均价格比课程平均价格最便宜的教练贵多少？",
    "gold_sql": "SELECT A.staff_id , AVG ( A.price ) - ( SELECT AVG ( price ) FROM Lessons GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id GROUP BY A.staff_id ORDER BY AVG ( A.price ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "假如温尼弗雷德·利亚姆·贾斯特的所有课程降价12%，哪个教练课程均价最高，给出他的ID，其均价比课程均价最低的教练高多少？",
    "gold_sql": "SELECT staff_id , AVG ( price ) - ( SELECT AVG ( price ) FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "假设温尼弗雷德·利亚姆·贾斯特的所有课程价格下调12%，课程平均价格最贵的教练的ID是多少，其平均价格比课程平均价格最便宜的教练贵多少？",
    "gold_sql": "SELECT staff_id , AVG ( price ) - ( SELECT AVG ( price ) FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) ASC LIMIT 1 ) AS diff FROM ( SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price * ( 1 - 0.12 ) AS price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' UNION ALL SELECT A.staff_id , B.first_name , B.middle_name , B.last_name , A.price FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE NOT ( B.first_name = 'Winnifred' AND B.middle_name = 'Liam' AND B.last_name = 'Jast' ) ) GROUP BY staff_id ORDER BY AVG ( price ) DESC LIMIT 1"
  },
  {
    "db_id": "driving_school",
    "question": "有百分之多少的学员有多个教练？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customers ) AS percent FROM ( SELECT customer_id FROM Lessons GROUP BY customer_id HAVING COUNT ( DISTINCT ( staff_id ) ) >= 2 )"
  },
  {
    "db_id": "driving_school",
    "question": "列出教练数量大于一个的学员所占的百分比。",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customers ) AS percent FROM ( SELECT customer_id FROM Lessons GROUP BY customer_id HAVING COUNT ( DISTINCT ( staff_id ) ) >= 2 )"
  },
  {
    "db_id": "driving_school",
    "question": "假如ID为12的课程的教练是尼弗雷德·利亚姆·贾斯特，有百分之多少的学员有多个教练？",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customers ) AS percent FROM ( SELECT customer_id FROM ( SELECT customer_id , ( SELECT staff_id FROM Staff WHERE first_name = 'Winnifred' AND middle_name = 'Liam' AND last_name = 'Jast' ) AS staff_id FROM Lessons WHERE lesson_id = '12' UNION ALL SELECT customer_id , staff_id FROM Lessons WHERE lesson_id != '12' ) GROUP BY customer_id HAVING COUNT ( DISTINCT ( staff_id ) ) >= 2 )"
  },
  {
    "db_id": "driving_school",
    "question": "如果尼弗雷德·利亚姆·贾斯特是ID为12的课程的教练，列出教练数量大于一个的学员所占的百分比。",
    "gold_sql": "SELECT 100.0 * COUNT ( * ) / ( SELECT COUNT ( * ) FROM Customers ) AS percent FROM ( SELECT customer_id FROM ( SELECT customer_id , ( SELECT staff_id FROM Staff WHERE first_name = 'Winnifred' AND middle_name = 'Liam' AND last_name = 'Jast' ) AS staff_id FROM Lessons WHERE lesson_id = '12' UNION ALL SELECT customer_id , staff_id FROM Lessons WHERE lesson_id != '12' ) GROUP BY customer_id HAVING COUNT ( DISTINCT ( staff_id ) ) >= 2 )"
  },
  {
    "db_id": "driving_school",
    "question": "最老的教练比最年轻的教练大多少岁？",
    "gold_sql": "SELECT strftime ( '%Y' , MAX ( date_of_birth ) ) - strftime ( '%Y' , MIN ( date_of_birth ) ) - ( strftime ( '%m-%d' , MAX ( date_of_birth ) ) < strftime ( '%m-%d' , MIN ( date_of_birth ) ) ) AS diff FROM Staff"
  },
  {
    "db_id": "driving_school",
    "question": "年纪最大的教练比年纪最小的教练年长多少岁？",
    "gold_sql": "SELECT strftime ( '%Y' , MAX ( date_of_birth ) ) - strftime ( '%Y' , MIN ( date_of_birth ) ) - ( strftime ( '%m-%d' , MAX ( date_of_birth ) ) < strftime ( '%m-%d' , MIN ( date_of_birth ) ) ) AS diff FROM Staff"
  },
  {
    "db_id": "driving_school",
    "question": "假如2020年的时候卡梅尔·伊西·魏斯纳特的年龄是2009年出生的人的两倍，最老的教练比最年轻的教练大多少岁？",
    "gold_sql": "SELECT MAX ( date_of_birth ) - MIN ( date_of_birth ) AS diff FROM ( SELECT 2020 - ( 2020 - 2009 ) * 2 AS date_of_birth FROM Staff WHERE first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' UNION ALL SELECT date_of_birth FROM Staff WHERE NOT ( first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' ) ) ORDER BY date_of_birth DESC"
  },
  {
    "db_id": "driving_school",
    "question": "假设2020年的时候卡梅尔·伊西·魏斯纳特的年龄是生于2009的人的年龄的两倍，年纪最大的教练比年纪最小的教练年长多少岁？",
    "gold_sql": "SELECT MAX ( date_of_birth ) - MIN ( date_of_birth ) AS diff FROM ( SELECT 2020 - ( 2020 - 2009 ) * 2 AS date_of_birth FROM Staff WHERE first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' UNION ALL SELECT date_of_birth FROM Staff WHERE NOT ( first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' ) ) ORDER BY date_of_birth DESC"
  },
  {
    "db_id": "driving_school",
    "question": "离开驾校时的年龄最大的教练总共有多少课程安排，其中被取消了的课占比多少？",
    "gold_sql": "SELECT total, 1.0 * n_cancel / total AS ratio FROM ( SELECT COUNT ( * ) AS total FROM Lessons WHERE staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) ) JOIN ( SELECT COUNT ( * ) AS n_cancel FROM Lessons WHERE staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND lesson_status_code = 'Cancelled' )"
  },
  {
    "db_id": "driving_school",
    "question": "离开驾校时候的最年长的教练的课程安排总量是多少，其中多少比例的课程被取消了？",
    "gold_sql": "SELECT total, 1.0 * n_cancel / total AS ratio FROM ( SELECT COUNT ( * ) AS total FROM Lessons WHERE staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) ) JOIN ( SELECT COUNT ( * ) AS n_cancel FROM Lessons WHERE staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND lesson_status_code = 'Cancelled' )"
  },
  {
    "db_id": "driving_school",
    "question": "假如所有教练入职后的60天内都没有课程安排，离开驾校的时年龄最大的教练总共有多少课程安排，其中被取消了的课占比多少？",
    "gold_sql": "SELECT total, 1.0 * n_cancel / total AS ratio FROM ( SELECT COUNT ( * ) AS total FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND A.lesson_date > strftime ( julianday ( B.date_joined_staff ) + 60 ) ) JOIN ( SELECT COUNT ( * ) AS n_cancel FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND A.lesson_status_code = 'Cancelled' AND A.lesson_date > strftime ( julianday ( B.date_joined_staff ) + 60 ) )"
  },
  {
    "db_id": "driving_school",
    "question": "如果所有教练在入职60天后才会有课程安排，离开驾校时候的最年长的教练的课程安排总量是多少，其中多少比例的课程被取消了？",
    "gold_sql": "SELECT total, 1.0 * n_cancel / total AS ratio FROM ( SELECT COUNT ( * ) AS total FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND A.lesson_date > strftime ( julianday ( B.date_joined_staff ) + 60 ) ) JOIN ( SELECT COUNT ( * ) AS n_cancel FROM Lessons A JOIN Staff B ON A.staff_id = B.staff_id WHERE A.staff_id = ( SELECT staff_id FROM Staff ORDER BY strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) DESC LIMIT 1 ) AND A.lesson_status_code = 'Cancelled' AND A.lesson_date > strftime ( julianday ( B.date_joined_staff ) + 60 ) )"
  },
  {
    "db_id": "driving_school",
    "question": "哪个客户支付的钱最多，给出他的ID，并求出其比支付的钱最少的客户多支付多少钱。",
    "gold_sql": "SELECT A.customer_id , MAX ( A.amount_payment ) - ( SELECT MIN ( amount_payment ) FROM Customer_Payments ) AS payment_diff FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id"
  },
  {
    "db_id": "driving_school",
    "question": "列出付钱最多的客户的ID，以及其比付钱最少的客户多付的钱的数额。",
    "gold_sql": "SELECT A.customer_id , MAX ( A.amount_payment ) - ( SELECT MIN ( amount_payment ) FROM Customer_Payments ) AS payment_diff FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id"
  },
  {
    "db_id": "driving_school",
    "question": "假如阿米娅·斯宾卡2018年3月12日多支付5000，哪个客户支付的钱最多，给出他的ID，并求出其比支付的钱最少的客户多支付多少钱。",
    "gold_sql": "SELECT customer_id, MAX (amount_payment) - (SELECT MIN (amount_payment) FROM (SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12' UNION ALL SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE NOT (B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12') )) AS payment_diff FROM (SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12' UNION ALL SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE NOT (B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12') )"
  },
  {
    "db_id": "driving_school",
    "question": "如果阿米娅·斯宾卡2018年3月12日付款金额多5000，列出付钱最多的客户的ID，以及其比付钱最少的客户多付的钱的数额。",
    "gold_sql": "SELECT customer_id, MAX (amount_payment) - (SELECT MIN (amount_payment) FROM (SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12' UNION ALL SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE NOT (B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12') )) AS payment_diff FROM (SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12' UNION ALL SELECT A.customer_id, amount_payment + 5000 AS amount_payment FROM Customer_Payments A JOIN Customers B ON A.customer_id = B.customer_id WHERE NOT (B.first_name = 'Amya' AND B.last_name = 'Spinka' AND strftime ('%Y-%m-%d', A.datetime_payment) = '2018-03-12') )"
  },
  {
    "db_id": "driving_school",
    "question": "住在乔治亚州伊莱恩湖市的教练平均年龄是多少？",
    "gold_sql": "SELECT AVG ( strftime ( '%Y' , 'now' ) - strftime ( '%Y' , A.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , A.date_of_birth ) ) ) AS avg_age FROM Staff A JOIN Addresses B ON A.staff_address_id = B.address_id WHERE B.state_province_county = 'Georgia' AND B.city = 'Lake Elaina'"
  },
  {
    "db_id": "driving_school",
    "question": "列出居住在乔治亚州伊莱恩湖市的教练的平均年龄。",
    "gold_sql": "SELECT AVG ( strftime ( '%Y' , 'now' ) - strftime ( '%Y' , A.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , A.date_of_birth ) ) ) AS avg_age FROM Staff A JOIN Addresses B ON A.staff_address_id = B.address_id WHERE B.state_province_county = 'Georgia' AND B.city = 'Lake Elaina'"
  },
  {
    "db_id": "driving_school",
    "question": "假如住在乔治亚州伊莱恩湖市的教练平均年龄是住在乔治亚州梅丽莎港市的教练的平均年龄的两倍，住在乔治亚州伊莱恩湖市的教练平均年龄是多少？",
    "gold_sql": "SELECT 2 * AVG ( strftime ( '%Y' , 'now' ) - strftime ( '%Y' , A.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , A.date_of_birth ) ) ) AS avg_age FROM Staff A JOIN Addresses B ON A.staff_address_id = B.address_id WHERE B.state_province_county = 'Georgia' AND B.city = 'Port Melyssa'"
  },
  {
    "db_id": "driving_school",
    "question": "如果居住在乔治亚州伊莱恩湖市的教练平均年龄是居住在乔治亚州梅丽莎港市的教练的平均年龄的两倍，列出居住在乔治亚州伊莱恩湖市的教练的平均年龄。",
    "gold_sql": "SELECT 2 * AVG ( strftime ( '%Y' , 'now' ) - strftime ( '%Y' , A.date_of_birth ) - ( strftime ( '%m-%d' , 'now' ) < strftime ( '%m-%d' , A.date_of_birth ) ) ) AS avg_age FROM Staff A JOIN Addresses B ON A.staff_address_id = B.address_id WHERE B.state_province_county = 'Georgia' AND B.city = 'Port Melyssa'"
  },
  {
    "db_id": "driving_school",
    "question": "贾妮莎·阿马拉·萨文离职5年后多少岁，比卡梅尔·伊西·魏斯纳特小多少岁？",
    "gold_sql": "SELECT * FROM ( SELECT 5 + strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) AS age FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn' ) JOIN ( SELECT date_of_birth - ( SELECT date_of_birth FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn' ) AS diff FROM Staff WHERE first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' )"
  },
  {
    "db_id": "driving_school",
    "question": "贾妮莎·阿马拉·萨文在离职5年后的年龄是多大，其比卡梅尔·伊西·魏斯纳特年轻多少岁？",
    "gold_sql": "SELECT * FROM ( SELECT 5 + strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) AS age FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn' ) JOIN ( SELECT date_of_birth - ( SELECT date_of_birth FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn' ) AS diff FROM Staff WHERE first_name = 'Camylle' AND middle_name = 'Icie' AND last_name = 'Weissnat' )"
  },
  {
    "db_id": "driving_school",
    "question": "假如贾妮莎·阿马拉·萨文离职的时候卡梅尔·伊西·魏斯纳特30岁，贾妮莎·阿马拉·萨文离职5年后多少岁，比卡梅尔·伊西·魏斯纳特小多少岁？",
    "gold_sql": "SELECT 5 + strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) AS age , 30 - ( strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) ) AS diff FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn'"
  },
  {
    "db_id": "driving_school",
    "question": "若卡梅尔·伊西·魏斯纳特在贾妮莎·阿马拉·萨文离职的时候的年龄是30岁，那贾妮莎·阿马拉·萨文在离职5年后的年龄是多大，其比卡梅尔·伊西·魏斯纳特年轻多少岁？",
    "gold_sql": "SELECT 5 + strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) AS age , 30 - ( strftime ( '%Y' , date_left_staff ) - strftime ( '%Y' , date_of_birth ) - ( strftime ( '%m-%d' , date_left_staff ) < strftime ( '%m-%d' , date_of_birth ) ) ) AS diff FROM Staff WHERE first_name = 'Janessa' AND middle_name = 'Amara' AND last_name = 'Sawayn'"
  }
]